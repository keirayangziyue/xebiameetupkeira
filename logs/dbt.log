[0m19:31:34.379176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105351fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a7ed0>]}


============================== 19:31:34.386275 | d7d7e9d3-ddba-4888-8b9f-00b2f7c8c98e ==============================
[0m19:31:34.386275 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:31:34.386722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:31:34.418291 [info ] [MainThread]: dbt version: 1.8.8
[0m19:31:34.418880 [info ] [MainThread]: python version: 3.13.0
[0m19:31:34.419506 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m19:31:34.419793 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m19:31:34.420370 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m19:31:34.420702 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m19:31:34.420926 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m19:31:34.596864 [info ] [MainThread]: Configuration:
[0m19:31:34.597689 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:31:34.598408 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:31:34.598970 [info ] [MainThread]: Required dependencies:
[0m19:31:34.599638 [debug] [MainThread]: Executing "git --help"
[0m19:31:34.650050 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:31:34.651675 [debug] [MainThread]: STDERR: "b''"
[0m19:31:34.652220 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:31:34.652675 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:31:34.653109 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:31:34.653849 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/keirayang/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:31:34.657755 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.39557818, "process_user_time": 1.261232, "process_kernel_time": 0.718309, "process_mem_max_rss": "99958784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:31:34.658790 [debug] [MainThread]: Command `dbt debug` failed at 19:31:34.658522 after 0.40 seconds
[0m19:31:34.659753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743abe0>]}
[0m19:31:34.660586 [debug] [MainThread]: Flushing usage events
[0m19:44:10.642597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105051fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee3ed0>]}


============================== 19:44:10.650191 | 2f0c64fc-3949-417c-bb7b-d62c2c92081f ==============================
[0m19:44:10.650191 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:44:10.651196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m19:44:10.682325 [info ] [MainThread]: dbt version: 1.8.8
[0m19:44:10.683008 [info ] [MainThread]: python version: 3.13.0
[0m19:44:10.683557 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m19:44:10.684305 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m19:44:10.694290 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m19:44:10.695529 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m19:44:10.696242 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m19:44:10.696990 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m19:44:10.851756 [info ] [MainThread]: Configuration:
[0m19:44:10.852519 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:44:10.853024 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:44:10.854265 [info ] [MainThread]: Required dependencies:
[0m19:44:10.854987 [debug] [MainThread]: Executing "git --help"
[0m19:44:10.903276 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:44:10.905003 [debug] [MainThread]: STDERR: "b''"
[0m19:44:10.905695 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:44:10.906165 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:44:10.906710 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:44:10.907045 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m19:44:10.910695 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.37861913, "process_user_time": 1.265523, "process_kernel_time": 0.730261, "process_mem_max_rss": "102842368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:44:10.911934 [debug] [MainThread]: Command `dbt debug` failed at 19:44:10.911773 after 0.38 seconds
[0m19:44:10.912660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701de00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107210170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f76e00>]}
[0m19:44:10.913658 [debug] [MainThread]: Flushing usage events
[0m11:06:27.759350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117fbed0>]}


============================== 11:06:27.766075 | def34e54-bc3f-4605-8578-c9f868b010c9 ==============================
[0m11:06:27.766075 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:06:27.766960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:06:27.797928 [info ] [MainThread]: dbt version: 1.8.8
[0m11:06:27.798635 [info ] [MainThread]: python version: 3.13.0
[0m11:06:27.799203 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m11:06:27.799668 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m11:06:27.806722 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m11:06:27.806989 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m11:06:27.807148 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m11:06:27.807251 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m11:06:27.959824 [info ] [MainThread]: Configuration:
[0m11:06:27.960737 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:06:27.961518 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:06:27.962123 [info ] [MainThread]: Required dependencies:
[0m11:06:27.962886 [debug] [MainThread]: Executing "git --help"
[0m11:06:28.026862 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:06:28.028571 [debug] [MainThread]: STDERR: "b''"
[0m11:06:28.029225 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:06:28.029826 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:06:28.030402 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:06:28.030829 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m11:06:28.052168 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.4138646, "process_user_time": 1.193609, "process_kernel_time": 0.766487, "process_mem_max_rss": "102907904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:06:28.053318 [debug] [MainThread]: Command `dbt debug` failed at 11:06:28.052991 after 0.42 seconds
[0m11:06:28.054129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111935e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c0c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11188ee00>]}
[0m11:06:28.055098 [debug] [MainThread]: Flushing usage events
[0m11:16:29.723169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10284dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba7ed0>]}


============================== 11:16:29.730997 | 7680737b-5f43-4068-8148-a6e5681f3dcb ==============================
[0m11:16:29.730997 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:16:29.731920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:16:29.763252 [info ] [MainThread]: dbt version: 1.8.8
[0m11:16:29.763901 [info ] [MainThread]: python version: 3.13.0
[0m11:16:29.764361 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m11:16:29.764891 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m11:16:29.773883 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m11:16:29.774781 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m11:16:29.775281 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m11:16:29.775824 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m11:16:29.938842 [info ] [MainThread]: Configuration:
[0m11:16:29.939541 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:16:29.939918 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:16:29.940297 [info ] [MainThread]: Required dependencies:
[0m11:16:29.940889 [debug] [MainThread]: Executing "git --help"
[0m11:16:29.989760 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:16:29.991233 [debug] [MainThread]: STDERR: "b''"
[0m11:16:29.991977 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:16:29.992463 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:16:29.992918 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:16:29.993587 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m11:16:29.997236 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.38649243, "process_user_time": 1.230783, "process_kernel_time": 0.709644, "process_mem_max_rss": "102219776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:16:29.998450 [debug] [MainThread]: Command `dbt debug` failed at 11:16:29.998063 after 0.39 seconds
[0m11:16:29.999181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce1e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d10170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3ae00>]}
[0m11:16:29.999953 [debug] [MainThread]: Flushing usage events
[0m11:51:44.865467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105751fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e3ed0>]}


============================== 11:51:44.873280 | be965b78-cb2b-4955-b703-5a223df3ad3c ==============================
[0m11:51:44.873280 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:51:44.874377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:51:44.905617 [info ] [MainThread]: dbt version: 1.8.8
[0m11:51:44.906304 [info ] [MainThread]: python version: 3.13.0
[0m11:51:44.906778 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m11:51:44.907212 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m11:51:44.922095 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m11:51:44.923206 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m11:51:44.923745 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m11:51:44.924051 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m11:51:45.085061 [info ] [MainThread]: Configuration:
[0m11:51:45.085967 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:51:45.086471 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:51:45.086938 [info ] [MainThread]: Required dependencies:
[0m11:51:45.087752 [debug] [MainThread]: Executing "git --help"
[0m11:51:45.137841 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:51:45.139618 [debug] [MainThread]: STDERR: "b''"
[0m11:51:45.140624 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:51:45.141284 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:51:45.141914 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:51:45.142316 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m11:51:45.146091 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.3970618, "process_user_time": 1.242612, "process_kernel_time": 0.714444, "process_mem_max_rss": "102137856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:51:45.147094 [debug] [MainThread]: Command `dbt debug` failed at 11:51:45.146948 after 0.40 seconds
[0m11:51:45.147870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107625e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107814170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107576f10>]}
[0m11:51:45.148584 [debug] [MainThread]: Flushing usage events
[0m12:33:15.443518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105151fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe3ed0>]}


============================== 12:33:15.452841 | 8d3d4e67-f73d-4f38-950e-8c03a6b49d80 ==============================
[0m12:33:15.452841 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:33:15.453760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:15.485096 [info ] [MainThread]: dbt version: 1.8.8
[0m12:33:15.485915 [info ] [MainThread]: python version: 3.13.0
[0m12:33:15.486403 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m12:33:15.486782 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m12:33:15.500832 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m12:33:15.501858 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m12:33:15.502577 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m12:33:15.502933 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m12:33:15.663316 [info ] [MainThread]: Configuration:
[0m12:33:15.664398 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:33:15.664969 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:33:15.665348 [info ] [MainThread]: Required dependencies:
[0m12:33:15.666308 [debug] [MainThread]: Executing "git --help"
[0m12:33:15.716622 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:33:15.718446 [debug] [MainThread]: STDERR: "b''"
[0m12:33:15.719113 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:33:15.719465 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:33:15.719959 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:33:15.720363 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m12:33:15.724399 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.39237666, "process_user_time": 1.250848, "process_kernel_time": 0.736494, "process_mem_max_rss": "102023168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:33:15.725456 [debug] [MainThread]: Command `dbt debug` failed at 12:33:15.725234 after 0.39 seconds
[0m12:33:15.726282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107121e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107318170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107076f10>]}
[0m12:33:15.727013 [debug] [MainThread]: Flushing usage events
[0m12:39:29.557652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce3ed0>]}


============================== 12:39:29.565538 | 27557587-24db-48cd-b9f3-f7ae2e6e84be ==============================
[0m12:39:29.565538 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:39:29.566583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:39:29.597629 [info ] [MainThread]: dbt version: 1.8.8
[0m12:39:29.598543 [info ] [MainThread]: python version: 3.13.0
[0m12:39:29.599009 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m12:39:29.599655 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m12:39:29.615291 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m12:39:29.617048 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m12:39:29.617681 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m12:39:29.618224 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m12:39:29.781897 [info ] [MainThread]: Configuration:
[0m12:39:29.782889 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:39:29.783700 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:39:29.784121 [info ] [MainThread]: Required dependencies:
[0m12:39:29.784767 [debug] [MainThread]: Executing "git --help"
[0m12:39:29.825520 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:39:29.827207 [debug] [MainThread]: STDERR: "b''"
[0m12:39:29.827769 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:39:29.828195 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:39:29.828802 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:39:29.829207 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m12:39:29.832494 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.38516247, "process_user_time": 1.245038, "process_kernel_time": 0.713979, "process_mem_max_rss": "102432768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:29.833267 [debug] [MainThread]: Command `dbt debug` failed at 12:39:29.833163 after 0.39 seconds
[0m12:39:29.834246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e25e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111018170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d76f10>]}
[0m12:39:29.835156 [debug] [MainThread]: Flushing usage events
[0m12:44:48.466254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103251fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e3ed0>]}


============================== 12:44:48.475405 | 69dc6ad8-fa01-4478-8794-60efad90833c ==============================
[0m12:44:48.475405 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:44:48.476228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:48.507680 [info ] [MainThread]: dbt version: 1.8.8
[0m12:44:48.508393 [info ] [MainThread]: python version: 3.13.0
[0m12:44:48.508882 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m12:44:48.509290 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m12:44:48.523052 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m12:44:48.524186 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m12:44:48.524616 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m12:44:48.524956 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m12:44:48.684407 [info ] [MainThread]: Configuration:
[0m12:44:48.685471 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:44:48.686132 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:44:48.686690 [info ] [MainThread]: Required dependencies:
[0m12:44:48.687356 [debug] [MainThread]: Executing "git --help"
[0m12:44:48.736566 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:44:48.738459 [debug] [MainThread]: STDERR: "b''"
[0m12:44:48.739223 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:44:48.739754 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:44:48.740256 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:44:48.740682 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m12:44:48.744180 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.3934531, "process_user_time": 1.236258, "process_kernel_time": 0.712744, "process_mem_max_rss": "102350848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:44:48.745360 [debug] [MainThread]: Command `dbt debug` failed at 12:44:48.745037 after 0.39 seconds
[0m12:44:48.746139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105221e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105414170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105176f10>]}
[0m12:44:48.746743 [debug] [MainThread]: Flushing usage events
[0m13:32:25.255918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10493a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fbed0>]}


============================== 13:32:25.269505 | 3092fdda-e0fd-47aa-93e5-bb39b607e83b ==============================
[0m13:32:25.269505 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:32:25.270806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:25.307029 [info ] [MainThread]: dbt version: 1.8.7
[0m13:32:25.307483 [info ] [MainThread]: python version: 3.13.0
[0m13:32:25.307898 [info ] [MainThread]: python path: /Users/keirayang/Desktop/keira_project/myenv/bin/python3.13
[0m13:32:25.308175 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m13:32:25.324158 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m13:32:25.324856 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m13:32:25.325264 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m13:32:25.325528 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m13:32:25.444119 [info ] [MainThread]: Configuration:
[0m13:32:25.445252 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:32:25.445778 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:32:25.446094 [info ] [MainThread]: Required dependencies:
[0m13:32:25.447245 [debug] [MainThread]: Executing "git --help"
[0m13:32:25.502165 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:32:25.503417 [debug] [MainThread]: STDERR: "b''"
[0m13:32:25.503942 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:32:25.504502 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:32:25.505128 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:32:25.505367 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m13:32:25.518063 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.3560403, "process_user_time": 1.46633, "process_kernel_time": 0.375361, "process_mem_max_rss": "101400576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:25.519173 [debug] [MainThread]: Command `dbt debug` failed at 13:32:25.518974 after 0.36 seconds
[0m13:32:25.519848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a7460>]}
[0m13:32:25.520448 [debug] [MainThread]: Flushing usage events
[0m14:13:32.731857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107836660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218abed0>]}


============================== 14:13:32.739649 | ca5de14f-7e34-46a5-b75c-47b2d07e7795 ==============================
[0m14:13:32.739649 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:13:32.740940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:13:32.768873 [info ] [MainThread]: dbt version: 1.8.7
[0m14:13:32.769355 [info ] [MainThread]: python version: 3.13.0
[0m14:13:32.769736 [info ] [MainThread]: python path: /Users/keirayang/myenv/bin/python3.13
[0m14:13:32.770191 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m14:13:47.585401 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m14:13:47.586941 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m14:13:47.587381 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m14:13:47.588066 [info ] [MainThread]: adapter type: bigquery
[0m14:13:47.588764 [info ] [MainThread]: adapter version: 1.8.3
[0m14:13:47.734089 [info ] [MainThread]: Configuration:
[0m14:13:47.734719 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:13:47.735037 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:13:47.735534 [info ] [MainThread]: Required dependencies:
[0m14:13:47.736271 [debug] [MainThread]: Executing "git --help"
[0m14:13:47.787997 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:13:47.789901 [debug] [MainThread]: STDERR: "b''"
[0m14:13:47.790562 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:13:47.791410 [info ] [MainThread]: Connection:
[0m14:13:47.792151 [info ] [MainThread]:   method: service-account-json
[0m14:13:47.792420 [info ] [MainThread]:   database: keira-xebia
[0m14:13:47.792833 [info ] [MainThread]:   execution_project: keira-xebia
[0m14:13:47.793397 [info ] [MainThread]:   schema: meetupservice
[0m14:13:47.793774 [info ] [MainThread]:   location: None
[0m14:13:47.794057 [info ] [MainThread]:   priority: None
[0m14:13:47.794275 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:13:47.794791 [info ] [MainThread]:   impersonate_service_account: None
[0m14:13:47.795125 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:13:47.795524 [info ] [MainThread]:   job_retries: 1
[0m14:13:47.795945 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:13:47.796333 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:13:47.796802 [info ] [MainThread]:   timeout_seconds: None
[0m14:13:47.797338 [info ] [MainThread]:   client_id: None
[0m14:13:47.797865 [info ] [MainThread]:   token_uri: None
[0m14:13:47.798337 [info ] [MainThread]:   dataproc_region: None
[0m14:13:47.798690 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:13:47.799221 [info ] [MainThread]:   gcs_bucket: None
[0m14:13:47.799487 [info ] [MainThread]:   dataproc_batch: None
[0m14:13:47.800182 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:13:47.992591 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:13:47.993547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:47.997277 [debug] [MainThread]: On debug: select 1 as id
[0m14:13:49.206031 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:fabd8010-7114-4244-8a04-9c13b38dfdf0&page=queryresults
[0m14:13:49.800465 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:13:49.800895 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:13:49.803976 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 17.176908, "process_user_time": 2.009126, "process_kernel_time": 1.214377, "process_mem_max_rss": "201195520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:13:49.804445 [debug] [MainThread]: Command `dbt debug` succeeded at 14:13:49.804362 after 17.18 seconds
[0m14:13:49.804709 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:13:49.804961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e7b360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ecbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f9c380>]}
[0m14:13:49.805234 [debug] [MainThread]: Flushing usage events
[0m14:16:45.655720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103536660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e7ed0>]}


============================== 14:16:45.664162 | b44955c5-c91a-45ec-aeac-59ba8a0ec217 ==============================
[0m14:16:45.664162 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:16:45.664948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:47.525190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf88fc0>]}
[0m14:16:47.631280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc59590>]}
[0m14:16:47.632523 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:16:47.846940 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:16:47.848616 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:47.849101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce71650>]}
[0m14:16:50.135348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d97c8c0>]}
[0m14:16:50.320113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db44c90>]}
[0m14:16:50.320951 [info ] [MainThread]: Found 2 models, 4 data tests, 484 macros
[0m14:16:50.321421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9f87a0>]}
[0m14:16:50.326417 [info ] [MainThread]: 
[0m14:16:50.327274 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:16:50.335452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:16:50.336481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:50.736829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:16:50.737200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:51.006154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db37d10>]}
[0m14:16:51.006647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:51.006926 [info ] [MainThread]: 
[0m14:16:51.016214 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m14:16:51.016668 [info ] [Thread-1 (]: 1 of 2 START sql table model meetupservice.my_first_dbt_model .................. [RUN]
[0m14:16:51.017004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m14:16:51.017246 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m14:16:51.027518 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m14:16:51.029472 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m14:16:51.107657 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_first_dbt_model"
[0m14:16:51.109589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:51.112347 [debug] [Thread-1 (]: On model.keira_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_first_dbt_model"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:16:51.846853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:36656d78-50e3-4e10-bec7-7a72b172297c&page=queryresults
[0m14:16:54.930881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db80100>]}
[0m14:16:54.931461 [info ] [Thread-1 (]: 1 of 2 OK created sql table model meetupservice.my_first_dbt_model ............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.91s]
[0m14:16:54.932053 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m14:16:54.933314 [debug] [Thread-2 (]: Began running node model.keira_project.my_second_dbt_model
[0m14:16:54.934033 [info ] [Thread-2 (]: 2 of 2 START sql view model meetupservice.my_second_dbt_model .................. [RUN]
[0m14:16:54.935468 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.my_second_dbt_model'
[0m14:16:54.936089 [debug] [Thread-2 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m14:16:54.940849 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m14:16:54.942250 [debug] [Thread-2 (]: Began executing node model.keira_project.my_second_dbt_model
[0m14:16:54.983782 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.my_second_dbt_model"
[0m14:16:54.985183 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:16:54.987757 [debug] [Thread-2 (]: On model.keira_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_second_dbt_model"} */


  create or replace view `keira-xebia`.`meetupservice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `keira-xebia`.`meetupservice`.`my_first_dbt_model`
where id = 1;


[0m14:16:55.763817 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:32ba801b-b4aa-410f-8cc9-98474dc08efa&page=queryresults
[0m14:16:55.981286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44955c5-c91a-45ec-aeac-59ba8a0ec217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df04550>]}
[0m14:16:55.981821 [info ] [Thread-2 (]: 2 of 2 OK created sql view model meetupservice.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m14:16:55.982260 [debug] [Thread-2 (]: Finished running node model.keira_project.my_second_dbt_model
[0m14:16:55.983245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:55.983487 [debug] [MainThread]: Connection 'model.keira_project.my_first_dbt_model' was properly closed.
[0m14:16:55.983663 [debug] [MainThread]: Connection 'model.keira_project.my_second_dbt_model' was properly closed.
[0m14:16:55.983870 [info ] [MainThread]: 
[0m14:16:55.984124 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m14:16:55.984726 [debug] [MainThread]: Command end result
[0m14:16:56.032724 [info ] [MainThread]: 
[0m14:16:56.033740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:56.034329 [info ] [MainThread]: 
[0m14:16:56.034726 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:16:56.038842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.48417, "process_user_time": 3.396086, "process_kernel_time": 1.93335, "process_mem_max_rss": "211369984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:56.039525 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:56.039370 after 10.49 seconds
[0m14:16:56.040008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d91b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d91250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051eaf90>]}
[0m14:16:56.040493 [debug] [MainThread]: Flushing usage events
[0m22:29:20.678948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfbed0>]}


============================== 22:29:20.687340 | 7da45181-3215-4e1d-a002-47607c685a86 ==============================
[0m22:29:20.687340 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:20.688369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_events', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:29:20.702754 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m22:29:20.703654 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!
[0m22:29:20.710349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.14286558, "process_user_time": 1.163497, "process_kernel_time": 0.711243, "process_mem_max_rss": "98402304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:20.711215 [debug] [MainThread]: Command `dbt run` failed at 22:29:20.711075 after 0.14 seconds
[0m22:29:20.711970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d22d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d95480>]}
[0m22:29:20.712499 [debug] [MainThread]: Flushing usage events
[0m22:29:50.709951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fbed0>]}


============================== 22:29:50.717486 | 4f6f7d33-e1dc-421f-b677-2c838851f6cb ==============================
[0m22:29:50.717486 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:50.718771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:50.752674 [info ] [MainThread]: dbt version: 1.8.7
[0m22:29:50.753343 [info ] [MainThread]: python version: 3.13.0
[0m22:29:50.753822 [info ] [MainThread]: python path: /Users/keirayang/Desktop/keira_project/myenv/bin/python3.13
[0m22:29:50.754045 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m22:29:50.769685 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m22:29:50.770577 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m22:29:50.771095 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m22:29:50.771553 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m22:29:50.936030 [info ] [MainThread]: Configuration:
[0m22:29:50.936691 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:29:50.937539 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:29:50.938189 [info ] [MainThread]: Required dependencies:
[0m22:29:50.938677 [debug] [MainThread]: Executing "git --help"
[0m22:29:50.985956 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:29:50.987923 [debug] [MainThread]: STDERR: "b''"
[0m22:29:50.988603 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:29:50.988973 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:29:50.989591 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:29:50.990344 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m22:29:50.994123 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.37438622, "process_user_time": 1.261529, "process_kernel_time": 0.645715, "process_mem_max_rss": "100532224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:50.995167 [debug] [MainThread]: Command `dbt debug` failed at 22:29:50.994950 after 0.38 seconds
[0m22:29:50.996045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fe650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106859490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678f460>]}
[0m22:29:50.996707 [debug] [MainThread]: Flushing usage events
[0m22:34:48.830868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10273a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fbed0>]}


============================== 22:34:48.839817 | 44aa7133-78f1-4cbb-84f0-7b414467edeb ==============================
[0m22:34:48.839817 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:34:48.840970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:34:48.870276 [info ] [MainThread]: dbt version: 1.8.7
[0m22:34:48.870933 [info ] [MainThread]: python version: 3.13.0
[0m22:34:48.871362 [info ] [MainThread]: python path: /Users/keirayang/Desktop/keira_project/myenv/bin/python3.13
[0m22:34:48.871880 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m22:34:48.886965 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m22:34:48.887931 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m22:34:48.888421 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m22:34:48.888886 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m22:34:49.043927 [info ] [MainThread]: Configuration:
[0m22:34:49.044823 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:34:49.045546 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:34:49.045942 [info ] [MainThread]: Required dependencies:
[0m22:34:49.046513 [debug] [MainThread]: Executing "git --help"
[0m22:34:49.096937 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:34:49.098529 [debug] [MainThread]: STDERR: "b''"
[0m22:34:49.098839 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:34:49.099346 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:34:49.099957 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:34:49.100478 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m22:34:49.104592 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.39003384, "process_user_time": 1.222337, "process_kernel_time": 0.689356, "process_mem_max_rss": "100958208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:49.105882 [debug] [MainThread]: Command `dbt debug` failed at 22:34:49.105465 after 0.39 seconds
[0m22:34:49.106564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fe650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104655490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104593460>]}
[0m22:34:49.107217 [debug] [MainThread]: Flushing usage events
[0m22:35:59.448686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bfed0>]}


============================== 22:35:59.457207 | 0a721f0f-d359-4d70-b137-99bb6b59930d ==============================
[0m22:35:59.457207 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:35:59.458393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:35:59.488538 [info ] [MainThread]: dbt version: 1.8.7
[0m22:35:59.489130 [info ] [MainThread]: python version: 3.13.0
[0m22:35:59.489479 [info ] [MainThread]: python path: /Users/keirayang/Desktop/keira_project/myenv/bin/python3.13
[0m22:35:59.490043 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m22:35:59.498029 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m22:35:59.498725 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m22:35:59.499250 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m22:35:59.499976 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m22:35:59.661056 [info ] [MainThread]: Configuration:
[0m22:35:59.661764 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:35:59.662332 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:35:59.662913 [info ] [MainThread]: Required dependencies:
[0m22:35:59.663365 [debug] [MainThread]: Executing "git --help"
[0m22:35:59.705782 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:35:59.707887 [debug] [MainThread]: STDERR: "b''"
[0m22:35:59.708633 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:35:59.709359 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:35:59.709971 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:35:59.710376 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m22:35:59.714383 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.37504387, "process_user_time": 1.238894, "process_kernel_time": 0.689063, "process_mem_max_rss": "101187584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:35:59.715392 [debug] [MainThread]: Command `dbt debug` failed at 22:35:59.715232 after 0.38 seconds
[0m22:35:59.716317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107319490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107253460>]}
[0m22:35:59.716963 [debug] [MainThread]: Flushing usage events
[0m22:55:07.126750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bfed0>]}


============================== 22:55:07.134947 | 632eceea-1cdf-456d-a9a4-179faf377dde ==============================
[0m22:55:07.134947 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:55:07.135921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:55:07.165827 [info ] [MainThread]: dbt version: 1.8.7
[0m22:55:07.166439 [info ] [MainThread]: python version: 3.13.0
[0m22:55:07.166971 [info ] [MainThread]: python path: /Users/keirayang/Desktop/keira_project/myenv/bin/python3.13
[0m22:55:07.167348 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m22:55:07.178995 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.bigquery'
[0m22:55:07.180402 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m22:55:07.181094 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m22:55:07.181635 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m22:55:07.323992 [info ] [MainThread]: Configuration:
[0m22:55:07.324810 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:55:07.325279 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:55:07.325545 [info ] [MainThread]: Required dependencies:
[0m22:55:07.326070 [debug] [MainThread]: Executing "git --help"
[0m22:55:07.373364 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:55:07.375123 [debug] [MainThread]: STDERR: "b''"
[0m22:55:07.375724 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:55:07.376291 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:55:07.376908 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:55:07.377579 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "keira_project", target "dev" invalid: Runtime Error
    Could not find adapter type bigquery!


[0m22:55:07.381384 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.35797504, "process_user_time": 1.241955, "process_kernel_time": 0.696278, "process_mem_max_rss": "100827136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:55:07.382345 [debug] [MainThread]: Command `dbt debug` failed at 22:55:07.382082 after 0.36 seconds
[0m22:55:07.383244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107419490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107357460>]}
[0m22:55:07.383902 [debug] [MainThread]: Flushing usage events
[0m22:56:21.459338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eabed0>]}


============================== 22:56:21.466210 | ee913c1b-6da3-4b86-8370-91236201f3a3 ==============================
[0m22:56:21.466210 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:56:21.466950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:56:21.503135 [info ] [MainThread]: dbt version: 1.8.7
[0m22:56:21.503858 [info ] [MainThread]: python version: 3.13.0
[0m22:56:21.504184 [info ] [MainThread]: python path: /Users/keirayang/myenv/bin/python3.13
[0m22:56:21.504448 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m22:56:23.641808 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m22:56:23.642392 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m22:56:23.642843 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m22:56:23.643197 [info ] [MainThread]: adapter type: bigquery
[0m22:56:23.643567 [info ] [MainThread]: adapter version: 1.8.3
[0m22:56:23.775706 [info ] [MainThread]: Configuration:
[0m22:56:23.776573 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:56:23.777188 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:56:23.777752 [info ] [MainThread]: Required dependencies:
[0m22:56:23.778865 [debug] [MainThread]: Executing "git --help"
[0m22:56:23.828785 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:56:23.830828 [debug] [MainThread]: STDERR: "b''"
[0m22:56:23.831861 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:56:23.832639 [info ] [MainThread]: Connection:
[0m22:56:23.833257 [info ] [MainThread]:   method: service-account-json
[0m22:56:23.833815 [info ] [MainThread]:   database: keira-xebia
[0m22:56:23.834191 [info ] [MainThread]:   execution_project: keira-xebia
[0m22:56:23.834532 [info ] [MainThread]:   schema: meetupservice
[0m22:56:23.834950 [info ] [MainThread]:   location: None
[0m22:56:23.835458 [info ] [MainThread]:   priority: None
[0m22:56:23.835837 [info ] [MainThread]:   maximum_bytes_billed: None
[0m22:56:23.836196 [info ] [MainThread]:   impersonate_service_account: None
[0m22:56:23.836668 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m22:56:23.837018 [info ] [MainThread]:   job_retries: 1
[0m22:56:23.837379 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m22:56:23.837695 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m22:56:23.838261 [info ] [MainThread]:   timeout_seconds: None
[0m22:56:23.838726 [info ] [MainThread]:   client_id: None
[0m22:56:23.839154 [info ] [MainThread]:   token_uri: None
[0m22:56:23.839579 [info ] [MainThread]:   dataproc_region: None
[0m22:56:23.839790 [info ] [MainThread]:   dataproc_cluster_name: None
[0m22:56:23.840248 [info ] [MainThread]:   gcs_bucket: None
[0m22:56:23.840970 [info ] [MainThread]:   dataproc_batch: None
[0m22:56:23.842252 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m22:56:24.038232 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m22:56:24.039523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:24.042941 [debug] [MainThread]: On debug: select 1 as id
[0m22:56:24.791169 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:0b8c3ed2-9c5a-4214-9387-503e623dee47&page=queryresults
[0m22:56:25.682386 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:56:25.682848 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:56:25.685429 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.3456635, "process_user_time": 2.203818, "process_kernel_time": 1.319224, "process_mem_max_rss": "199081984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:56:25.685932 [debug] [MainThread]: Command `dbt debug` succeeded at 22:56:25.685844 after 4.35 seconds
[0m22:56:25.686210 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:56:25.686466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113907530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113990490>]}
[0m22:56:25.686791 [debug] [MainThread]: Flushing usage events
[0m22:58:37.759017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e7ed0>]}


============================== 22:58:37.767309 | 6c21d02c-bc89-4a87-a608-19f69948d8bf ==============================
[0m22:58:37.767309 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:58:37.768021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:58:37.797815 [info ] [MainThread]: dbt version: 1.8.7
[0m22:58:37.798683 [info ] [MainThread]: python version: 3.13.0
[0m22:58:37.799183 [info ] [MainThread]: python path: /Users/keirayang/myenv/bin/python3.13
[0m22:58:37.799501 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit-Mach-O
[0m22:58:39.527333 [info ] [MainThread]: Using profiles dir at /Users/keirayang/.dbt
[0m22:58:39.528212 [info ] [MainThread]: Using profiles.yml file at /Users/keirayang/.dbt/profiles.yml
[0m22:58:39.528776 [info ] [MainThread]: Using dbt_project.yml file at /Users/keirayang/Desktop/keira_project/dbt_project.yml
[0m22:58:39.529173 [info ] [MainThread]: adapter type: bigquery
[0m22:58:39.529569 [info ] [MainThread]: adapter version: 1.8.3
[0m22:58:39.684661 [info ] [MainThread]: Configuration:
[0m22:58:39.685378 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:58:39.686169 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:58:39.686628 [info ] [MainThread]: Required dependencies:
[0m22:58:39.687364 [debug] [MainThread]: Executing "git --help"
[0m22:58:39.728044 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:58:39.729750 [debug] [MainThread]: STDERR: "b''"
[0m22:58:39.730365 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:58:39.730939 [info ] [MainThread]: Connection:
[0m22:58:39.731791 [info ] [MainThread]:   method: service-account-json
[0m22:58:39.732497 [info ] [MainThread]:   database: keira-xebia
[0m22:58:39.732887 [info ] [MainThread]:   execution_project: keira-xebia
[0m22:58:39.733353 [info ] [MainThread]:   schema: meetupservice
[0m22:58:39.733687 [info ] [MainThread]:   location: None
[0m22:58:39.734125 [info ] [MainThread]:   priority: None
[0m22:58:39.734531 [info ] [MainThread]:   maximum_bytes_billed: None
[0m22:58:39.734950 [info ] [MainThread]:   impersonate_service_account: None
[0m22:58:39.735507 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m22:58:39.736157 [info ] [MainThread]:   job_retries: 1
[0m22:58:39.736697 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m22:58:39.737040 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m22:58:39.737461 [info ] [MainThread]:   timeout_seconds: None
[0m22:58:39.737978 [info ] [MainThread]:   client_id: None
[0m22:58:39.738337 [info ] [MainThread]:   token_uri: None
[0m22:58:39.738707 [info ] [MainThread]:   dataproc_region: None
[0m22:58:39.739401 [info ] [MainThread]:   dataproc_cluster_name: None
[0m22:58:39.739874 [info ] [MainThread]:   gcs_bucket: None
[0m22:58:39.740510 [info ] [MainThread]:   dataproc_batch: None
[0m22:58:39.742032 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m22:58:39.943833 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m22:58:39.944904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:39.948442 [debug] [MainThread]: On debug: select 1 as id
[0m22:58:40.642936 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:d6e3dab4-e915-4f79-9e97-c85cb4ac4f0d&page=queryresults
[0m22:58:41.256747 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:58:41.257172 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:58:41.260224 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.607275, "process_user_time": 2.006395, "process_kernel_time": 1.268035, "process_mem_max_rss": "199704576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:58:41.260697 [debug] [MainThread]: Command `dbt debug` succeeded at 22:58:41.260611 after 3.61 seconds
[0m22:58:41.261003 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:58:41.261328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc2d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e07530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e90490>]}
[0m22:58:41.261642 [debug] [MainThread]: Flushing usage events
[0m23:08:06.578190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071abed0>]}


============================== 23:08:06.586573 | 94ff21db-6afd-4ca9-9616-581da09bbb3a ==============================
[0m23:08:06.586573 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:08:06.587600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:08:08.553296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94ff21db-6afd-4ca9-9616-581da09bbb3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116288fc0>]}
[0m23:08:08.651492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94ff21db-6afd-4ca9-9616-581da09bbb3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116059590>]}
[0m23:08:08.652540 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:08:08.870223 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:08:09.086042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:08:09.086940 [debug] [MainThread]: Partial parsing: added file: keira_project://models/stg_events.sql
[0m23:08:09.401760 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.keira_project.stg_events' (models/stg_events.sql) depends on a source named 'meetupservice.source_events' which was not found
[0m23:08:09.406577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9344974, "process_user_time": 2.246924, "process_kernel_time": 1.40377, "process_mem_max_rss": "203505664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:08:09.407787 [debug] [MainThread]: Command `dbt run` failed at 23:08:09.407620 after 2.94 seconds
[0m23:08:09.408497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116177750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116175b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11783e990>]}
[0m23:08:09.409185 [debug] [MainThread]: Flushing usage events
[0m23:09:03.498476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107636660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213e7ed0>]}


============================== 23:09:03.506783 | 86d933aa-f122-408f-bfce-39b0b1cf2adf ==============================
[0m23:09:03.506783 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:03.507910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_events', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:05.444103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86d933aa-f122-408f-bfce-39b0b1cf2adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142888fc0>]}
[0m23:09:05.540440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86d933aa-f122-408f-bfce-39b0b1cf2adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141e59590>]}
[0m23:09:05.541826 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:09:05.755334 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:09:05.973099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:09:05.974202 [debug] [MainThread]: Partial parsing: added file: keira_project://models/stg_events.sql
[0m23:09:06.283254 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.keira_project.stg_events' (models/stg_events.sql) depends on a source named 'meetupservice.source_events' which was not found
[0m23:09:06.288304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8985987, "process_user_time": 2.245807, "process_kernel_time": 1.392467, "process_mem_max_rss": "201392128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:09:06.289225 [debug] [MainThread]: Command `dbt run` failed at 23:09:06.289020 after 2.90 seconds
[0m23:09:06.289906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f73750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141f71b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142e3e990>]}
[0m23:09:06.290563 [debug] [MainThread]: Flushing usage events
[0m23:13:15.593554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7ed0>]}


============================== 23:13:15.601642 | 824e11c9-b200-44a0-94de-45554a07939e ==============================
[0m23:13:15.601642 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:13:15.602419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_events', 'send_anonymous_usage_stats': 'True'}
[0m23:13:17.533674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '824e11c9-b200-44a0-94de-45554a07939e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f588fc0>]}
[0m23:13:17.630223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '824e11c9-b200-44a0-94de-45554a07939e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f359590>]}
[0m23:13:17.631253 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:13:17.832217 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:13:18.034717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m23:13:18.035935 [debug] [MainThread]: Partial parsing: added file: keira_project://models/stg_events.sql
[0m23:13:18.036726 [debug] [MainThread]: Partial parsing: added file: keira_project://models/sources.yml
[0m23:13:18.646136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '824e11c9-b200-44a0-94de-45554a07939e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8ad850>]}
[0m23:13:18.849771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '824e11c9-b200-44a0-94de-45554a07939e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f93e990>]}
[0m23:13:18.850660 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 484 macros
[0m23:13:18.851176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824e11c9-b200-44a0-94de-45554a07939e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f96c9f0>]}
[0m23:13:18.854412 [info ] [MainThread]: 
[0m23:13:18.855246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:13:18.856520 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:13:18.857120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:19.247634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:13:19.248051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:19.507868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824e11c9-b200-44a0-94de-45554a07939e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb31090>]}
[0m23:13:19.508366 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:13:19.508618 [info ] [MainThread]: 
[0m23:13:19.511216 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m23:13:19.511655 [info ] [Thread-1 (]: 1 of 1 START sql view model meetupservice.stg_events ........................... [RUN]
[0m23:13:19.511985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m23:13:19.512234 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m23:13:19.522685 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m23:13:19.523931 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m23:13:19.582114 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m23:13:19.583618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:19.586523 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */


  create or replace view `keira-xebia`.`meetupservice`.`stg_events`
  OPTIONS()
  as SELECT 
  venue_id,
  time,
  status,
  duration,
  rsvp_limit,
  created,
  group_id,
  name,
  description,
  UNNEST(rsvps) AS rsvps
FROM 
  `keira-xebia`.`meetupservice`.`source_events`;


[0m23:13:20.054890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:3eb78fbc-b1e6-465d-ab79-0eb61d999475&page=queryresults
[0m23:13:20.055442 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword UNNEST at [16:3]; reason: invalidQuery, location: query, message: Syntax error: Expected end of input but got keyword UNNEST at [16:3]')
[0m23:13:21.180034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:a8079a0c-3c0a-4bf4-9746-99d23d08fd4f&page=queryresults
[0m23:13:21.180558 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:a8079a0c-3c0a-4bf4-9746-99d23d08fd4f&page=queryresults
[0m23:13:21.191226 [debug] [Thread-1 (]: Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected end of input but got keyword UNNEST at [16:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:13:21.192478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824e11c9-b200-44a0-94de-45554a07939e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb25e50>]}
[0m23:13:21.192974 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model meetupservice.stg_events .................. [[31mERROR[0m in 1.68s]
[0m23:13:21.193405 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m23:13:21.194839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:21.195083 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m23:13:21.195292 [info ] [MainThread]: 
[0m23:13:21.195509 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m23:13:21.195975 [debug] [MainThread]: Command end result
[0m23:13:21.246903 [info ] [MainThread]: 
[0m23:13:21.247829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:13:21.248216 [info ] [MainThread]: 
[0m23:13:21.248804 [error] [MainThread]:   Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected end of input but got keyword UNNEST at [16:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:13:21.249382 [info ] [MainThread]: 
[0m23:13:21.249897 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:13:21.253181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7660613, "process_user_time": 2.715819, "process_kernel_time": 1.565884, "process_mem_max_rss": "208961536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:13:21.254052 [debug] [MainThread]: Command `dbt run` failed at 23:13:21.253820 after 5.77 seconds
[0m23:13:21.254753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9f49f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cdf070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5bfcf0>]}
[0m23:13:21.255267 [debug] [MainThread]: Flushing usage events
[0m23:16:02.542689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ce7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ce7ed0>]}


============================== 23:16:02.550563 | 30ea1f6d-390d-4162-933a-afe4813edb38 ==============================
[0m23:16:02.550563 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:16:02.551265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:16:04.521177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30ea1f6d-390d-4162-933a-afe4813edb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142b88fc0>]}
[0m23:16:04.621571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30ea1f6d-390d-4162-933a-afe4813edb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142959590>]}
[0m23:16:04.623023 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:16:04.835629 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:16:05.071735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:16:05.073082 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events.sql
[0m23:16:05.541579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30ea1f6d-390d-4162-933a-afe4813edb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142fc4a50>]}
[0m23:16:05.737435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30ea1f6d-390d-4162-933a-afe4813edb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142aa7980>]}
[0m23:16:05.738676 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 484 macros
[0m23:16:05.739547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30ea1f6d-390d-4162-933a-afe4813edb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143087d90>]}
[0m23:16:05.743105 [info ] [MainThread]: 
[0m23:16:05.744301 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:16:05.746139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:16:05.746839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:06.134146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:16:06.134510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:16:06.404285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30ea1f6d-390d-4162-933a-afe4813edb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14307fa00>]}
[0m23:16:06.404806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:06.405042 [info ] [MainThread]: 
[0m23:16:06.407690 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m23:16:06.408151 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m23:16:06.408509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m23:16:06.408780 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m23:16:06.416573 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m23:16:06.417317 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m23:16:06.491451 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m23:16:06.492793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:16:06.495286 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS(
  SELECT 
      venue_id,
      time AS event_start_time,
      status AS event_status,
      duration AS event_duration,
      rsvp_limit AS rsvp_total_limit,
      created AS event_create_time,
      group_id,
      name AS event_name,
      description AS event_description,
      UNNEST(rsvps) AS rsvp
  FROM 
      `keira-xebia`.`meetupservice`.`source_events`
)


SELECT
  group_id,
  venue_id,
  event_name,
  event_start_time,
  event_status,
  event_duration,
  event_create_time,
  event_description,
  rsvp_total_limit,
  rsvp.user_id,
  rsvp.response,
  rsvp.when,
  rsvp.guests
FROM events
    );
  
[0m23:16:06.968795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:10fde6e3-576f-4202-b6cf-c4d96ab6edf0&page=queryresults
[0m23:16:06.969362 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword UNNEST at [27:7]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword UNNEST at [27:7]')
[0m23:16:08.093896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:12b2ef7d-e1a1-49a8-bf99-01a1d39f76db&page=queryresults
[0m23:16:08.094461 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:12b2ef7d-e1a1-49a8-bf99-01a1d39f76db&page=queryresults
[0m23:16:08.104051 [debug] [Thread-1 (]: Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [27:7]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:16:08.105374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30ea1f6d-390d-4162-933a-afe4813edb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143162a50>]}
[0m23:16:08.105892 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events ................. [[31mERROR[0m in 1.70s]
[0m23:16:08.106333 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m23:16:08.107879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:08.108124 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m23:16:08.108332 [info ] [MainThread]: 
[0m23:16:08.108548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m23:16:08.109013 [debug] [MainThread]: Command end result
[0m23:16:08.172890 [info ] [MainThread]: 
[0m23:16:08.173787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:16:08.174272 [info ] [MainThread]: 
[0m23:16:08.174781 [error] [MainThread]:   Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [27:7]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:16:08.175191 [info ] [MainThread]: 
[0m23:16:08.175616 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:16:08.179162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7420936, "process_user_time": 2.704018, "process_kernel_time": 1.572851, "process_mem_max_rss": "209223680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:16:08.180063 [debug] [MainThread]: Command `dbt run` failed at 23:16:08.179864 after 5.74 seconds
[0m23:16:08.180650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1430e7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142b53610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142b53bb0>]}
[0m23:16:08.181218 [debug] [MainThread]: Flushing usage events
[0m23:23:17.179193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107236660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129abed0>]}


============================== 23:23:17.188002 | 37733eee-8c12-4982-b82d-909322bbbb1b ==============================
[0m23:23:17.188002 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:23:17.189163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_events', 'send_anonymous_usage_stats': 'True'}
[0m23:23:19.197846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37733eee-8c12-4982-b82d-909322bbbb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c88fc0>]}
[0m23:23:19.295672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37733eee-8c12-4982-b82d-909322bbbb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134959590>]}
[0m23:23:19.297097 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:23:19.492159 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:23:19.734721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:23:19.736163 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events.sql
[0m23:23:20.195881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37733eee-8c12-4982-b82d-909322bbbb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134fc4a50>]}
[0m23:23:20.393380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37733eee-8c12-4982-b82d-909322bbbb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134aa7890>]}
[0m23:23:20.394173 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 484 macros
[0m23:23:20.394693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37733eee-8c12-4982-b82d-909322bbbb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135187d90>]}
[0m23:23:20.397742 [info ] [MainThread]: 
[0m23:23:20.398899 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:23:20.400441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:23:20.400977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:20.941066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:23:20.941471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:21.192486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37733eee-8c12-4982-b82d-909322bbbb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13517fa00>]}
[0m23:23:21.192997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:23:21.193227 [info ] [MainThread]: 
[0m23:23:21.197697 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m23:23:21.198515 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m23:23:21.199463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m23:23:21.200142 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m23:23:21.216700 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m23:23:21.218206 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m23:23:21.295587 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m23:23:21.296850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:21.299662 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
  SELECT 
      venue_id,
      time AS event_start_time,
      status AS event_status,
      duration AS event_duration,
      rsvp_limit AS rsvp_total_limit,
      created AS event_create_time,
      group_id,
      name AS event_name,
      description AS event_description,
      rsvp.user_id,
      rsvp.response,
      rsvp.when AS rsvp.response_time,
      rsvp.guests
  FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)


SELECT
  group_id,
  venue_id,
  event_name,
  event_start_time,
  event_status,
  event_duration,
  event_create_time,
  event_description,
  rsvp_total_limit,
  rsvp.user_id,
  rsvp.response,
  rsvp.response_time,
  rsvp.guests
FROM events
    );
  
[0m23:23:21.745502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:32a32516-5f5e-4834-916b-84ab9e8cd4dc&page=queryresults
[0m23:23:21.746199 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "." at [29:24]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "." at [29:24]')
[0m23:23:22.270076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:d51f09dd-6283-4372-8e4c-10f7cb2435bc&page=queryresults
[0m23:23:22.270606 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:d51f09dd-6283-4372-8e4c-10f7cb2435bc&page=queryresults
[0m23:23:22.281165 [debug] [Thread-1 (]: Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected ")" but got "." at [29:24]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:23:22.282698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37733eee-8c12-4982-b82d-909322bbbb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135262bd0>]}
[0m23:23:22.283323 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events ................. [[31mERROR[0m in 1.08s]
[0m23:23:22.283819 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m23:23:22.285689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:22.286039 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m23:23:22.286311 [info ] [MainThread]: 
[0m23:23:22.286669 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m23:23:22.288282 [debug] [MainThread]: Command end result
[0m23:23:22.353246 [info ] [MainThread]: 
[0m23:23:22.354232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:23:22.354669 [info ] [MainThread]: 
[0m23:23:22.355220 [error] [MainThread]:   Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected ")" but got "." at [29:24]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:23:22.355805 [info ] [MainThread]: 
[0m23:23:22.356166 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:23:22.360483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2870874, "process_user_time": 2.690129, "process_kernel_time": 1.575491, "process_mem_max_rss": "209076224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:23:22.361535 [debug] [MainThread]: Command `dbt run` failed at 23:23:22.361318 after 5.29 seconds
[0m23:23:22.362348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134edfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c37610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c37bb0>]}
[0m23:23:22.362950 [debug] [MainThread]: Flushing usage events
[0m23:25:26.963147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107536660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1295abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1295abed0>]}


============================== 23:25:26.971010 | 53bcfe6f-0bfa-44e9-9723-a1a24829bc12 ==============================
[0m23:25:26.971010 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:25:26.972002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_events', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:25:28.952153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53bcfe6f-0bfa-44e9-9723-a1a24829bc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a088fc0>]}
[0m23:25:29.049445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53bcfe6f-0bfa-44e9-9723-a1a24829bc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139d59590>]}
[0m23:25:29.050770 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:25:29.305923 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:25:29.544592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:25:29.546021 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events.sql
[0m23:25:29.989710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53bcfe6f-0bfa-44e9-9723-a1a24829bc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a4a4a50>]}
[0m23:25:30.183425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53bcfe6f-0bfa-44e9-9723-a1a24829bc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139ea7890>]}
[0m23:25:30.184442 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 484 macros
[0m23:25:30.184983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53bcfe6f-0bfa-44e9-9723-a1a24829bc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a587d90>]}
[0m23:25:30.187445 [info ] [MainThread]: 
[0m23:25:30.188334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:25:30.189688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:25:30.190235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:30.571232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:25:30.571620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:30.814482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53bcfe6f-0bfa-44e9-9723-a1a24829bc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a57fa00>]}
[0m23:25:30.814979 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:25:30.815258 [info ] [MainThread]: 
[0m23:25:30.817771 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m23:25:30.818453 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m23:25:30.819233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m23:25:30.819834 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m23:25:30.835959 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m23:25:30.837707 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m23:25:30.912685 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m23:25:30.914231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:30.916847 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
  SELECT 
      venue_id,
      time AS event_start_time,
      status AS event_status,
      duration AS event_duration,
      rsvp_limit AS rsvp_total_limit,
      created AS event_create_time,
      group_id,
      name AS event_name,
      description AS event_description,
      rsvp.user_id,
      rsvp.response,
      rsvp.when,
      rsvp.guests
  FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)


SELECT
  group_id,
  venue_id,
  event_name,
  event_start_time,
  event_status,
  event_duration,
  event_create_time,
  event_description,
  rsvp_total_limit,
  rsvp.user_id,
  rsvp.response,
  rsvp.when,
  rsvp.guests
FROM events
    );
  
[0m23:25:31.805994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1e369552-1b9f-41e5-a569-25c88b278cd8&page=queryresults
[0m23:25:31.914341 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp at [47:3]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp at [47:3]')
[0m23:25:33.240494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0667391b-4d55-4fac-8859-0c1465cda28c&page=queryresults
[0m23:25:33.331351 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0667391b-4d55-4fac-8859-0c1465cda28c&page=queryresults
[0m23:25:33.341454 [debug] [Thread-1 (]: Database Error in model stg_events (models/stg_events.sql)
  Unrecognized name: rsvp at [47:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:25:33.342705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53bcfe6f-0bfa-44e9-9723-a1a24829bc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a662a50>]}
[0m23:25:33.343191 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events ................. [[31mERROR[0m in 2.52s]
[0m23:25:33.343617 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m23:25:33.344990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:33.345210 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m23:25:33.345452 [info ] [MainThread]: 
[0m23:25:33.345690 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m23:25:33.346152 [debug] [MainThread]: Command end result
[0m23:25:33.403977 [info ] [MainThread]: 
[0m23:25:33.405260 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:25:33.405665 [info ] [MainThread]: 
[0m23:25:33.406446 [error] [MainThread]:   Database Error in model stg_events (models/stg_events.sql)
  Unrecognized name: rsvp at [47:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:25:33.406817 [info ] [MainThread]: 
[0m23:25:33.407430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:25:33.411120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.555417, "process_user_time": 2.686424, "process_kernel_time": 1.554576, "process_mem_max_rss": "208896000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:25:33.411941 [debug] [MainThread]: Command `dbt run` failed at 23:25:33.411862 after 6.56 seconds
[0m23:25:33.412454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a5ebee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a053610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a053bb0>]}
[0m23:25:33.412906 [debug] [MainThread]: Flushing usage events
[0m23:31:23.825396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e7ed0>]}


============================== 23:31:23.833169 | 36c4175d-d81b-4dec-95a9-b9c0af153b58 ==============================
[0m23:31:23.833169 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:31:23.834406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_events', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:25.838703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36c4175d-d81b-4dec-95a9-b9c0af153b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f588fc0>]}
[0m23:31:25.935138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36c4175d-d81b-4dec-95a9-b9c0af153b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f359590>]}
[0m23:31:25.936293 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:31:26.135525 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:31:26.372512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:31:26.373861 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events.sql
[0m23:31:26.837229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36c4175d-d81b-4dec-95a9-b9c0af153b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fac0a50>]}
[0m23:31:27.028344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36c4175d-d81b-4dec-95a9-b9c0af153b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f4a7890>]}
[0m23:31:27.029407 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 484 macros
[0m23:31:27.030225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c4175d-d81b-4dec-95a9-b9c0af153b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb83d90>]}
[0m23:31:27.033625 [info ] [MainThread]: 
[0m23:31:27.034853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:31:27.036556 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:31:27.037100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:27.443796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:31:27.444264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:27.768381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c4175d-d81b-4dec-95a9-b9c0af153b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb7fa00>]}
[0m23:31:27.768893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:27.769128 [info ] [MainThread]: 
[0m23:31:27.771800 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m23:31:27.772265 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m23:31:27.772623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m23:31:27.772902 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m23:31:27.780708 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m23:31:27.781665 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m23:31:27.858663 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m23:31:27.860412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:27.863063 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
  SELECT 
      venue_id,
      time AS event_start_time,
      status AS event_status,
      duration AS event_duration,
      rsvp_limit AS rsvp_total_limit,
      created AS event_create_time,
      group_id,
      name AS event_name,
      description AS event_description,
      rsvp.user_id AS rsvp_user_id,
      rsvp.response AS rsvp_response,
      rsvp.when AS rsvp_response_time,
      rsvp.guests AS rsvp_guests
  FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT
  group_id,
  venue_id,
  event_name,
  event_start_time,
  event_status,
  event_duration,
  event_create_time,
  event_description,
  rsvp_total_limit,
  rsvp_user_id
  rsvp_response,
  rsvp_respinse_time,
  rsvp_guests
FROM events
    );
  
[0m23:31:28.499606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7976367f-831e-4b51-b5f7-05eab831cd3b&page=queryresults
[0m23:31:28.591726 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]')
[0m23:31:30.001658 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ab9c1b47-81cd-438a-8f77-0c392ab40a97&page=queryresults
[0m23:31:30.081373 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ab9c1b47-81cd-438a-8f77-0c392ab40a97&page=queryresults
[0m23:31:30.091802 [debug] [Thread-1 (]: Database Error in model stg_events (models/stg_events.sql)
  Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:31:30.093133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c4175d-d81b-4dec-95a9-b9c0af153b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc62a50>]}
[0m23:31:30.093654 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events ................. [[31mERROR[0m in 2.32s]
[0m23:31:30.094092 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m23:31:30.095703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:30.095937 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m23:31:30.096138 [info ] [MainThread]: 
[0m23:31:30.096351 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m23:31:30.097273 [debug] [MainThread]: Command end result
[0m23:31:30.160882 [info ] [MainThread]: 
[0m23:31:30.161895 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:31:30.162661 [info ] [MainThread]: 
[0m23:31:30.163386 [error] [MainThread]:   Database Error in model stg_events (models/stg_events.sql)
  Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:31:30.163999 [info ] [MainThread]: 
[0m23:31:30.164463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:31:30.169021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.4507155, "process_user_time": 2.687037, "process_kernel_time": 1.569713, "process_mem_max_rss": "207978496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:30.169913 [debug] [MainThread]: Command `dbt run` failed at 23:31:30.169777 after 6.45 seconds
[0m23:31:30.170131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f8dfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f553610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f553bb0>]}
[0m23:31:30.170302 [debug] [MainThread]: Flushing usage events
[0m23:31:46.424217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103336660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7ed0>]}


============================== 23:31:46.431730 | 3c33e155-192c-4406-9c31-bf05edbb7b5f ==============================
[0m23:31:46.431730 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:31:46.432813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:48.346803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c33e155-192c-4406-9c31-bf05edbb7b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116788fc0>]}
[0m23:31:48.448920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c33e155-192c-4406-9c31-bf05edbb7b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116559590>]}
[0m23:31:48.450411 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:31:48.644870 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:31:48.911690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:48.912383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:48.998415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c33e155-192c-4406-9c31-bf05edbb7b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116673e50>]}
[0m23:31:49.198735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c33e155-192c-4406-9c31-bf05edbb7b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166a7890>]}
[0m23:31:49.199515 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 484 macros
[0m23:31:49.199974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c33e155-192c-4406-9c31-bf05edbb7b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116701d30>]}
[0m23:31:49.202558 [info ] [MainThread]: 
[0m23:31:49.203439 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:31:49.205057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:31:49.205793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:49.585747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:31:49.586170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:49.836430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c33e155-192c-4406-9c31-bf05edbb7b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ae75f0>]}
[0m23:31:49.836988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:49.837242 [info ] [MainThread]: 
[0m23:31:49.841360 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m23:31:49.842352 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m23:31:49.842971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m23:31:49.843412 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m23:31:49.863006 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m23:31:49.864137 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m23:31:49.940855 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m23:31:49.942332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:49.945181 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
  SELECT 
      venue_id,
      time AS event_start_time,
      status AS event_status,
      duration AS event_duration,
      rsvp_limit AS rsvp_total_limit,
      created AS event_create_time,
      group_id,
      name AS event_name,
      description AS event_description,
      rsvp.user_id AS rsvp_user_id,
      rsvp.response AS rsvp_response,
      rsvp.when AS rsvp_response_time,
      rsvp.guests AS rsvp_guests
  FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT
  group_id,
  venue_id,
  event_name,
  event_start_time,
  event_status,
  event_duration,
  event_create_time,
  event_description,
  rsvp_total_limit,
  rsvp_user_id
  rsvp_response,
  rsvp_respinse_time,
  rsvp_guests
FROM events
    );
  
[0m23:31:50.687180 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e2569cfe-0e8a-4c17-93ab-3007d6315b96&page=queryresults
[0m23:31:50.788371 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]')
[0m23:31:51.843096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2536e28f-8129-4529-94e3-50663e369f88&page=queryresults
[0m23:31:51.985336 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2536e28f-8129-4529-94e3-50663e369f88&page=queryresults
[0m23:31:51.997962 [debug] [Thread-1 (]: Database Error in model stg_events (models/stg_events.sql)
  Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:31:51.999328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c33e155-192c-4406-9c31-bf05edbb7b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b462d0>]}
[0m23:31:51.999849 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events ................. [[31mERROR[0m in 2.16s]
[0m23:31:52.000294 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m23:31:52.002253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:52.002782 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m23:31:52.003332 [info ] [MainThread]: 
[0m23:31:52.003974 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m23:31:52.004973 [debug] [MainThread]: Command end result
[0m23:31:52.058195 [info ] [MainThread]: 
[0m23:31:52.058980 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:31:52.059381 [info ] [MainThread]: 
[0m23:31:52.060060 [error] [MainThread]:   Database Error in model stg_events (models/stg_events.sql)
  Unrecognized name: rsvp_respinse_time; Did you mean rsvp_response_time? at [48:3]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m23:31:52.060461 [info ] [MainThread]: 
[0m23:31:52.060953 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:31:52.064577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7494617, "process_user_time": 2.505487, "process_kernel_time": 1.468021, "process_mem_max_rss": "205504512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:52.065458 [debug] [MainThread]: Command `dbt run` failed at 23:31:52.065339 after 5.75 seconds
[0m23:31:52.066056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b7be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b7f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b7fb10>]}
[0m23:31:52.066739 [debug] [MainThread]: Flushing usage events
[0m23:32:09.255358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106926660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189abed0>]}


============================== 23:32:09.263387 | c6c84d2b-2053-4b0b-b323-d9d762dabe07 ==============================
[0m23:32:09.263387 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:32:09.264567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:32:11.200906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6c84d2b-2053-4b0b-b323-d9d762dabe07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a588fc0>]}
[0m23:32:11.295356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6c84d2b-2053-4b0b-b323-d9d762dabe07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a259590>]}
[0m23:32:11.296535 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:32:11.503304 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:32:11.738222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:11.739397 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events.sql
[0m23:32:12.198140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c84d2b-2053-4b0b-b323-d9d762dabe07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a9c4a50>]}
[0m23:32:12.383822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c84d2b-2053-4b0b-b323-d9d762dabe07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a3a7890>]}
[0m23:32:12.384683 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 484 macros
[0m23:32:12.385115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c84d2b-2053-4b0b-b323-d9d762dabe07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aa87d90>]}
[0m23:32:12.388111 [info ] [MainThread]: 
[0m23:32:12.389144 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:32:12.390886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:32:12.391561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:12.742873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:32:12.743238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:12.981891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c84d2b-2053-4b0b-b323-d9d762dabe07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aa7fa00>]}
[0m23:32:12.982378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:12.982637 [info ] [MainThread]: 
[0m23:32:12.984729 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m23:32:12.985166 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m23:32:12.985552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m23:32:12.986138 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m23:32:13.003795 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m23:32:13.005325 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m23:32:13.078325 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m23:32:13.079996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:13.083002 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
  SELECT 
      venue_id,
      time AS event_start_time,
      status AS event_status,
      duration AS event_duration,
      rsvp_limit AS rsvp_total_limit,
      created AS event_create_time,
      group_id,
      name AS event_name,
      description AS event_description,
      rsvp.user_id AS rsvp_user_id,
      rsvp.response AS rsvp_response,
      rsvp.when AS rsvp_response_time,
      rsvp.guests AS rsvp_guests
  FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT
  group_id,
  venue_id,
  event_name,
  event_start_time,
  event_status,
  event_duration,
  event_create_time,
  event_description,
  rsvp_total_limit,
  rsvp_user_id
  rsvp_response,
  rsvp_response_time,
  rsvp_guests
FROM events
    );
  
[0m23:32:13.726850 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:3027ed92-2233-454a-92b0-ef347ef3abe8&page=queryresults
[0m23:32:18.981119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c84d2b-2053-4b0b-b323-d9d762dabe07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ab62810>]}
[0m23:32:18.981741 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events ..................... [[32mCREATE TABLE (174.1k rows, 11.3 MiB processed)[0m in 5.99s]
[0m23:32:18.982211 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m23:32:18.984251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:18.984991 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m23:32:18.985629 [info ] [MainThread]: 
[0m23:32:18.986299 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m23:32:18.987345 [debug] [MainThread]: Command end result
[0m23:32:19.052613 [info ] [MainThread]: 
[0m23:32:19.053395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:19.053857 [info ] [MainThread]: 
[0m23:32:19.054358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:32:19.058315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.910278, "process_user_time": 2.685869, "process_kernel_time": 1.546485, "process_mem_max_rss": "207159296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:32:19.059306 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:19.059146 after 9.91 seconds
[0m23:32:19.059885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aae68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a537610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a537bb0>]}
[0m23:32:19.060471 [debug] [MainThread]: Flushing usage events
[0m23:55:34.687476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050abed0>]}


============================== 23:55:34.697926 | f42c0951-da91-4a1a-942d-0271182b5c61 ==============================
[0m23:55:34.697926 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:55:34.698999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_groups', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:55:36.675576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f42c0951-da91-4a1a-942d-0271182b5c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c288fc0>]}
[0m23:55:36.774454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f42c0951-da91-4a1a-942d-0271182b5c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b759590>]}
[0m23:55:36.775846 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:55:36.993446 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:55:37.229176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:55:37.230032 [debug] [MainThread]: Partial parsing: added file: keira_project://models/stg_groups.sql
[0m23:55:37.230915 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/sources.yml
[0m23:55:37.849995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f42c0951-da91-4a1a-942d-0271182b5c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c6c5a50>]}
[0m23:55:38.050718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f42c0951-da91-4a1a-942d-0271182b5c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c85b7a0>]}
[0m23:55:38.051809 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 484 macros
[0m23:55:38.052439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f42c0951-da91-4a1a-942d-0271182b5c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c881010>]}
[0m23:55:38.055278 [info ] [MainThread]: 
[0m23:55:38.056266 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:55:38.057691 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:55:38.058528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:38.456866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:55:38.457280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:38.699111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f42c0951-da91-4a1a-942d-0271182b5c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c87fba0>]}
[0m23:55:38.699746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:55:38.700446 [info ] [MainThread]: 
[0m23:55:38.705734 [debug] [Thread-1 (]: Began running node model.keira_project.stg_groups
[0m23:55:38.706502 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_groups .......................... [RUN]
[0m23:55:38.707109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_groups)
[0m23:55:38.707827 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_groups
[0m23:55:38.725363 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m23:55:38.726517 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_groups
[0m23:55:38.807728 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m23:55:38.809806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:38.812860 [debug] [Thread-1 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH groups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM created) AS group_created_year,
      EXTRACT(MONTH FROM created) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM groups
    );
  
[0m23:55:39.270349 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:1a081017-5c2f-4193-93e0-09c6491276c6&page=queryresults
[0m23:55:39.270880 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword GROUPS at [16:6]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword GROUPS at [16:6]')
[0m23:55:40.295201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:d116f404-ef1e-409f-b192-41cfb4e45330&page=queryresults
[0m23:55:40.295725 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:d116f404-ef1e-409f-b192-41cfb4e45330&page=queryresults
[0m23:55:40.305906 [debug] [Thread-1 (]: Database Error in model stg_groups (models/stg_groups.sql)
  Syntax error: Unexpected keyword GROUPS at [16:6]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m23:55:40.307116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42c0951-da91-4a1a-942d-0271182b5c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c9dad50>]}
[0m23:55:40.307639 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_groups ................. [[31mERROR[0m in 1.60s]
[0m23:55:40.308149 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_groups
[0m23:55:40.309627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:40.309857 [debug] [MainThread]: Connection 'model.keira_project.stg_groups' was properly closed.
[0m23:55:40.310063 [info ] [MainThread]: 
[0m23:55:40.310279 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m23:55:40.310736 [debug] [MainThread]: Command end result
[0m23:55:40.364217 [info ] [MainThread]: 
[0m23:55:40.365006 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:55:40.365425 [info ] [MainThread]: 
[0m23:55:40.366163 [error] [MainThread]:   Database Error in model stg_groups (models/stg_groups.sql)
  Syntax error: Unexpected keyword GROUPS at [16:6]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m23:55:40.366794 [info ] [MainThread]: 
[0m23:55:40.367275 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:55:40.370892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.795589, "process_user_time": 2.760565, "process_kernel_time": 1.604984, "process_mem_max_rss": "210223104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:55:40.372411 [debug] [MainThread]: Command `dbt run` failed at 23:55:40.372029 after 5.80 seconds
[0m23:55:40.373015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c9150d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024d7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c407cf0>]}
[0m23:55:40.373435 [debug] [MainThread]: Flushing usage events
[0m23:57:17.606620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102936660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049abed0>]}


============================== 23:57:17.614614 | b236430c-bf7c-4ed9-a529-d79bdc540490 ==============================
[0m23:57:17.614614 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:57:17.615992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_groups', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:57:19.509229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b236430c-bf7c-4ed9-a529-d79bdc540490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb88fc0>]}
[0m23:57:19.609313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b236430c-bf7c-4ed9-a529-d79bdc540490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b859590>]}
[0m23:57:19.610464 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:57:19.827923 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:57:20.072112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:57:20.073475 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_groups.sql
[0m23:57:20.546698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b236430c-bf7c-4ed9-a529-d79bdc540490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfc4b50>]}
[0m23:57:20.744765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b236430c-bf7c-4ed9-a529-d79bdc540490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa7890>]}
[0m23:57:20.745592 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 484 macros
[0m23:57:20.746293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b236430c-bf7c-4ed9-a529-d79bdc540490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c3d90>]}
[0m23:57:20.748822 [info ] [MainThread]: 
[0m23:57:20.749626 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:57:20.751216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:57:20.751998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:21.264444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:57:21.264809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:21.514845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b236430c-bf7c-4ed9-a529-d79bdc540490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c07e750>]}
[0m23:57:21.515373 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:21.515626 [info ] [MainThread]: 
[0m23:57:21.518316 [debug] [Thread-1 (]: Began running node model.keira_project.stg_groups
[0m23:57:21.518814 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_groups .......................... [RUN]
[0m23:57:21.519194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_groups)
[0m23:57:21.519454 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_groups
[0m23:57:21.536362 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m23:57:21.538077 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_groups
[0m23:57:21.616040 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m23:57:21.617512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:21.620302 [debug] [Thread-1 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM created) AS group_created_year,
      EXTRACT(MONTH FROM created) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m23:57:22.285301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:b04b33d1-c01f-41b7-bc92-c122e61c7a5a&page=queryresults
[0m23:57:22.390788 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM INT64\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type INT64 to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type INT64 to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type INT64 to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type INT64 to expected type INTERVAL at [20:7]; reason: invalidQuery, location: query, message: No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM INT64\n  Signature: EXTRACT(DATE_TIME_PART FROM DATE)\n    Argument 1: Unable to coerce type INT64 to expected type DATE\n  Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])\n    Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP\n  Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)\n    Argument 1: Unable to coerce type INT64 to expected type DATETIME\n  Signature: EXTRACT(DATE_TIME_PART FROM TIME)\n    Argument 1: Unable to coerce type INT64 to expected type TIME\n  Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)\n    Argument 1: Unable to coerce type INT64 to expected type INTERVAL at [20:7]')
[0m23:57:23.310616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:800396da-066c-47b5-966e-16e154f46928&page=queryresults
[0m23:57:23.385993 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:800396da-066c-47b5-966e-16e154f46928&page=queryresults
[0m23:57:23.396251 [debug] [Thread-1 (]: Database Error in model stg_groups (models/stg_groups.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM INT64
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type INT64 to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type INT64 to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type INT64 to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type INT64 to expected type INTERVAL at [20:7]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m23:57:23.397625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b236430c-bf7c-4ed9-a529-d79bdc540490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0deb10>]}
[0m23:57:23.398161 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_groups ................. [[31mERROR[0m in 1.88s]
[0m23:57:23.398629 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_groups
[0m23:57:23.400178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:23.400423 [debug] [MainThread]: Connection 'model.keira_project.stg_groups' was properly closed.
[0m23:57:23.400641 [info ] [MainThread]: 
[0m23:57:23.400865 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m23:57:23.401693 [debug] [MainThread]: Command end result
[0m23:57:23.464286 [info ] [MainThread]: 
[0m23:57:23.464941 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:57:23.465473 [info ] [MainThread]: 
[0m23:57:23.466361 [error] [MainThread]:   Database Error in model stg_groups (models/stg_groups.sql)
  No matching signature for function EXTRACT for argument types: DATE_TIME_PART FROM INT64
    Signature: EXTRACT(DATE_TIME_PART FROM DATE)
      Argument 1: Unable to coerce type INT64 to expected type DATE
    Signature: EXTRACT(DATE_TIME_PART FROM TIMESTAMP [AT TIME ZONE STRING])
      Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP
    Signature: EXTRACT(DATE_TIME_PART FROM DATETIME)
      Argument 1: Unable to coerce type INT64 to expected type DATETIME
    Signature: EXTRACT(DATE_TIME_PART FROM TIME)
      Argument 1: Unable to coerce type INT64 to expected type TIME
    Signature: EXTRACT(DATE_TIME_PART FROM INTERVAL)
      Argument 1: Unable to coerce type INT64 to expected type INTERVAL at [20:7]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m23:57:23.467224 [info ] [MainThread]: 
[0m23:57:23.467527 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:57:23.471498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9677787, "process_user_time": 2.677788, "process_kernel_time": 1.557088, "process_mem_max_rss": "208617472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:57:23.472280 [debug] [MainThread]: Command `dbt run` failed at 23:57:23.472199 after 5.97 seconds
[0m23:57:23.472834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb539d0>]}
[0m23:57:23.473564 [debug] [MainThread]: Flushing usage events
[0m00:01:13.381666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e7ed0>]}


============================== 00:01:13.390001 | 4a73cfb7-d014-4b54-875d-acdb63db2750 ==============================
[0m00:01:13.390001 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:01:13.391155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_groups', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:15.325625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a73cfb7-d014-4b54-875d-acdb63db2750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128088fc0>]}
[0m00:01:15.440739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a73cfb7-d014-4b54-875d-acdb63db2750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f659590>]}
[0m00:01:15.442038 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:01:15.644057 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:01:15.885647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:01:15.886747 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_groups.sql
[0m00:01:16.350937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a73cfb7-d014-4b54-875d-acdb63db2750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284c4d50>]}
[0m00:01:16.545847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a73cfb7-d014-4b54-875d-acdb63db2750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a7890>]}
[0m00:01:16.546744 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 484 macros
[0m00:01:16.547209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a73cfb7-d014-4b54-875d-acdb63db2750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285bfd90>]}
[0m00:01:16.550321 [info ] [MainThread]: 
[0m00:01:16.551118 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:01:16.552695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:01:16.553205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:16.921806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:01:16.922170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:17.173758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a73cfb7-d014-4b54-875d-acdb63db2750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12857e750>]}
[0m00:01:17.174266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:17.174498 [info ] [MainThread]: 
[0m00:01:17.176962 [debug] [Thread-1 (]: Began running node model.keira_project.stg_groups
[0m00:01:17.177429 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_groups .......................... [RUN]
[0m00:01:17.177791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_groups)
[0m00:01:17.178056 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_groups
[0m00:01:17.193346 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m00:01:17.194761 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_groups
[0m00:01:17.272044 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m00:01:17.273389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:17.276038 [debug] [Thread-1 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP(created)) AS group_created_year,
      EXTRACT(MONTH FROM TIMESTAMP(created)) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m00:01:17.940097 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7b4f501e-7f76-4fa7-8ff7-1222795dfae3&page=queryresults
[0m00:01:18.035385 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function TIMESTAMP\n  Argument types: INT64\n  Signature: TIMESTAMP(STRING, [STRING])\n    Argument 1: Unable to coerce type INT64 to expected type STRING\n  Signature: TIMESTAMP(DATE, [STRING])\n    Argument 1: Unable to coerce type INT64 to expected type DATE\n  Signature: TIMESTAMP(DATETIME, [STRING])\n    Argument 1: Unable to coerce type INT64 to expected type DATETIME\n  Signature: TIMESTAMP(TIMESTAMP)\n    Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP at [20:25]; reason: invalidQuery, location: query, message: No matching signature for function TIMESTAMP\n  Argument types: INT64\n  Signature: TIMESTAMP(STRING, [STRING])\n    Argument 1: Unable to coerce type INT64 to expected type STRING\n  Signature: TIMESTAMP(DATE, [STRING])\n    Argument 1: Unable to coerce type INT64 to expected type DATE\n  Signature: TIMESTAMP(DATETIME, [STRING])\n    Argument 1: Unable to coerce type INT64 to expected type DATETIME\n  Signature: TIMESTAMP(TIMESTAMP)\n    Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP at [20:25]')
[0m00:01:18.753356 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f1e37385-f6c2-440b-ac7c-80fe343affb6&page=queryresults
[0m00:01:18.932303 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f1e37385-f6c2-440b-ac7c-80fe343affb6&page=queryresults
[0m00:01:18.946757 [debug] [Thread-1 (]: Database Error in model stg_groups (models/stg_groups.sql)
  No matching signature for function TIMESTAMP
    Argument types: INT64
    Signature: TIMESTAMP(STRING, [STRING])
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: TIMESTAMP(DATE, [STRING])
      Argument 1: Unable to coerce type INT64 to expected type DATE
    Signature: TIMESTAMP(DATETIME, [STRING])
      Argument 1: Unable to coerce type INT64 to expected type DATETIME
    Signature: TIMESTAMP(TIMESTAMP)
      Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP at [20:25]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m00:01:18.949705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a73cfb7-d014-4b54-875d-acdb63db2750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283d7110>]}
[0m00:01:18.951038 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_groups ................. [[31mERROR[0m in 1.77s]
[0m00:01:18.952046 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_groups
[0m00:01:18.956784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:18.957491 [debug] [MainThread]: Connection 'model.keira_project.stg_groups' was properly closed.
[0m00:01:18.957952 [info ] [MainThread]: 
[0m00:01:18.958412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m00:01:18.959316 [debug] [MainThread]: Command end result
[0m00:01:19.027312 [info ] [MainThread]: 
[0m00:01:19.028029 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:01:19.028500 [info ] [MainThread]: 
[0m00:01:19.029336 [error] [MainThread]:   Database Error in model stg_groups (models/stg_groups.sql)
  No matching signature for function TIMESTAMP
    Argument types: INT64
    Signature: TIMESTAMP(STRING, [STRING])
      Argument 1: Unable to coerce type INT64 to expected type STRING
    Signature: TIMESTAMP(DATE, [STRING])
      Argument 1: Unable to coerce type INT64 to expected type DATE
    Signature: TIMESTAMP(DATETIME, [STRING])
      Argument 1: Unable to coerce type INT64 to expected type DATETIME
    Signature: TIMESTAMP(TIMESTAMP)
      Argument 1: Unable to coerce type INT64 to expected type TIMESTAMP at [20:25]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m00:01:19.029806 [info ] [MainThread]: 
[0m00:01:19.030424 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:01:19.034429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7718825, "process_user_time": 2.697398, "process_kernel_time": 1.564846, "process_mem_max_rss": "209698816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:01:19.035362 [debug] [MainThread]: Command `dbt run` failed at 00:01:19.035277 after 5.77 seconds
[0m00:01:19.035961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285faa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280539d0>]}
[0m00:01:19.036534 [debug] [MainThread]: Flushing usage events
[0m00:03:00.057734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ea660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4bed0>]}


============================== 00:03:00.066803 | e5ffff1b-dc41-493e-bc29-dca10b5dc1ae ==============================
[0m00:03:00.066803 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:03:00.067753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_groups', 'send_anonymous_usage_stats': 'True'}
[0m00:03:02.030983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5ffff1b-dc41-493e-bc29-dca10b5dc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa88fc0>]}
[0m00:03:02.143230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5ffff1b-dc41-493e-bc29-dca10b5dc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f859590>]}
[0m00:03:02.144868 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:03:02.364143 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:03:02.604510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:02.606075 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_groups.sql
[0m00:03:03.074221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5ffff1b-dc41-493e-bc29-dca10b5dc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fec4d50>]}
[0m00:03:03.272302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5ffff1b-dc41-493e-bc29-dca10b5dc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9a7890>]}
[0m00:03:03.273055 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 484 macros
[0m00:03:03.273835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ffff1b-dc41-493e-bc29-dca10b5dc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3cfd90>]}
[0m00:03:03.276561 [info ] [MainThread]: 
[0m00:03:03.277665 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:03:03.279122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:03:03.279694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:03.652681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:03:03.653047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:03.908117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ffff1b-dc41-493e-bc29-dca10b5dc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b38a750>]}
[0m00:03:03.908600 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:03:03.908827 [info ] [MainThread]: 
[0m00:03:03.911379 [debug] [Thread-1 (]: Began running node model.keira_project.stg_groups
[0m00:03:03.911818 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_groups .......................... [RUN]
[0m00:03:03.912146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_groups)
[0m00:03:03.912387 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_groups
[0m00:03:03.924990 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m00:03:03.926315 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_groups
[0m00:03:04.003781 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m00:03:04.005350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:04.008404 [debug] [Thread-1 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(created / 1000)) AS group_created_year,
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(created / 1000)) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m00:03:04.739656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2eb7f688-a94c-4aee-8e56-11116b555a36&page=queryresults
[0m00:03:04.827190 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function TIMESTAMP_SECONDS\n  Argument types: FLOAT64\n  Signature: TIMESTAMP_SECONDS(INT64)\n    Argument 1: Unable to coerce type FLOAT64 to expected type INT64 at [20:25]; reason: invalidQuery, location: query, message: No matching signature for function TIMESTAMP_SECONDS\n  Argument types: FLOAT64\n  Signature: TIMESTAMP_SECONDS(INT64)\n    Argument 1: Unable to coerce type FLOAT64 to expected type INT64 at [20:25]')
[0m00:03:05.928416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9d13c2f6-f9ed-4662-93da-cdbcc98d3634&page=queryresults
[0m00:03:06.029369 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9d13c2f6-f9ed-4662-93da-cdbcc98d3634&page=queryresults
[0m00:03:06.039738 [debug] [Thread-1 (]: Database Error in model stg_groups (models/stg_groups.sql)
  No matching signature for function TIMESTAMP_SECONDS
    Argument types: FLOAT64
    Signature: TIMESTAMP_SECONDS(INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64 at [20:25]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m00:03:06.041036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ffff1b-dc41-493e-bc29-dca10b5dc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b452b10>]}
[0m00:03:06.041537 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_groups ................. [[31mERROR[0m in 2.13s]
[0m00:03:06.041979 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_groups
[0m00:03:06.043511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:06.043759 [debug] [MainThread]: Connection 'model.keira_project.stg_groups' was properly closed.
[0m00:03:06.043983 [info ] [MainThread]: 
[0m00:03:06.044207 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m00:03:06.044679 [debug] [MainThread]: Command end result
[0m00:03:06.103632 [info ] [MainThread]: 
[0m00:03:06.104656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:03:06.105163 [info ] [MainThread]: 
[0m00:03:06.105874 [error] [MainThread]:   Database Error in model stg_groups (models/stg_groups.sql)
  No matching signature for function TIMESTAMP_SECONDS
    Argument types: FLOAT64
    Signature: TIMESTAMP_SECONDS(INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64 at [20:25]
  compiled code at target/run/keira_project/models/stg_groups.sql
[0m00:03:06.106338 [info ] [MainThread]: 
[0m00:03:06.106809 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:03:06.110516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.165169, "process_user_time": 2.696732, "process_kernel_time": 1.580093, "process_mem_max_rss": "206618624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:03:06.111543 [debug] [MainThread]: Command `dbt run` failed at 00:03:06.111436 after 6.17 seconds
[0m00:03:06.112268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fde2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa539d0>]}
[0m00:03:06.112637 [debug] [MainThread]: Flushing usage events
[0m00:04:49.112934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7ed0>]}


============================== 00:04:49.121551 | 2f3924b7-3052-4e88-9a34-ebd873ed233e ==============================
[0m00:04:49.121551 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:49.122503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_groups', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:04:51.096072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f3924b7-3052-4e88-9a34-ebd873ed233e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb88fc0>]}
[0m00:04:51.200578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f3924b7-3052-4e88-9a34-ebd873ed233e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b959590>]}
[0m00:04:51.202129 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:04:51.411723 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:51.659235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:04:51.660764 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_groups.sql
[0m00:04:52.128747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f3924b7-3052-4e88-9a34-ebd873ed233e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f288d50>]}
[0m00:04:52.326167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f3924b7-3052-4e88-9a34-ebd873ed233e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa7890>]}
[0m00:04:52.327195 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 484 macros
[0m00:04:52.327858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3924b7-3052-4e88-9a34-ebd873ed233e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f387d90>]}
[0m00:04:52.330788 [info ] [MainThread]: 
[0m00:04:52.331931 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:04:52.333359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:04:52.334089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:52.719511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:04:52.719910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:52.966484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3924b7-3052-4e88-9a34-ebd873ed233e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f346750>]}
[0m00:04:52.967011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:04:52.967248 [info ] [MainThread]: 
[0m00:04:52.969420 [debug] [Thread-1 (]: Began running node model.keira_project.stg_groups
[0m00:04:52.970180 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_groups .......................... [RUN]
[0m00:04:52.970836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_groups)
[0m00:04:52.971372 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_groups
[0m00:04:52.987849 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m00:04:52.989259 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_groups
[0m00:04:53.065522 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m00:04:53.066970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:53.069698 [debug] [Thread-1 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_year, 
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m00:04:53.694711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e0f13a0f-64c4-4ad1-b14f-d6ae931c5ecb&page=queryresults
[0m00:04:56.345529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3924b7-3052-4e88-9a34-ebd873ed233e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3c1c10>]}
[0m00:04:56.347133 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_groups ..................... [[32mCREATE TABLE (711.0 rows, 442.7 KiB processed)[0m in 3.37s]
[0m00:04:56.348547 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_groups
[0m00:04:56.350667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:56.351163 [debug] [MainThread]: Connection 'model.keira_project.stg_groups' was properly closed.
[0m00:04:56.351679 [info ] [MainThread]: 
[0m00:04:56.352189 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m00:04:56.353426 [debug] [MainThread]: Command end result
[0m00:04:56.418391 [info ] [MainThread]: 
[0m00:04:56.419199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:04:56.419572 [info ] [MainThread]: 
[0m00:04:56.420187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:04:56.424270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.418927, "process_user_time": 2.705982, "process_kernel_time": 1.593793, "process_mem_max_rss": "208666624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:04:56.424920 [debug] [MainThread]: Command `dbt run` succeeded at 00:04:56.424819 after 7.42 seconds
[0m00:04:56.425340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdfe8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb539d0>]}
[0m00:04:56.426155 [debug] [MainThread]: Flushing usage events
[0m00:24:08.673652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de7ed0>]}


============================== 00:24:08.682045 | 9f2b817f-48b3-48c0-af78-2825919447e1 ==============================
[0m00:24:08.682045 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:24:08.683044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_users', 'send_anonymous_usage_stats': 'True'}
[0m00:24:10.667642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f2b817f-48b3-48c0-af78-2825919447e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120288fc0>]}
[0m00:24:10.767200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f2b817f-48b3-48c0-af78-2825919447e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120059590>]}
[0m00:24:10.768369 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:24:10.966568 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:24:11.218262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:24:11.219293 [debug] [MainThread]: Partial parsing: added file: keira_project://models/stg_users.sql
[0m00:24:11.220288 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/sources.yml
[0m00:24:11.861601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f2b817f-48b3-48c0-af78-2825919447e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207c1b50>]}
[0m00:24:12.065028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f2b817f-48b3-48c0-af78-2825919447e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12085e7b0>]}
[0m00:24:12.066359 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 484 macros
[0m00:24:12.066812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f2b817f-48b3-48c0-af78-2825919447e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120882190>]}
[0m00:24:12.070544 [info ] [MainThread]: 
[0m00:24:12.071753 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:24:12.073434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:24:12.074177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:13.283445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:24:13.283921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:13.568247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f2b817f-48b3-48c0-af78-2825919447e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207efa00>]}
[0m00:24:13.568739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:24:13.568965 [info ] [MainThread]: 
[0m00:24:13.571507 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m00:24:13.571949 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users ........................... [RUN]
[0m00:24:13.572307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users)
[0m00:24:13.572575 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m00:24:13.580262 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m00:24:13.581005 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m00:24:13.662588 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m00:24:13.664196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:13.667226 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown,
        UNNEST(memberships.group_id) AS join_group_id,
        UNNEST(memberships.joined) AS join_group_time
    FROM `keira-xebia`.`meetupservice`.`source_users`
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown,
    join_group_id,
    join_group_time
FROM users
    );
  
[0m00:24:14.100859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:93368e79-8bd2-4912-9c95-de2790da7f4c&page=queryresults
[0m00:24:14.101401 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword UNNEST at [21:9]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword UNNEST at [21:9]')
[0m00:24:15.022198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:c54302ff-c6f5-4653-9b47-f8616d77d614&page=queryresults
[0m00:24:15.022865 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:c54302ff-c6f5-4653-9b47-f8616d77d614&page=queryresults
[0m00:24:15.032504 [debug] [Thread-1 (]: Database Error in model stg_users (models/stg_users.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [21:9]
  compiled code at target/run/keira_project/models/stg_users.sql
[0m00:24:15.033902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f2b817f-48b3-48c0-af78-2825919447e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209a6510>]}
[0m00:24:15.034476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_users .................. [[31mERROR[0m in 1.46s]
[0m00:24:15.034979 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m00:24:15.036518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:15.036785 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m00:24:15.037011 [info ] [MainThread]: 
[0m00:24:15.037286 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m00:24:15.037782 [debug] [MainThread]: Command end result
[0m00:24:15.091383 [info ] [MainThread]: 
[0m00:24:15.092186 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:24:15.092554 [info ] [MainThread]: 
[0m00:24:15.093052 [error] [MainThread]:   Database Error in model stg_users (models/stg_users.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [21:9]
  compiled code at target/run/keira_project/models/stg_users.sql
[0m00:24:15.093414 [info ] [MainThread]: 
[0m00:24:15.093944 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:24:15.097634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5317173, "process_user_time": 2.792249, "process_kernel_time": 1.616054, "process_mem_max_rss": "208404480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:24:15.098828 [debug] [MainThread]: Command `dbt run` failed at 00:24:15.098683 after 6.53 seconds
[0m00:24:15.099549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120919180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12088c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12088c550>]}
[0m00:24:15.099948 [debug] [MainThread]: Flushing usage events
[0m00:28:35.798648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103336660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7ed0>]}


============================== 00:28:35.806843 | 6cecc6d8-6215-4749-9496-e61c56ee49eb ==============================
[0m00:28:35.806843 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:28:35.807682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_users', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:37.797113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cecc6d8-6215-4749-9496-e61c56ee49eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114588fc0>]}
[0m00:28:37.897786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cecc6d8-6215-4749-9496-e61c56ee49eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114359590>]}
[0m00:28:37.899260 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:28:38.098766 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:28:38.343158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:38.344406 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_users.sql
[0m00:28:38.804786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cecc6d8-6215-4749-9496-e61c56ee49eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cc8650>]}
[0m00:28:39.003880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cecc6d8-6215-4749-9496-e61c56ee49eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144a77a0>]}
[0m00:28:39.004896 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 484 macros
[0m00:28:39.005622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cecc6d8-6215-4749-9496-e61c56ee49eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115dc7d90>]}
[0m00:28:39.008253 [info ] [MainThread]: 
[0m00:28:39.009107 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:28:39.010547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:28:39.011011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:39.423442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:28:39.423865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:39.675479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cecc6d8-6215-4749-9496-e61c56ee49eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e53930>]}
[0m00:28:39.676011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:39.676251 [info ] [MainThread]: 
[0m00:28:39.678860 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m00:28:39.679315 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users ........................... [RUN]
[0m00:28:39.680046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users)
[0m00:28:39.680651 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m00:28:39.696550 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m00:28:39.698412 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m00:28:39.776728 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m00:28:39.778637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:39.781628 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown,
        group_id.group_id AS join_group_id,
        joined.joined AS join_group_time
    FROM `keira-xebia`.`meetupservice`.`source_users`
    UNNEST(memberships.group_id) AS group_id
    UNNEST(memberships.joined) AS joined

)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown,
    join_group_id,
    join_group_time
FROM users
    );
  
[0m00:28:40.239807 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:c3a26fa9-ae65-48cb-82c3-e770a22193d0&page=queryresults
[0m00:28:40.240366 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword UNNEST at [24:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword UNNEST at [24:5]')
[0m00:28:41.265620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:09d1d611-8f10-4539-8f82-55e21cfbaa71&page=queryresults
[0m00:28:41.266151 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:09d1d611-8f10-4539-8f82-55e21cfbaa71&page=queryresults
[0m00:28:41.276341 [debug] [Thread-1 (]: Database Error in model stg_users (models/stg_users.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [24:5]
  compiled code at target/run/keira_project/models/stg_users.sql
[0m00:28:41.277667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cecc6d8-6215-4749-9496-e61c56ee49eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e6a990>]}
[0m00:28:41.278200 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_users .................. [[31mERROR[0m in 1.60s]
[0m00:28:41.278640 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m00:28:41.280126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:41.280353 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m00:28:41.280556 [info ] [MainThread]: 
[0m00:28:41.280769 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m00:28:41.281224 [debug] [MainThread]: Command end result
[0m00:28:41.347211 [info ] [MainThread]: 
[0m00:28:41.348121 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:28:41.348689 [info ] [MainThread]: 
[0m00:28:41.349407 [error] [MainThread]:   Database Error in model stg_users (models/stg_users.sql)
  Syntax error: Expected ")" but got keyword UNNEST at [24:5]
  compiled code at target/run/keira_project/models/stg_users.sql
[0m00:28:41.349722 [info ] [MainThread]: 
[0m00:28:41.350275 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:28:41.354049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.6642857, "process_user_time": 2.705805, "process_kernel_time": 1.592586, "process_mem_max_rss": "208551936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:28:41.354826 [debug] [MainThread]: Command `dbt run` failed at 00:28:41.354708 after 5.67 seconds
[0m00:28:41.355470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e12a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145531b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145536b0>]}
[0m00:28:41.356038 [debug] [MainThread]: Flushing usage events
[0m00:29:10.637567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fabed0>]}


============================== 00:29:10.645459 | d9faafdd-bdc1-4dd8-8a40-bcfb34951b21 ==============================
[0m00:29:10.645459 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:29:10.646531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_users', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:29:12.628740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9faafdd-bdc1-4dd8-8a40-bcfb34951b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127888fc0>]}
[0m00:29:12.730787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9faafdd-bdc1-4dd8-8a40-bcfb34951b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127659590>]}
[0m00:29:12.732116 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:29:12.946070 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:29:13.195712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:13.196964 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_users.sql
[0m00:29:13.669300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9faafdd-bdc1-4dd8-8a40-bcfb34951b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127cc0650>]}
[0m00:29:13.867265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9faafdd-bdc1-4dd8-8a40-bcfb34951b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1277a77a0>]}
[0m00:29:13.868117 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 484 macros
[0m00:29:13.868696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9faafdd-bdc1-4dd8-8a40-bcfb34951b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fcbbd0>]}
[0m00:29:13.872242 [info ] [MainThread]: 
[0m00:29:13.873588 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:29:13.875268 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:29:13.875925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:14.251381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:29:14.251795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:14.509777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9faafdd-bdc1-4dd8-8a40-bcfb34951b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13535f930>]}
[0m00:29:14.510281 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:14.510553 [info ] [MainThread]: 
[0m00:29:14.513018 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m00:29:14.513503 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users ........................... [RUN]
[0m00:29:14.513864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users)
[0m00:29:14.514135 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m00:29:14.523674 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m00:29:14.525044 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m00:29:14.604045 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m00:29:14.605465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:14.608040 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown,
        group_id.group_id AS join_group_id,
        joined.joined AS join_group_time
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships.group_id) AS group_id,
    UNNEST(memberships.joined) AS joined

)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown,
    join_group_id,
    join_group_time
FROM users
    );
  
[0m00:29:15.227972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:672736a0-1973-4cee-9be6-cbf8b7fa4b1a&page=queryresults
[0m00:29:15.316037 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Cannot access field group_id on a value with type ARRAY<STRUCT<group_id STRING, joined INT64>> at [24:24]; reason: invalidQuery, location: query, message: Cannot access field group_id on a value with type ARRAY<STRUCT<group_id STRING, joined INT64>> at [24:24]')
[0m00:29:16.750617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:b4c95761-0753-4f6d-9f8a-958e1bcea377&page=queryresults
[0m00:29:16.899834 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:b4c95761-0753-4f6d-9f8a-958e1bcea377&page=queryresults
[0m00:29:16.913106 [debug] [Thread-1 (]: Database Error in model stg_users (models/stg_users.sql)
  Cannot access field group_id on a value with type ARRAY<STRUCT<group_id STRING, joined INT64>> at [24:24]
  compiled code at target/run/keira_project/models/stg_users.sql
[0m00:29:16.914425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9faafdd-bdc1-4dd8-8a40-bcfb34951b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13537af90>]}
[0m00:29:16.914949 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_users .................. [[31mERROR[0m in 2.40s]
[0m00:29:16.915393 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m00:29:16.917970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:16.918582 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m00:29:16.918963 [info ] [MainThread]: 
[0m00:29:16.919466 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m00:29:16.920692 [debug] [MainThread]: Command end result
[0m00:29:16.986208 [info ] [MainThread]: 
[0m00:29:16.987359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:29:16.987807 [info ] [MainThread]: 
[0m00:29:16.988304 [error] [MainThread]:   Database Error in model stg_users (models/stg_users.sql)
  Cannot access field group_id on a value with type ARRAY<STRUCT<group_id STRING, joined INT64>> at [24:24]
  compiled code at target/run/keira_project/models/stg_users.sql
[0m00:29:16.988792 [info ] [MainThread]: 
[0m00:29:16.989354 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:29:16.993209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.467619, "process_user_time": 2.735988, "process_kernel_time": 1.604685, "process_mem_max_rss": "208945152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:29:16.994045 [debug] [MainThread]: Command `dbt run` failed at 00:29:16.993900 after 6.47 seconds
[0m00:29:16.994966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127be2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278531b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278536b0>]}
[0m00:29:16.995437 [debug] [MainThread]: Flushing usage events
[0m00:31:34.985882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de7ed0>]}


============================== 00:31:34.994207 | 848e5e8d-e2b5-482a-b2a2-865375a001d6 ==============================
[0m00:31:34.994207 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:31:34.995132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_users', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:31:37.033240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '848e5e8d-e2b5-482a-b2a2-865375a001d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a88fc0>]}
[0m00:31:37.137989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '848e5e8d-e2b5-482a-b2a2-865375a001d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145759590>]}
[0m00:31:37.139329 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:31:37.356326 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:31:37.587654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:31:37.589221 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_users.sql
[0m00:31:38.062511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '848e5e8d-e2b5-482a-b2a2-865375a001d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1476bc650>]}
[0m00:31:38.266799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '848e5e8d-e2b5-482a-b2a2-865375a001d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459a77a0>]}
[0m00:31:38.268185 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 484 macros
[0m00:31:38.268704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848e5e8d-e2b5-482a-b2a2-865375a001d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530cbbd0>]}
[0m00:31:38.271859 [info ] [MainThread]: 
[0m00:31:38.273168 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:31:38.274286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:31:38.274864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:38.649495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:31:38.649882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:38.891534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848e5e8d-e2b5-482a-b2a2-865375a001d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153153930>]}
[0m00:31:38.892509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:38.892943 [info ] [MainThread]: 
[0m00:31:38.897444 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m00:31:38.898052 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users ........................... [RUN]
[0m00:31:38.898530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users)
[0m00:31:38.899170 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m00:31:38.914776 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m00:31:38.916470 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m00:31:38.991059 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m00:31:38.992681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:38.995231 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown,
        membership.group_id AS join_group_id,
        membership.joined AS join_group_time
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown,
    join_group_id,
    join_group_time
FROM users
    );
  
[0m00:31:39.646739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:bc84ca3c-b5bf-44e4-bdf5-ea5e9fcb9066&page=queryresults
[0m00:31:42.618460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '848e5e8d-e2b5-482a-b2a2-865375a001d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15316e390>]}
[0m00:31:42.619747 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_users ...................... [[32mCREATE TABLE (145.5k rows, 5.4 MiB processed)[0m in 3.72s]
[0m00:31:42.620641 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m00:31:42.623066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:42.623641 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m00:31:42.624189 [info ] [MainThread]: 
[0m00:31:42.624667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m00:31:42.626192 [debug] [MainThread]: Command end result
[0m00:31:42.691690 [info ] [MainThread]: 
[0m00:31:42.692603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:42.693221 [info ] [MainThread]: 
[0m00:31:42.693693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:31:42.697264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8179016, "process_user_time": 2.721518, "process_kernel_time": 1.61881, "process_mem_max_rss": "207650816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:31:42.698061 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:42.697956 after 7.82 seconds
[0m00:31:42.698611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145cd2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a534d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145a539d0>]}
[0m00:31:42.699106 [debug] [MainThread]: Flushing usage events
[0m00:37:25.418063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7ed0>]}


============================== 00:37:25.425880 | 09549441-bce1-4e48-a020-0e7b36eb22e5 ==============================
[0m00:37:25.425880 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:37:25.427132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_users', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:37:27.425167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09549441-bce1-4e48-a020-0e7b36eb22e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a88fc0>]}
[0m00:37:27.526219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09549441-bce1-4e48-a020-0e7b36eb22e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133e59590>]}
[0m00:37:27.527532 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m00:37:27.741261 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:37:27.986629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:37:27.987687 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_users.sql
[0m00:37:28.453831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09549441-bce1-4e48-a020-0e7b36eb22e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134db8650>]}
[0m00:37:28.654641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09549441-bce1-4e48-a020-0e7b36eb22e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348a77a0>]}
[0m00:37:28.655697 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 484 macros
[0m00:37:28.656285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09549441-bce1-4e48-a020-0e7b36eb22e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ecfbd0>]}
[0m00:37:28.659419 [info ] [MainThread]: 
[0m00:37:28.660243 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:37:28.661443 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m00:37:28.662159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:29.042659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m00:37:29.043079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:29.291499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09549441-bce1-4e48-a020-0e7b36eb22e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f57930>]}
[0m00:37:29.292027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:37:29.292266 [info ] [MainThread]: 
[0m00:37:29.297231 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m00:37:29.298264 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users ........................... [RUN]
[0m00:37:29.299127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users)
[0m00:37:29.299741 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m00:37:29.316015 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m00:37:29.317665 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m00:37:29.348211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:37:29.663936 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m00:37:29.665580 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown,
        membership.group_id AS join_group_id,
        EXTRACT(YEAR FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_year, 
        EXTRACT(MONTH FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_month,
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown,
    join_group_id,
    join_group_year,
    join_group_month
FROM users
    );
  
[0m00:37:30.001983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0bc0cd08-4b13-4196-9bf4-49e950141110&page=queryresults
[0m00:37:32.719946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09549441-bce1-4e48-a020-0e7b36eb22e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f6a150>]}
[0m00:37:32.721711 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_users ...................... [[32mCREATE TABLE (145.5k rows, 5.4 MiB processed)[0m in 3.42s]
[0m00:37:32.722992 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m00:37:32.725460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:32.725861 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m00:37:32.727036 [info ] [MainThread]: 
[0m00:37:32.728316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m00:37:32.729807 [debug] [MainThread]: Command end result
[0m00:37:32.802653 [info ] [MainThread]: 
[0m00:37:32.803945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:37:32.804317 [info ] [MainThread]: 
[0m00:37:32.804899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:37:32.809239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4983125, "process_user_time": 2.720756, "process_kernel_time": 1.602383, "process_mem_max_rss": "208191488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:37:32.810521 [debug] [MainThread]: Command `dbt run` succeeded at 00:37:32.810184 after 7.50 seconds
[0m00:37:32.811257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134efaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a377f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a371b0>]}
[0m00:37:32.811896 [debug] [MainThread]: Flushing usage events
[0m01:12:44.222350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050abed0>]}


============================== 01:12:44.230224 | 6a284b11-412e-4c87-a71b-833c426a36d1 ==============================
[0m01:12:44.230224 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:12:44.231222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_events_rsvp', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:12:46.228037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a284b11-412e-4c87-a71b-833c426a36d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125488fc0>]}
[0m01:12:46.323275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a284b11-412e-4c87-a71b-833c426a36d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125059590>]}
[0m01:12:46.324809 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m01:12:46.533912 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:12:46.781720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m01:12:46.782691 [debug] [MainThread]: Partial parsing: added file: keira_project://models/stg_events_rsvp.sql
[0m01:12:46.783844 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/sources.yml
[0m01:12:46.784390 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events.sql
[0m01:12:47.423652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a284b11-412e-4c87-a71b-833c426a36d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257bda50>]}
[0m01:12:47.633271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a284b11-412e-4c87-a71b-833c426a36d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125863a70>]}
[0m01:12:47.634456 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 484 macros
[0m01:12:47.635244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a284b11-412e-4c87-a71b-833c426a36d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125875b70>]}
[0m01:12:47.637985 [info ] [MainThread]: 
[0m01:12:47.638822 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:12:47.640325 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m01:12:47.640853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:48.035387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m01:12:48.035778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:48.279745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a284b11-412e-4c87-a71b-833c426a36d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a3f860>]}
[0m01:12:48.280659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:12:48.281079 [info ] [MainThread]: 
[0m01:12:48.286636 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m01:12:48.287576 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m01:12:48.288376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_rsvp)
[0m01:12:48.288878 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m01:12:48.305521 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m01:12:48.307170 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m01:12:48.384264 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m01:12:48.385747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:48.388549 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        rsvp.when AS rsvp_response_time,
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT 
    event_name,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM rsvp
    );
  
[0m01:12:48.939890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:51312780-8460-4aa5-8522-eabc226b17be&page=queryresults
[0m01:12:51.602463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a284b11-412e-4c87-a71b-833c426a36d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259eab10>]}
[0m01:12:51.603099 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events_rsvp ................ [[32mCREATE TABLE (174.1k rows, 5.1 MiB processed)[0m in 3.31s]
[0m01:12:51.604278 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m01:12:51.606573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:51.607041 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m01:12:51.607496 [info ] [MainThread]: 
[0m01:12:51.608070 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m01:12:51.609329 [debug] [MainThread]: Command end result
[0m01:12:51.664289 [info ] [MainThread]: 
[0m01:12:51.665057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:12:51.665645 [info ] [MainThread]: 
[0m01:12:51.666326 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:12:51.670156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.556312, "process_user_time": 2.81821, "process_kernel_time": 1.64827, "process_mem_max_rss": "208420864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:12:51.671313 [debug] [MainThread]: Command `dbt run` succeeded at 01:12:51.671043 after 7.56 seconds
[0m01:12:51.671700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125914e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125893ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125890c30>]}
[0m01:12:51.672133 [debug] [MainThread]: Flushing usage events
[0m01:13:05.605359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289abed0>]}


============================== 01:13:05.612213 | 546931c8-a8e7-4f87-9992-873724f00db6 ==============================
[0m01:13:05.612213 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:13:05.613408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_events', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:13:07.367535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '546931c8-a8e7-4f87-9992-873724f00db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c88fc0>]}
[0m01:13:07.471914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '546931c8-a8e7-4f87-9992-873724f00db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138859590>]}
[0m01:13:07.473088 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m01:13:07.680441 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:13:07.916691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:13:07.917339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:13:08.005565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '546931c8-a8e7-4f87-9992-873724f00db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138a71850>]}
[0m01:13:08.219939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '546931c8-a8e7-4f87-9992-873724f00db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138aa77a0>]}
[0m01:13:08.221001 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 484 macros
[0m01:13:08.221689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '546931c8-a8e7-4f87-9992-873724f00db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c01470>]}
[0m01:13:08.224961 [info ] [MainThread]: 
[0m01:13:08.225999 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:13:08.227541 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m01:13:08.228244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:08.588011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m01:13:08.588413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:08.835760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '546931c8-a8e7-4f87-9992-873724f00db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8f7860>]}
[0m01:13:08.836296 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:13:08.836550 [info ] [MainThread]: 
[0m01:13:08.841028 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m01:13:08.841925 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m01:13:08.842854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m01:13:08.843442 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m01:13:08.864927 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m01:13:08.866788 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m01:13:08.898579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:09.204456 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m01:13:09.206409 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT 
        venue_id,
        time AS event_start_time,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        FORMAT_TIMESTAMP('%Y-%m', TIMESTAMP_SECONDS
        (CAST(created / 1000 AS INT64))) AS event_create_time,
        group_id,
        name AS event_name,
        description AS event_description,
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        rsvp.when AS rsvp_response_time,
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS (
    SELECT 
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.event_description,
        e.rsvp_total_limit,
        e.rsvp_user_id
        e.rsvp_response,
        e.rsvp_response_time,
        e.rsvp_guests
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    event_description,
    rsvp_total_limit,
    rsvp_user_id
    rsvp_response,
    rsvp_response_time,
    rsvp_guests,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m01:13:09.522881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:a8063623-eed5-4da1-8298-d31b4d0a8c19&page=queryresults
[0m01:13:09.523558 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "." at [60:10]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "." at [60:10]')
[0m01:13:10.239504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:4501d9bc-1d7c-489a-8448-f5ac3ffd4417&page=queryresults
[0m01:13:10.240072 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:4501d9bc-1d7c-489a-8448-f5ac3ffd4417&page=queryresults
[0m01:13:10.251035 [debug] [Thread-1 (]: Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected ")" but got "." at [60:10]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m01:13:10.252618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '546931c8-a8e7-4f87-9992-873724f00db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c959cd0>]}
[0m01:13:10.253194 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events ................. [[31mERROR[0m in 1.41s]
[0m01:13:10.253645 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m01:13:10.255812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:10.256338 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m01:13:10.256959 [info ] [MainThread]: 
[0m01:13:10.257337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m01:13:10.258486 [debug] [MainThread]: Command end result
[0m01:13:10.315621 [info ] [MainThread]: 
[0m01:13:10.316492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:13:10.317064 [info ] [MainThread]: 
[0m01:13:10.317659 [error] [MainThread]:   Database Error in model stg_events (models/stg_events.sql)
  Syntax error: Expected ")" but got "." at [60:10]
  compiled code at target/run/keira_project/models/stg_events.sql
[0m01:13:10.318196 [info ] [MainThread]: 
[0m01:13:10.318719 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:13:10.323208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.8238263, "process_user_time": 2.5301, "process_kernel_time": 1.407892, "process_mem_max_rss": "205783040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:13:10.323995 [debug] [MainThread]: Command `dbt run` failed at 01:13:10.323801 after 4.82 seconds
[0m01:13:10.324575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c97bd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c98f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c98fcf0>]}
[0m01:13:10.325402 [debug] [MainThread]: Flushing usage events
[0m01:14:51.420001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee7ed0>]}


============================== 01:14:51.428310 | 86f54be9-3f92-4866-9919-68c11e4087cf ==============================
[0m01:14:51.428310 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:14:51.429252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:14:53.515228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86f54be9-3f92-4866-9919-68c11e4087cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c988fc0>]}
[0m01:14:53.616178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86f54be9-3f92-4866-9919-68c11e4087cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c659590>]}
[0m01:14:53.617258 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m01:14:53.825952 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:14:54.068991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:14:54.071192 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events.sql
[0m01:14:54.553475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86f54be9-3f92-4866-9919-68c11e4087cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec8050>]}
[0m01:14:54.708505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86f54be9-3f92-4866-9919-68c11e4087cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8a7890>]}
[0m01:14:54.709435 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 484 macros
[0m01:14:54.709872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f54be9-3f92-4866-9919-68c11e4087cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfcbd90>]}
[0m01:14:54.713093 [info ] [MainThread]: 
[0m01:14:54.714337 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:14:54.716460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m01:14:54.717462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:55.113939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m01:14:55.114414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:55.372625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f54be9-3f92-4866-9919-68c11e4087cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d05b930>]}
[0m01:14:55.373148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:55.373381 [info ] [MainThread]: 
[0m01:14:55.377924 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m01:14:55.379281 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m01:14:55.380101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m01:14:55.380658 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m01:14:55.399146 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m01:14:55.401070 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m01:14:55.432485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:55.765930 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m01:14:55.771029 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT 
        venue_id,
        time AS event_start_time,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        FORMAT_TIMESTAMP('%Y-%m', TIMESTAMP_SECONDS
        (CAST(created / 1000 AS INT64))) AS event_create_time,
        group_id,
        name AS event_name,
        description AS event_description,
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        rsvp.when AS rsvp_response_time,
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT 
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.event_description,
        e.rsvp_total_limit,
        e.rsvp_user_id,
        e.rsvp_response,
        e.rsvp_response_time,
        e.rsvp_guests,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    event_description,
    rsvp_total_limit,
    rsvp_user_id
    rsvp_response,
    rsvp_response_time,
    rsvp_guests,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m01:14:56.224411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7f6293d9-d09d-4e60-b02c-5105d6bffe63&page=queryresults
[0m01:15:01.052131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f54be9-3f92-4866-9919-68c11e4087cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0696d0>]}
[0m01:15:01.053876 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events ..................... [[32mCREATE TABLE (174.1k rows, 11.4 MiB processed)[0m in 5.67s]
[0m01:15:01.055445 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m01:15:01.057713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:01.058334 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m01:15:01.058920 [info ] [MainThread]: 
[0m01:15:01.059223 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.34 seconds (6.34s).
[0m01:15:01.059955 [debug] [MainThread]: Command end result
[0m01:15:01.125016 [info ] [MainThread]: 
[0m01:15:01.125951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:15:01.126413 [info ] [MainThread]: 
[0m01:15:01.127177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:15:01.131000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.827383, "process_user_time": 2.78069, "process_kernel_time": 1.66772, "process_mem_max_rss": "208863232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:15:01.131889 [debug] [MainThread]: Command `dbt run` succeeded at 01:15:01.131756 after 9.83 seconds
[0m01:15:01.132596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d01af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf75810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf74eb0>]}
[0m01:15:01.133105 [debug] [MainThread]: Flushing usage events
[0m14:09:00.881299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7ed0>]}


============================== 14:09:00.889442 | 656ad1bf-6090-49f9-8d07-5b6d04c815ef ==============================
[0m14:09:00.889442 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:09:00.890627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_events_rsvp', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:02.828563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '656ad1bf-6090-49f9-8d07-5b6d04c815ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb88fc0>]}
[0m14:09:02.926432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '656ad1bf-6090-49f9-8d07-5b6d04c815ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef59590>]}
[0m14:09:02.927843 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:09:03.140444 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:09:03.354007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:03.355099 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/stg_events_rsvp.sql
[0m14:09:03.817713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '656ad1bf-6090-49f9-8d07-5b6d04c815ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffc8050>]}
[0m14:09:04.011750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '656ad1bf-6090-49f9-8d07-5b6d04c815ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9a7890>]}
[0m14:09:04.012661 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 484 macros
[0m14:09:04.013411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '656ad1bf-6090-49f9-8d07-5b6d04c815ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180c7d90>]}
[0m14:09:04.016531 [info ] [MainThread]: 
[0m14:09:04.017252 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:09:04.018456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:09:04.019143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:04.413700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:09:04.414116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:04.682940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '656ad1bf-6090-49f9-8d07-5b6d04c815ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118157930>]}
[0m14:09:04.683467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:04.683700 [info ] [MainThread]: 
[0m14:09:04.686353 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m14:09:04.686789 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m14:09:04.687122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_rsvp)
[0m14:09:04.687362 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m14:09:04.694990 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m14:09:04.697213 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m14:09:04.725888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:05.041513 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m14:09:05.042917 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        time AS event_start_time,
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        rsvp.when AS rsvp_response_time,
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT 
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM rsvp
    );
  
[0m14:09:06.047079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e943457a-57e6-4d70-a85e-7c381f003ad7&page=queryresults
[0m14:09:09.294602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '656ad1bf-6090-49f9-8d07-5b6d04c815ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11816a090>]}
[0m14:09:09.295738 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events_rsvp ................ [[32mCREATE TABLE (174.1k rows, 5.2 MiB processed)[0m in 4.61s]
[0m14:09:09.296994 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m14:09:09.299081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:09.299627 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m14:09:09.300126 [info ] [MainThread]: 
[0m14:09:09.300547 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.28 seconds (5.28s).
[0m14:09:09.301568 [debug] [MainThread]: Command end result
[0m14:09:09.366668 [info ] [MainThread]: 
[0m14:09:09.367962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:09.368742 [info ] [MainThread]: 
[0m14:09:09.369469 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:09:09.373804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.600406, "process_user_time": 2.69611, "process_kernel_time": 1.566809, "process_mem_max_rss": "207962112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:09:09.374998 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:09.374812 after 8.60 seconds
[0m14:09:09.375464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11811af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118075810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118074eb0>]}
[0m14:09:09.376044 [debug] [MainThread]: Flushing usage events
[0m14:14:48.820293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105636660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075abed0>]}


============================== 14:14:48.828687 | 281488b3-4896-4a9e-8f51-0582f013a768 ==============================
[0m14:14:48.828687 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:14:48.830124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:50.748750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e988fc0>]}
[0m14:14:50.845204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de59590>]}
[0m14:14:50.846346 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:14:51.062004 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:14:51.301706 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m14:14:51.302677 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_events.sql
[0m14:14:51.303168 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_users.sql
[0m14:14:51.303530 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_groups.sql
[0m14:14:51.304121 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_events_rsvp.sql
[0m14:14:51.304393 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/stg_events.sql
[0m14:14:51.304782 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/stg_users.sql
[0m14:14:51.305319 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/stg_events_rsvp.sql
[0m14:14:51.305678 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/stg_groups.sql
[0m14:14:51.772738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12edc8250>]}
[0m14:14:51.967289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e8a7a70>]}
[0m14:14:51.968387 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 484 macros
[0m14:14:51.968862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eecbcb0>]}
[0m14:14:51.971960 [info ] [MainThread]: 
[0m14:14:51.972847 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:14:51.980594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:14:51.981456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:52.432916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:14:52.433281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:52.719628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef57930>]}
[0m14:14:52.720136 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:52.720365 [info ] [MainThread]: 
[0m14:14:52.723043 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m14:14:52.723372 [debug] [Thread-3 (]: Began running node model.keira_project.stg_events_rsvp
[0m14:14:52.723633 [debug] [Thread-4 (]: Began running node model.keira_project.stg_groups
[0m14:14:52.723872 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events
[0m14:14:52.724239 [info ] [Thread-1 (]: 1 of 6 START sql table model meetupservice.my_first_dbt_model .................. [RUN]
[0m14:14:52.724635 [info ] [Thread-3 (]: 3 of 6 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m14:14:52.724983 [info ] [Thread-4 (]: 4 of 6 START sql table model meetupservice.stg_groups .......................... [RUN]
[0m14:14:52.725308 [info ] [Thread-2 (]: 2 of 6 START sql table model meetupservice.stg_events .......................... [RUN]
[0m14:14:52.725673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m14:14:52.726692 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.stg_groups'
[0m14:14:52.727018 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.stg_events'
[0m14:14:52.727381 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m14:14:52.726006 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.stg_events_rsvp'
[0m14:14:52.728130 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_groups
[0m14:14:52.728423 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events
[0m14:14:52.736826 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m14:14:52.737692 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m14:14:52.742843 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m14:14:52.749701 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m14:14:52.755108 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m14:14:52.756522 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m14:14:52.757608 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_groups
[0m14:14:52.770982 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_events_rsvp
[0m14:14:52.777286 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events
[0m14:14:52.821921 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:14:52.827322 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:14:52.831059 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:52.831894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:53.515065 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m14:14:53.519290 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_first_dbt_model"
[0m14:14:53.522147 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m14:14:53.523795 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m14:14:53.525385 [debug] [Thread-2 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT 
        venue_id,
        time AS event_start_time,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        FORMAT_TIMESTAMP('%Y-%m', TIMESTAMP_SECONDS
        (CAST(created / 1000 AS INT64))) AS event_create_time,
        group_id,
        name AS event_name,
        description AS event_description,
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        rsvp.when AS rsvp_response_time,
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT 
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.event_description,
        e.rsvp_total_limit,
        e.rsvp_user_id,
        e.rsvp_response,
        e.rsvp_response_time,
        e.rsvp_guests,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    event_description,
    rsvp_total_limit,
    rsvp_user_id
    rsvp_response,
    rsvp_response_time,
    rsvp_guests,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m14:14:53.526360 [debug] [Thread-4 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_year, 
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m14:14:53.527097 [debug] [Thread-3 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        time AS event_start_time,
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        rsvp.when AS rsvp_response_time,
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT 
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM rsvp
    );
  
[0m14:14:53.529639 [debug] [Thread-1 (]: On model.keira_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_first_dbt_model"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:14:54.188394 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7c1af395-5853-4867-971a-7fa1bb248a6d&page=queryresults
[0m14:14:54.188854 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:57ab5933-4369-461d-bf10-6c01fc245890&page=queryresults
[0m14:14:54.189204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:c334e849-68e2-4d99-83bc-836f1c01aec1&page=queryresults
[0m14:14:54.189521 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:310b3aa6-9ec0-4ceb-aa64-8f6b6af9cbb2&page=queryresults
[0m14:14:56.863531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef07650>]}
[0m14:14:56.867165 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eefb280>]}
[0m14:14:56.868429 [info ] [Thread-1 (]: 1 of 6 OK created sql table model meetupservice.my_first_dbt_model ............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.14s]
[0m14:14:56.869479 [info ] [Thread-4 (]: 4 of 6 OK created sql table model meetupservice.stg_groups ..................... [[32mCREATE TABLE (711.0 rows, 442.7 KiB processed)[0m in 4.14s]
[0m14:14:56.870571 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m14:14:56.871378 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_groups
[0m14:14:56.872159 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m14:14:56.873534 [info ] [Thread-1 (]: 5 of 6 START sql table model meetupservice.stg_users ........................... [RUN]
[0m14:14:56.874716 [debug] [Thread-4 (]: Began running node model.keira_project.my_second_dbt_model
[0m14:14:56.875397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_first_dbt_model, now model.keira_project.stg_users)
[0m14:14:56.876356 [info ] [Thread-4 (]: 6 of 6 START sql view model meetupservice.my_second_dbt_model .................. [RUN]
[0m14:14:56.877220 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m14:14:56.877893 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_groups, now model.keira_project.my_second_dbt_model)
[0m14:14:56.885890 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m14:14:56.886620 [debug] [Thread-4 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m14:14:56.890659 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m14:14:56.892255 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m14:14:56.896723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:56.990978 [debug] [Thread-4 (]: Began executing node model.keira_project.my_second_dbt_model
[0m14:14:57.038610 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.my_second_dbt_model"
[0m14:14:57.040267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:14:57.042999 [debug] [Thread-4 (]: On model.keira_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_second_dbt_model"} */


  create or replace view `keira-xebia`.`meetupservice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `keira-xebia`.`meetupservice`.`my_first_dbt_model`
where id = 1;


[0m14:14:57.259028 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0c6210>]}
[0m14:14:57.260113 [info ] [Thread-3 (]: 3 of 6 OK created sql table model meetupservice.stg_events_rsvp ................ [[32mCREATE TABLE (174.1k rows, 5.2 MiB processed)[0m in 4.53s]
[0m14:14:57.261360 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_events_rsvp
[0m14:14:57.293174 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m14:14:57.294741 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown,
        membership.group_id AS join_group_id,
        EXTRACT(YEAR FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_year, 
        EXTRACT(MONTH FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_month,
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown,
    join_group_id,
    join_group_year,
    join_group_month
FROM users
    );
  
[0m14:14:57.664968 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:be4219c9-515c-432c-9a52-65508e109124&page=queryresults
[0m14:14:57.787693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:50004b32-e18f-4c8a-9681-2cb90483d826&page=queryresults
[0m14:14:57.951222 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12efb4650>]}
[0m14:14:57.951773 [info ] [Thread-4 (]: 6 of 6 OK created sql view model meetupservice.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:14:57.952282 [debug] [Thread-4 (]: Finished running node model.keira_project.my_second_dbt_model
[0m14:15:00.723810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0d0830>]}
[0m14:15:00.724431 [info ] [Thread-1 (]: 5 of 6 OK created sql table model meetupservice.stg_users ...................... [[32mCREATE TABLE (145.5k rows, 5.4 MiB processed)[0m in 3.85s]
[0m14:15:00.724891 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m14:15:01.967012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '281488b3-4896-4a9e-8f51-0582f013a768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef6b290>]}
[0m14:15:01.967590 [info ] [Thread-2 (]: 2 of 6 OK created sql table model meetupservice.stg_events ..................... [[32mCREATE TABLE (174.1k rows, 11.4 MiB processed)[0m in 9.24s]
[0m14:15:01.968081 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events
[0m14:15:01.969124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:01.969336 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m14:15:01.969509 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m14:15:01.969676 [debug] [MainThread]: Connection 'model.keira_project.my_second_dbt_model' was properly closed.
[0m14:15:01.969839 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m14:15:01.970076 [info ] [MainThread]: 
[0m14:15:01.970296 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 10.00 seconds (10.00s).
[0m14:15:01.971356 [debug] [MainThread]: Command end result
[0m14:15:02.018551 [info ] [MainThread]: 
[0m14:15:02.019328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:02.020150 [info ] [MainThread]: 
[0m14:15:02.021035 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:15:02.024649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.315802, "process_user_time": 3.151054, "process_kernel_time": 1.73415, "process_mem_max_rss": "209715200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:15:02.025454 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:02.025289 after 13.32 seconds
[0m14:15:02.026055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef6a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef68cb0>]}
[0m14:15:02.026522 [debug] [MainThread]: Flushing usage events
[0m14:38:24.453297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7ed0>]}


============================== 14:38:24.462587 | a58eb02d-38a6-42a2-bee9-ccc9768a0f6f ==============================
[0m14:38:24.462587 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:38:24.463596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_events_rsvp', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:26.392994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a58eb02d-38a6-42a2-bee9-ccc9768a0f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e888fc0>]}
[0m14:38:26.488989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a58eb02d-38a6-42a2-bee9-ccc9768a0f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de59590>]}
[0m14:38:26.490306 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:38:26.704374 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:38:26.947010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:38:26.948186 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m14:38:26.948905 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events_rsvp.sql
[0m14:38:27.421277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a58eb02d-38a6-42a2-bee9-ccc9768a0f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11edc4050>]}
[0m14:38:27.621238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a58eb02d-38a6-42a2-bee9-ccc9768a0f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfaba70>]}
[0m14:38:27.622221 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m14:38:27.622784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a58eb02d-38a6-42a2-bee9-ccc9768a0f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eec7e70>]}
[0m14:38:27.625575 [info ] [MainThread]: 
[0m14:38:27.626639 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:38:27.627952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:38:27.628645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:28.032103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:38:28.032531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:28.284189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a58eb02d-38a6-42a2-bee9-ccc9768a0f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef5f930>]}
[0m14:38:28.284681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:38:28.284952 [info ] [MainThread]: 
[0m14:38:28.287545 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m14:38:28.287966 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m14:38:28.288322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_rsvp)
[0m14:38:28.288612 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m14:38:28.300657 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m14:38:28.302250 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m14:38:28.331145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:28.650768 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m14:38:28.652356 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        time AS event_start_time,
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT 
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM rsvp
    );
  
[0m14:38:29.364491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:4e91e262-9392-4144-92af-26daf68909d9&page=queryresults
[0m14:38:32.333440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58eb02d-38a6-42a2-bee9-ccc9768a0f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef0a5d0>]}
[0m14:38:32.334086 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events_rsvp ................ [[32mCREATE TABLE (174.1k rows, 5.2 MiB processed)[0m in 4.04s]
[0m14:38:32.335409 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m14:38:32.337349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:32.337900 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m14:38:32.338279 [info ] [MainThread]: 
[0m14:38:32.338749 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.71 seconds (4.71s).
[0m14:38:32.339934 [debug] [MainThread]: Command end result
[0m14:38:32.403000 [info ] [MainThread]: 
[0m14:38:32.403811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:32.404280 [info ] [MainThread]: 
[0m14:38:32.404886 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:32.408789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.071137, "process_user_time": 2.703281, "process_kernel_time": 1.562509, "process_mem_max_rss": "208912384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:38:32.409589 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:32.409412 after 8.07 seconds
[0m14:38:32.410244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef1ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e852d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e853070>]}
[0m14:38:32.410849 [debug] [MainThread]: Flushing usage events
[0m14:42:43.493580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024d2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e33c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e33ed0>]}


============================== 14:42:43.501676 | ef109d10-1264-4b07-af29-ff7d5a2a1783 ==============================
[0m14:42:43.501676 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:42:43.502888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_events_rsvp', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:42:45.477233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef109d10-1264-4b07-af29-ff7d5a2a1783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a88fc0>]}
[0m14:42:45.564069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef109d10-1264-4b07-af29-ff7d5a2a1783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142f59590>]}
[0m14:42:45.565422 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:42:45.765301 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:42:46.021135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:46.022138 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events_rsvp.sql
[0m14:42:46.472273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef109d10-1264-4b07-af29-ff7d5a2a1783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143dc4b50>]}
[0m14:42:46.661876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef109d10-1264-4b07-af29-ff7d5a2a1783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1438a7c50>]}
[0m14:42:46.662751 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m14:42:46.663564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef109d10-1264-4b07-af29-ff7d5a2a1783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143fcfe70>]}
[0m14:42:46.666558 [info ] [MainThread]: 
[0m14:42:46.667682 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:42:46.669318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:42:46.669847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:47.066070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:42:47.066453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:47.338606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef109d10-1264-4b07-af29-ff7d5a2a1783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14405f930>]}
[0m14:42:47.339124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:47.339354 [info ] [MainThread]: 
[0m14:42:47.341953 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m14:42:47.342394 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m14:42:47.342766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_rsvp)
[0m14:42:47.343050 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m14:42:47.350672 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m14:42:47.351548 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m14:42:47.378197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:47.702875 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m14:42:47.704484 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(event_start_time / 1000 AS INT64)), --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT 
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM rsvp
    );
  
[0m14:42:48.145451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e2edf8b0-95d6-4ffe-9aa2-53b20c7edeb3&page=queryresults
[0m14:42:48.246940 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event_start_time at [21:32]; reason: invalidQuery, location: query, message: Unrecognized name: event_start_time at [21:32]')
[0m14:42:49.258512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:b5d59701-e8b4-4f7a-9e54-bc4e938f0208&page=queryresults
[0m14:42:49.372604 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:b5d59701-e8b4-4f7a-9e54-bc4e938f0208&page=queryresults
[0m14:42:49.382984 [debug] [Thread-1 (]: Database Error in model stg_events_rsvp (models/Staging/stg_events_rsvp.sql)
  Unrecognized name: event_start_time at [21:32]
  compiled code at target/run/keira_project/models/Staging/stg_events_rsvp.sql
[0m14:42:49.384305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef109d10-1264-4b07-af29-ff7d5a2a1783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144006990>]}
[0m14:42:49.384826 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events_rsvp ............ [[31mERROR[0m in 2.04s]
[0m14:42:49.385262 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m14:42:49.386769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:49.387001 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m14:42:49.387208 [info ] [MainThread]: 
[0m14:42:49.387456 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m14:42:49.387967 [debug] [MainThread]: Command end result
[0m14:42:49.450635 [info ] [MainThread]: 
[0m14:42:49.451413 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:49.451750 [info ] [MainThread]: 
[0m14:42:49.452740 [error] [MainThread]:   Database Error in model stg_events_rsvp (models/Staging/stg_events_rsvp.sql)
  Unrecognized name: event_start_time at [21:32]
  compiled code at target/run/keira_project/models/Staging/stg_events_rsvp.sql
[0m14:42:49.453077 [info ] [MainThread]: 
[0m14:42:49.453588 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:49.457218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.069327, "process_user_time": 2.693316, "process_kernel_time": 1.545187, "process_mem_max_rss": "208896000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:42:49.457911 [debug] [MainThread]: Command `dbt run` failed at 14:42:49.457801 after 6.07 seconds
[0m14:42:49.458425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144016fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a51270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f75950>]}
[0m14:42:49.458946 [debug] [MainThread]: Flushing usage events
[0m14:43:36.774376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104836660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7ed0>]}


============================== 14:43:36.782364 | 2cc2d7c7-6f00-4c28-a014-08226d178a30 ==============================
[0m14:43:36.782364 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:43:36.783187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_events_rsvp', 'send_anonymous_usage_stats': 'True'}
[0m14:43:38.716233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc2d7c7-6f00-4c28-a014-08226d178a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b88fc0>]}
[0m14:43:38.808743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc2d7c7-6f00-4c28-a014-08226d178a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115859590>]}
[0m14:43:38.810257 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:43:39.025507 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:43:39.265252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:39.266573 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events_rsvp.sql
[0m14:43:39.719330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc2d7c7-6f00-4c28-a014-08226d178a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115eccb50>]}
[0m14:43:39.918894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc2d7c7-6f00-4c28-a014-08226d178a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115aabc50>]}
[0m14:43:39.919752 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m14:43:39.920326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc2d7c7-6f00-4c28-a014-08226d178a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fcfe70>]}
[0m14:43:39.923183 [info ] [MainThread]: 
[0m14:43:39.924300 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:43:39.925721 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:43:39.926219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:40.361443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:43:40.361842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:40.621569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc2d7c7-6f00-4c28-a014-08226d178a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11605f930>]}
[0m14:43:40.622110 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:40.622346 [info ] [MainThread]: 
[0m14:43:40.625064 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m14:43:40.625533 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m14:43:40.625910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_rsvp)
[0m14:43:40.626187 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m14:43:40.635138 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m14:43:40.636597 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m14:43:40.664523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:40.985593 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m14:43:40.986865 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
)

SELECT 
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM rsvp
    );
  
[0m14:43:41.483702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:613f1afc-ba06-4e12-b07d-a2a6d1bf2dc8&page=queryresults
[0m14:43:44.405141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc2d7c7-6f00-4c28-a014-08226d178a30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116069fd0>]}
[0m14:43:44.405983 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events_rsvp ................ [[32mCREATE TABLE (174.1k rows, 5.2 MiB processed)[0m in 3.78s]
[0m14:43:44.406461 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m14:43:44.407442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:44.407668 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m14:43:44.407870 [info ] [MainThread]: 
[0m14:43:44.408246 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m14:43:44.409346 [debug] [MainThread]: Command end result
[0m14:43:44.474322 [info ] [MainThread]: 
[0m14:43:44.475277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:44.475754 [info ] [MainThread]: 
[0m14:43:44.476270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:43:44.480287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8111115, "process_user_time": 2.690984, "process_kernel_time": 1.546661, "process_mem_max_rss": "207552512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:43:44.481047 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:44.480949 after 7.81 seconds
[0m14:43:44.481577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116016f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b51270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f75950>]}
[0m14:43:44.482067 [debug] [MainThread]: Flushing usage events
[0m15:31:38.080582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de7ed0>]}


============================== 15:31:38.088585 | 1d2202b0-b5f6-4b96-9b14-991bb6316b69 ==============================
[0m15:31:38.088585 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:31:38.089558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_events_users_rsvp', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:39.997715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d2202b0-b5f6-4b96-9b14-991bb6316b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130388fc0>]}
[0m15:31:40.094462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d2202b0-b5f6-4b96-9b14-991bb6316b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130159590>]}
[0m15:31:40.095961 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:31:40.279716 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:31:40.529577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:40.530743 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m15:31:40.994771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d2202b0-b5f6-4b96-9b14-991bb6316b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306cc850>]}
[0m15:31:41.213165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d2202b0-b5f6-4b96-9b14-991bb6316b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302a77a0>]}
[0m15:31:41.214027 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:31:41.214568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d2202b0-b5f6-4b96-9b14-991bb6316b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1307cfe70>]}
[0m15:31:41.215685 [warn ] [MainThread]: The selection criterion 'stg_events_users_rsvp' does not match any enabled nodes
[0m15:31:41.217960 [info ] [MainThread]: 
[0m15:31:41.218720 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:31:41.219326 [debug] [MainThread]: Command end result
[0m15:31:41.273463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2999892, "process_user_time": 2.40727, "process_kernel_time": 1.433001, "process_mem_max_rss": "205193216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:31:41.274784 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:41.274501 after 3.30 seconds
[0m15:31:41.275307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130803c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130805490>]}
[0m15:31:41.276026 [debug] [MainThread]: Flushing usage events
[0m15:32:08.819072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ae7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ae7ed0>]}


============================== 15:32:08.827080 | ebb5867c-0115-4a58-8f9b-8f63f12aef59 ==============================
[0m15:32:08.827080 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:32:08.827844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:32:10.512346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb5867c-0115-4a58-8f9b-8f63f12aef59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138088fc0>]}
[0m15:32:10.611545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb5867c-0115-4a58-8f9b-8f63f12aef59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe59590>]}
[0m15:32:10.612768 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:32:10.811124 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:32:11.049782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:32:11.050563 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:32:11.142074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb5867c-0115-4a58-8f9b-8f63f12aef59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff71850>]}
[0m15:32:11.353309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb5867c-0115-4a58-8f9b-8f63f12aef59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffa7980>]}
[0m15:32:11.354362 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:32:11.355127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb5867c-0115-4a58-8f9b-8f63f12aef59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138001470>]}
[0m15:32:11.358516 [info ] [MainThread]: 
[0m15:32:11.359850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:32:11.361400 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:32:11.361877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:11.752269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:32:11.752694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:12.012149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb5867c-0115-4a58-8f9b-8f63f12aef59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1383fb790>]}
[0m15:32:12.012654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:32:12.012922 [info ] [MainThread]: 
[0m15:32:12.016156 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m15:32:12.016882 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m15:32:12.017650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m15:32:12.018209 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m15:32:12.040217 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m15:32:12.041821 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m15:32:12.120270 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m15:32:12.122305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:12.125395 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time), --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time), --YYYY-MM-DD
        rsvp_guests,
        MIN (rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_time,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_start_time,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_time AS final_response_time,
        rsvp_guests AS final_response_guests,
        first_response_time,
        -- time duration from the last response to event day.
        DATE_DIFF(event_start_time, final_response_time, DAY) AS final_response_duration, 
        CASE WHEN final_response_time != first_response_time THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_time,
    final_response_time,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m15:32:12.743380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f3ec684c-912d-4b30-b8f3-cb0b68481ee6&page=queryresults
[0m15:32:12.836880 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event_start_time at [40:9]; reason: invalidQuery, location: query, message: Unrecognized name: event_start_time at [40:9]')
[0m15:32:14.008896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:8a21f2d0-9214-4af5-afed-f7aab7971c1f&page=queryresults
[0m15:32:14.102585 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:8a21f2d0-9214-4af5-afed-f7aab7971c1f&page=queryresults
[0m15:32:14.113710 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: event_start_time at [40:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:32:14.115078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb5867c-0115-4a58-8f9b-8f63f12aef59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138305c10>]}
[0m15:32:14.115589 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.10s]
[0m15:32:14.116089 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m15:32:14.117688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:14.117979 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m15:32:14.118261 [info ] [MainThread]: 
[0m15:32:14.118554 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m15:32:14.119997 [debug] [MainThread]: Command end result
[0m15:32:14.176302 [info ] [MainThread]: 
[0m15:32:14.177278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:32:14.177825 [info ] [MainThread]: 
[0m15:32:14.178885 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: event_start_time at [40:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:32:14.179370 [info ] [MainThread]: 
[0m15:32:14.179764 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:32:14.183608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4681916, "process_user_time": 2.534595, "process_kernel_time": 1.393265, "process_mem_max_rss": "206176256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:32:14.184527 [debug] [MainThread]: Command `dbt run` failed at 15:32:14.184361 after 5.47 seconds
[0m15:32:14.185049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13847bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13848def0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13848ff70>]}
[0m15:32:14.185641 [debug] [MainThread]: Flushing usage events
[0m15:39:02.550129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e7ed0>]}


============================== 15:39:02.559215 | ea79efe7-04c3-451b-bcdd-5c919052807a ==============================
[0m15:39:02.559215 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:39:02.560100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:39:04.478812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea79efe7-04c3-451b-bcdd-5c919052807a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a88fc0>]}
[0m15:39:04.581589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea79efe7-04c3-451b-bcdd-5c919052807a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d59590>]}
[0m15:39:04.582890 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:39:04.797879 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:39:05.035047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:05.036327 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m15:39:05.499035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea79efe7-04c3-451b-bcdd-5c919052807a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123dccb50>]}
[0m15:39:05.694401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea79efe7-04c3-451b-bcdd-5c919052807a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fab7a0>]}
[0m15:39:05.695133 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:39:05.695534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea79efe7-04c3-451b-bcdd-5c919052807a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ecfe70>]}
[0m15:39:05.698274 [info ] [MainThread]: 
[0m15:39:05.699255 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:05.700725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:39:05.701330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:06.096865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:39:06.097237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:06.382459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea79efe7-04c3-451b-bcdd-5c919052807a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f5b930>]}
[0m15:39:06.382949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:06.383202 [info ] [MainThread]: 
[0m15:39:06.385760 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m15:39:06.386201 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m15:39:06.386557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m15:39:06.386810 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m15:39:06.394439 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m15:39:06.395155 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m15:39:06.469336 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m15:39:06.470795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:06.473513 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time), --YYYY-MM-DD
        rsvp_guests,
        MIN (rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_time AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m15:39:07.570560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:17e7b0a4-2c58-4223-a423-662e7ab3c5b6&page=queryresults
[0m15:39:07.750520 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/keira-xebia/queries/17e7b0a4-2c58-4223-a423-662e7ab3c5b6?maxResults=0&location=EU&prettyPrint=false: Unrecognized name: rsvp_response_time; Did you mean rsvp_response? at [43:9]')
[0m15:39:08.447015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a3a6c61e-5efb-40f3-baff-96e86fbc7ff9&page=queryresults
[0m15:39:08.541471 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a3a6c61e-5efb-40f3-baff-96e86fbc7ff9&page=queryresults
[0m15:39:08.551797 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_time; Did you mean rsvp_response? at [43:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:39:08.553148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea79efe7-04c3-451b-bcdd-5c919052807a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f0ea50>]}
[0m15:39:08.553666 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.17s]
[0m15:39:08.554124 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m15:39:08.555558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:08.555804 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m15:39:08.556016 [info ] [MainThread]: 
[0m15:39:08.556238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m15:39:08.557309 [debug] [MainThread]: Command end result
[0m15:39:08.623969 [info ] [MainThread]: 
[0m15:39:08.624851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:08.625371 [info ] [MainThread]: 
[0m15:39:08.625928 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_time; Did you mean rsvp_response? at [43:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:39:08.626417 [info ] [MainThread]: 
[0m15:39:08.626925 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:39:08.631077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.189683, "process_user_time": 2.673979, "process_kernel_time": 1.544738, "process_mem_max_rss": "209059840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:39:08.632116 [debug] [MainThread]: Command `dbt run` failed at 15:39:08.631986 after 6.19 seconds
[0m15:39:08.632654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f16db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a35270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e75950>]}
[0m15:39:08.633392 [debug] [MainThread]: Flushing usage events
[0m15:40:40.519343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104836660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069abed0>]}


============================== 15:40:40.527226 | 183872b1-76a1-4dba-8534-599912c32a90 ==============================
[0m15:40:40.527226 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:40:40.528103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:40:42.434684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '183872b1-76a1-4dba-8534-599912c32a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff88fc0>]}
[0m15:40:42.532160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '183872b1-76a1-4dba-8534-599912c32a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd59590>]}
[0m15:40:42.533734 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:40:42.756009 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:40:42.999565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:40:43.000979 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m15:40:43.452031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183872b1-76a1-4dba-8534-599912c32a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150bccb50>]}
[0m15:40:43.654803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183872b1-76a1-4dba-8534-599912c32a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fea77a0>]}
[0m15:40:43.656217 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:40:43.659166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183872b1-76a1-4dba-8534-599912c32a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150ccfe70>]}
[0m15:40:43.664525 [info ] [MainThread]: 
[0m15:40:43.665653 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:40:43.667031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:40:43.667464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:44.036961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:40:44.037368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:44.285371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183872b1-76a1-4dba-8534-599912c32a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150d57930>]}
[0m15:40:44.285866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:44.286112 [info ] [MainThread]: 
[0m15:40:44.288827 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m15:40:44.289312 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m15:40:44.289655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m15:40:44.289907 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m15:40:44.303542 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m15:40:44.304907 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m15:40:44.382558 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m15:40:44.384152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:44.387029 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN (rsvp_response_date) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_date DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m15:40:45.044133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ed22a938-d51b-4db5-8036-a815f1c9d481&page=queryresults
[0m15:40:45.125668 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:14]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:14]')
[0m15:40:46.546133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0a79fd20-7b1c-487a-96f9-1ead60d312e6&page=queryresults
[0m15:40:46.635224 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0a79fd20-7b1c-487a-96f9-1ead60d312e6&page=queryresults
[0m15:40:46.646271 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:14]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:40:46.647589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183872b1-76a1-4dba-8534-599912c32a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150d02810>]}
[0m15:40:46.648092 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.36s]
[0m15:40:46.648532 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m15:40:46.649987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:46.650211 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m15:40:46.650677 [info ] [MainThread]: 
[0m15:40:46.651161 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m15:40:46.652104 [debug] [MainThread]: Command end result
[0m15:40:46.715764 [info ] [MainThread]: 
[0m15:40:46.716662 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:40:46.717467 [info ] [MainThread]: 
[0m15:40:46.718261 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:14]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:40:46.718612 [info ] [MainThread]: 
[0m15:40:46.719053 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:40:46.723483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3105683, "process_user_time": 2.692185, "process_kernel_time": 1.560095, "process_mem_max_rss": "208863232", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:40:46.724538 [debug] [MainThread]: Command `dbt run` failed at 15:40:46.724308 after 6.31 seconds
[0m15:40:46.725166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150d16c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff51270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c75950>]}
[0m15:40:46.725870 [debug] [MainThread]: Flushing usage events
[0m15:42:15.145198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7ed0>]}


============================== 15:42:15.153570 | d532b50a-809b-4622-a78b-848fc2eecd47 ==============================
[0m15:42:15.153570 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:42:15.154572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:17.102967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd532b50a-809b-4622-a78b-848fc2eecd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134488fc0>]}
[0m15:42:17.202135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd532b50a-809b-4622-a78b-848fc2eecd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134159590>]}
[0m15:42:17.203187 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:42:17.411504 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:42:17.657713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:17.659233 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m15:42:18.125357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd532b50a-809b-4622-a78b-848fc2eecd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347ccb50>]}
[0m15:42:18.321084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd532b50a-809b-4622-a78b-848fc2eecd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342a77a0>]}
[0m15:42:18.322141 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:42:18.322808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd532b50a-809b-4622-a78b-848fc2eecd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348cfe70>]}
[0m15:42:18.326263 [info ] [MainThread]: 
[0m15:42:18.327373 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:18.328672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:42:18.329226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:18.696260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:42:18.696627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:18.968420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd532b50a-809b-4622-a78b-848fc2eecd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13495f930>]}
[0m15:42:18.968914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:18.969143 [info ] [MainThread]: 
[0m15:42:18.971686 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m15:42:18.972125 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m15:42:18.972498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m15:42:18.972781 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m15:42:18.980344 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m15:42:18.981299 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m15:42:19.056146 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m15:42:19.058278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:19.061820 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_date) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_date DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m15:42:19.730521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0fbcc429-f1bf-4a63-8672-f5b31737b4df&page=queryresults
[0m15:42:19.820420 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]')
[0m15:42:20.550982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7458f017-6b1d-456b-a09f-c15d62a4e6f0&page=queryresults
[0m15:42:20.643066 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7458f017-6b1d-456b-a09f-c15d62a4e6f0&page=queryresults
[0m15:42:20.652819 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:42:20.654139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd532b50a-809b-4622-a78b-848fc2eecd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134906810>]}
[0m15:42:20.654654 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 1.68s]
[0m15:42:20.655095 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m15:42:20.656663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:20.656944 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m15:42:20.657165 [info ] [MainThread]: 
[0m15:42:20.657401 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m15:42:20.657919 [debug] [MainThread]: Command end result
[0m15:42:20.720418 [info ] [MainThread]: 
[0m15:42:20.721201 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:42:20.721790 [info ] [MainThread]: 
[0m15:42:20.722330 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:42:20.722874 [info ] [MainThread]: 
[0m15:42:20.723276 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:42:20.727406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.69169, "process_user_time": 2.684894, "process_kernel_time": 1.564486, "process_mem_max_rss": "207634432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:42:20.728443 [debug] [MainThread]: Command `dbt run` failed at 15:42:20.728264 after 5.69 seconds
[0m15:42:20.729127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134922ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134451270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134875950>]}
[0m15:42:20.729746 [debug] [MainThread]: Flushing usage events
[0m15:46:05.439888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110abed0>]}


============================== 15:46:05.448238 | 6e162cf3-82b7-480f-8c91-2b1436413127 ==============================
[0m15:46:05.448238 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:46:05.449123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'send_anonymous_usage_stats': 'True'}
[0m15:46:07.360277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e162cf3-82b7-480f-8c91-2b1436413127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122488fc0>]}
[0m15:46:07.455860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e162cf3-82b7-480f-8c91-2b1436413127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122159590>]}
[0m15:46:07.457314 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:46:07.678054 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:46:07.919192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:07.920341 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m15:46:08.381890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e162cf3-82b7-480f-8c91-2b1436413127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227ccb50>]}
[0m15:46:08.580756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e162cf3-82b7-480f-8c91-2b1436413127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223a77a0>]}
[0m15:46:08.582006 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:46:08.582740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e162cf3-82b7-480f-8c91-2b1436413127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228cfe70>]}
[0m15:46:08.585630 [info ] [MainThread]: 
[0m15:46:08.586678 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:08.588114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:46:08.588605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:08.988019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:46:08.988383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:09.251065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e162cf3-82b7-480f-8c91-2b1436413127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12295b930>]}
[0m15:46:09.251563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:09.251795 [info ] [MainThread]: 
[0m15:46:09.254308 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m15:46:09.254746 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m15:46:09.255072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m15:46:09.255321 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m15:46:09.263780 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m15:46:09.265310 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m15:46:09.341821 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m15:46:09.343302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:09.346525 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_date) OVER (
            PARTITION BY venue_id, group_id, event_name, event_date, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_date, rsvp_user_id
            ORDER BY rsvp_response_date DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m15:46:10.028663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:597540d6-e2f6-4914-a906-589c1fb7f6b4&page=queryresults
[0m15:46:10.148580 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]')
[0m15:46:11.564625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:3864c865-1646-4c7b-bf7e-4d647c9c7261&page=queryresults
[0m15:46:11.657593 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:3864c865-1646-4c7b-bf7e-4d647c9c7261&page=queryresults
[0m15:46:11.677395 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:46:11.691139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e162cf3-82b7-480f-8c91-2b1436413127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122966810>]}
[0m15:46:11.692247 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.42s]
[0m15:46:11.693101 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m15:46:11.696734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:11.697627 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m15:46:11.698014 [info ] [MainThread]: 
[0m15:46:11.698521 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m15:46:11.699941 [debug] [MainThread]: Command end result
[0m15:46:11.750899 [info ] [MainThread]: 
[0m15:46:11.752068 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:46:11.752427 [info ] [MainThread]: 
[0m15:46:11.753250 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:46:11.753995 [info ] [MainThread]: 
[0m15:46:11.754602 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:46:11.758239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.420773, "process_user_time": 2.665503, "process_kernel_time": 1.554456, "process_mem_max_rss": "209321984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:46:11.758986 [debug] [MainThread]: Command `dbt run` failed at 15:46:11.758863 after 6.42 seconds
[0m15:46:11.759546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1229171d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122451270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122875950>]}
[0m15:46:11.759984 [debug] [MainThread]: Flushing usage events
[0m15:53:29.323928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ee7ed0>]}


============================== 15:53:29.332091 | 0e73be54-38f0-44a8-a355-915fe5e9b1e3 ==============================
[0m15:53:29.332091 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:53:29.333385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:31.330385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e73be54-38f0-44a8-a355-915fe5e9b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120188fc0>]}
[0m15:53:31.446600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e73be54-38f0-44a8-a355-915fe5e9b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117759590>]}
[0m15:53:31.449412 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:53:31.676679 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:53:31.943909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:31.944860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:32.033456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e73be54-38f0-44a8-a355-915fe5e9b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120075850>]}
[0m15:53:32.256934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e73be54-38f0-44a8-a355-915fe5e9b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200a7980>]}
[0m15:53:32.258144 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:53:32.258808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e73be54-38f0-44a8-a355-915fe5e9b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120101470>]}
[0m15:53:32.261854 [info ] [MainThread]: 
[0m15:53:32.263282 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:32.264791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:53:32.265313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:32.650158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:53:32.651604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:32.918900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e73be54-38f0-44a8-a355-915fe5e9b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205f7790>]}
[0m15:53:32.920206 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:32.920590 [info ] [MainThread]: 
[0m15:53:32.924527 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m15:53:32.925490 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m15:53:32.926211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m15:53:32.926647 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m15:53:32.945666 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m15:53:32.947699 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m15:53:33.043827 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m15:53:33.045634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:33.049204 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_date) OVER (
            PARTITION BY venue_id, group_id, event_name, event_date, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_date, rsvp_user_id
            ORDER BY rsvp_response_date DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m15:53:33.690164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d72b2ca7-9d28-4a0f-88ff-b7c67d503fe8&page=queryresults
[0m15:53:33.830451 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]')
[0m15:53:35.263861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:62dcdfb7-9aa1-45ca-be84-eb55e85a69ad&page=queryresults
[0m15:53:35.339740 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:62dcdfb7-9aa1-45ca-be84-eb55e85a69ad&page=queryresults
[0m15:53:35.350155 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:53:35.351434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e73be54-38f0-44a8-a355-915fe5e9b1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120508950>]}
[0m15:53:35.351957 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.42s]
[0m15:53:35.352409 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m15:53:35.353982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:35.354222 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m15:53:35.354431 [info ] [MainThread]: 
[0m15:53:35.354642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m15:53:35.355112 [debug] [MainThread]: Command end result
[0m15:53:35.446045 [info ] [MainThread]: 
[0m15:53:35.446940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:53:35.447454 [info ] [MainThread]: 
[0m15:53:35.448228 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [25:13]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:53:35.448646 [info ] [MainThread]: 
[0m15:53:35.449232 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:53:35.452913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.2380996, "process_user_time": 2.55335, "process_kernel_time": 1.529126, "process_mem_max_rss": "205635584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:53:35.453854 [debug] [MainThread]: Command `dbt run` failed at 15:53:35.453636 after 6.24 seconds
[0m15:53:35.454500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12067bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12068def0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12068ff70>]}
[0m15:53:35.454947 [debug] [MainThread]: Flushing usage events
[0m15:59:52.886825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107336660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093abed0>]}


============================== 15:59:52.893942 | 1342bb08-473f-4fec-856e-76142c69e189 ==============================
[0m15:59:52.893942 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:59:52.894984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:54.846600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1342bb08-473f-4fec-856e-76142c69e189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129688fc0>]}
[0m15:59:54.940591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1342bb08-473f-4fec-856e-76142c69e189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129459590>]}
[0m15:59:54.941820 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:59:55.133502 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:59:55.377784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:55.379137 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m15:59:55.842701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1342bb08-473f-4fec-856e-76142c69e189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a2ccb50>]}
[0m15:59:56.036695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1342bb08-473f-4fec-856e-76142c69e189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1295a77a0>]}
[0m15:59:56.037639 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m15:59:56.038215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1342bb08-473f-4fec-856e-76142c69e189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a3cfe70>]}
[0m15:59:56.041187 [info ] [MainThread]: 
[0m15:59:56.041977 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:56.043378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:59:56.043937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:56.423070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:59:56.423457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.696615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1342bb08-473f-4fec-856e-76142c69e189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a45f930>]}
[0m15:59:56.697108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:56.697353 [info ] [MainThread]: 
[0m15:59:56.699884 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m15:59:56.700320 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m15:59:56.700647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m15:59:56.700896 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m15:59:56.708531 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m15:59:56.709461 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m15:59:56.784473 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m15:59:56.785997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:56.788671 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_date, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_date, rsvp_user_id
            ORDER BY rsvp_response_date DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m15:59:57.522378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:11269b82-9b51-4ee9-8a53-1095328b5f28&page=queryresults
[0m15:59:57.618688 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event_date; Did you mean event_name? at [26:58]; reason: invalidQuery, location: query, message: Unrecognized name: event_date; Did you mean event_name? at [26:58]')
[0m15:59:58.544913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7b159b3b-a0e5-4b0a-a9eb-50c1f7da0c2a&page=queryresults
[0m15:59:58.639169 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7b159b3b-a0e5-4b0a-a9eb-50c1f7da0c2a&page=queryresults
[0m15:59:58.649433 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: event_date; Did you mean event_name? at [26:58]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:59:58.650634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1342bb08-473f-4fec-856e-76142c69e189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a40a810>]}
[0m15:59:58.651114 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 1.95s]
[0m15:59:58.651540 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m15:59:58.652967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:58.653210 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m15:59:58.653420 [info ] [MainThread]: 
[0m15:59:58.653637 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m15:59:58.654548 [debug] [MainThread]: Command end result
[0m15:59:58.717433 [info ] [MainThread]: 
[0m15:59:58.718227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:58.718804 [info ] [MainThread]: 
[0m15:59:58.719450 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: event_date; Did you mean event_name? at [26:58]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m15:59:58.719943 [info ] [MainThread]: 
[0m15:59:58.720457 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:59:58.724543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.944311, "process_user_time": 2.663812, "process_kernel_time": 1.548235, "process_mem_max_rss": "208814080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:59:58.725457 [debug] [MainThread]: Command `dbt run` failed at 15:59:58.725257 after 5.95 seconds
[0m15:59:58.725980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a4231d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129651270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a375950>]}
[0m15:59:58.726519 [debug] [MainThread]: Flushing usage events
[0m16:00:42.428434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cabed0>]}


============================== 16:00:42.436475 | 4bb5e32f-33af-4875-9e44-050b9d309c14 ==============================
[0m16:00:42.436475 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:00:42.437465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:00:44.371956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb5e32f-33af-4875-9e44-050b9d309c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117188fc0>]}
[0m16:00:44.472472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb5e32f-33af-4875-9e44-050b9d309c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b59590>]}
[0m16:00:44.473895 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:00:44.683772 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:00:44.918497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:44.919962 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m16:00:45.380573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb5e32f-33af-4875-9e44-050b9d309c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174ccb50>]}
[0m16:00:45.573708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb5e32f-33af-4875-9e44-050b9d309c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116da37a0>]}
[0m16:00:45.574637 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m16:00:45.575248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb5e32f-33af-4875-9e44-050b9d309c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175cfe70>]}
[0m16:00:45.577622 [info ] [MainThread]: 
[0m16:00:45.578645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:45.579851 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:00:45.580148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:45.964172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:00:45.964568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:46.203637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb5e32f-33af-4875-9e44-050b9d309c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11765b930>]}
[0m16:00:46.204472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:46.205106 [info ] [MainThread]: 
[0m16:00:46.210045 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m16:00:46.211182 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m16:00:46.212094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m16:00:46.212692 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m16:00:46.228056 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m16:00:46.229404 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m16:00:46.305730 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m16:00:46.307491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:46.310212 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_date DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m16:00:47.083696 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:c4108d5a-d23c-409e-b14a-c3499f46ebb3&page=queryresults
[0m16:00:47.185239 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [30:22]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [30:22]')
[0m16:00:48.620510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:11503745-174c-49e9-a6cc-ecc744aee5d5&page=queryresults
[0m16:00:48.782461 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:11503745-174c-49e9-a6cc-ecc744aee5d5&page=queryresults
[0m16:00:48.792639 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [30:22]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:00:48.793895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb5e32f-33af-4875-9e44-050b9d309c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117606810>]}
[0m16:00:48.794398 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.58s]
[0m16:00:48.794879 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m16:00:48.796341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:48.796571 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m16:00:48.796818 [info ] [MainThread]: 
[0m16:00:48.797045 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m16:00:48.797515 [debug] [MainThread]: Command end result
[0m16:00:48.859526 [info ] [MainThread]: 
[0m16:00:48.860236 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:00:48.860546 [info ] [MainThread]: 
[0m16:00:48.861202 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: rsvp_response_date; Did you mean rsvp_response_time? at [30:22]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:00:48.861758 [info ] [MainThread]: 
[0m16:00:48.862276 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:00:48.866476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5418897, "process_user_time": 2.672629, "process_kernel_time": 1.54977, "process_mem_max_rss": "208224256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:00:48.867378 [debug] [MainThread]: Command `dbt run` failed at 16:00:48.867291 after 6.54 seconds
[0m16:00:48.867985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11761f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117151270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117575950>]}
[0m16:00:48.868534 [debug] [MainThread]: Flushing usage events
[0m16:01:12.008885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be7ed0>]}


============================== 16:01:12.016198 | ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e ==============================
[0m16:01:12.016198 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:01:12.017106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:13.958119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126788fc0>]}
[0m16:01:14.060327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126459590>]}
[0m16:01:14.061773 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:01:14.248588 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:01:14.488665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:01:14.489853 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m16:01:14.943045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1272ccb50>]}
[0m16:01:15.140837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266a77a0>]}
[0m16:01:15.141614 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m16:01:15.142137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274cbe70>]}
[0m16:01:15.145487 [info ] [MainThread]: 
[0m16:01:15.146359 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:01:15.148217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:01:15.148680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:15.525309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:01:15.525678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:15.775937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12755f930>]}
[0m16:01:15.776467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:01:15.776725 [info ] [MainThread]: 
[0m16:01:15.779283 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m16:01:15.779719 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m16:01:15.780064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m16:01:15.780331 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m16:01:15.794722 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m16:01:15.796183 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m16:01:15.874475 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m16:01:15.875957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:15.878326 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN final_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m16:01:16.518030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:5d14ffb6-d41d-43d0-982e-4428312a5c88&page=queryresults
[0m16:01:16.606409 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]; reason: invalidQuery, location: query, message: Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]')
[0m16:01:17.907142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1c8cfd66-b217-48ee-b754-ebd39ccc3599&page=queryresults
[0m16:01:17.993832 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1c8cfd66-b217-48ee-b754-ebd39ccc3599&page=queryresults
[0m16:01:18.004236 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:01:18.005529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba06bbea-f7b4-4f10-a4f0-9dd0ddf4f09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12750a810>]}
[0m16:01:18.006067 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.22s]
[0m16:01:18.006532 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m16:01:18.008022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:18.008273 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m16:01:18.008479 [info ] [MainThread]: 
[0m16:01:18.008692 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m16:01:18.010021 [debug] [MainThread]: Command end result
[0m16:01:18.075103 [info ] [MainThread]: 
[0m16:01:18.075855 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:01:18.076197 [info ] [MainThread]: 
[0m16:01:18.077001 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:01:18.077297 [info ] [MainThread]: 
[0m16:01:18.077740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:01:18.081617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.175516, "process_user_time": 2.656195, "process_kernel_time": 1.50291, "process_mem_max_rss": "208093184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:18.082266 [debug] [MainThread]: Command `dbt run` failed at 16:01:18.082112 after 6.18 seconds
[0m16:01:18.082684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127516990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126751270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127475950>]}
[0m16:01:18.083149 [debug] [MainThread]: Flushing usage events
[0m16:02:36.313601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102626660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebed0>]}


============================== 16:02:36.321625 | 69ea855f-b2da-4354-9acf-b984087ed69a ==============================
[0m16:02:36.321625 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:02:36.322490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:38.220024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69ea855f-b2da-4354-9acf-b984087ed69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135188fc0>]}
[0m16:02:38.320319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69ea855f-b2da-4354-9acf-b984087ed69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f59590>]}
[0m16:02:38.321729 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:02:38.539683 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:02:38.788503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:38.789949 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m16:02:39.250484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69ea855f-b2da-4354-9acf-b984087ed69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355c4b50>]}
[0m16:02:39.449533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69ea855f-b2da-4354-9acf-b984087ed69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1350a77a0>]}
[0m16:02:39.450246 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m16:02:39.450855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ea855f-b2da-4354-9acf-b984087ed69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1356cfe70>]}
[0m16:02:39.453688 [info ] [MainThread]: 
[0m16:02:39.454766 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:02:39.456141 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:02:39.456777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:39.827721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:02:39.828109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:40.082207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ea855f-b2da-4354-9acf-b984087ed69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13575f930>]}
[0m16:02:40.082699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:40.082926 [info ] [MainThread]: 
[0m16:02:40.085498 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m16:02:40.085978 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m16:02:40.086320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m16:02:40.086566 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m16:02:40.101511 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m16:02:40.103015 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m16:02:40.177964 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m16:02:40.179378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:40.182277 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, final_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m16:02:40.850185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f9533a87-79c8-424f-8d3f-7f0cc4f13817&page=queryresults
[0m16:02:40.936974 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]; reason: invalidQuery, location: query, message: Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]')
[0m16:02:41.302212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f6b65144-8144-43a7-895e-04abbef31504&page=queryresults
[0m16:02:41.448204 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f6b65144-8144-43a7-895e-04abbef31504&page=queryresults
[0m16:02:41.462368 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:02:41.464005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69ea855f-b2da-4354-9acf-b984087ed69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135706e10>]}
[0m16:02:41.464747 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 1.38s]
[0m16:02:41.465267 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m16:02:41.469307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:41.470199 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m16:02:41.470804 [info ] [MainThread]: 
[0m16:02:41.471492 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m16:02:41.472754 [debug] [MainThread]: Command end result
[0m16:02:41.538853 [info ] [MainThread]: 
[0m16:02:41.539819 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:02:41.540330 [info ] [MainThread]: 
[0m16:02:41.540942 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Unrecognized name: final_response_date; Did you mean first_response_date? at [47:31]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:02:41.541351 [info ] [MainThread]: 
[0m16:02:41.541878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:02:41.546353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.3366833, "process_user_time": 2.686072, "process_kernel_time": 1.562585, "process_mem_max_rss": "209092608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:02:41.546990 [debug] [MainThread]: Command `dbt run` failed at 16:02:41.546854 after 5.34 seconds
[0m16:02:41.547892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13571ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135151270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135675950>]}
[0m16:02:41.548507 [debug] [MainThread]: Flushing usage events
[0m16:03:13.782411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128debc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128debed0>]}


============================== 16:03:13.791208 | 589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0 ==============================
[0m16:03:13.791208 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:03:13.792085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:15.784093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149988fc0>]}
[0m16:03:15.882866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149659590>]}
[0m16:03:15.884244 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:03:16.089618 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:03:16.334867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:16.336057 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m16:03:16.797499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149dc4b50>]}
[0m16:03:16.995571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1498a77a0>]}
[0m16:03:16.996483 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m16:03:16.996951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149ecfe70>]}
[0m16:03:17.000089 [info ] [MainThread]: 
[0m16:03:17.001331 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:03:17.002594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:03:17.003163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:17.371108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:03:17.371487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:17.625480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f5b930>]}
[0m16:03:17.626017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:17.626254 [info ] [MainThread]: 
[0m16:03:17.628845 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m16:03:17.629381 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m16:03:17.630168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m16:03:17.630726 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m16:03:17.647708 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m16:03:17.648979 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m16:03:17.725650 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m16:03:17.727224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:17.730317 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id)
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m16:03:18.431743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7b8f7a8c-0254-441e-ac35-01f19dd9840b&page=queryresults
[0m16:03:18.521644 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function DATE_DIFF\n  Argument types: STRING, STRING, DATE_TIME_PART\n  Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP at [47:9]; reason: invalidQuery, location: query, message: No matching signature for function DATE_DIFF\n  Argument types: STRING, STRING, DATE_TIME_PART\n  Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)\n    Argument 1: Unable to coerce type STRING to expected type DATE\n  Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)\n    Argument 1: Unable to coerce type STRING to expected type DATETIME\n  Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)\n    Argument 1: Unable to coerce type STRING to expected type TIMESTAMP at [47:9]')
[0m16:03:19.762765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9eb1dfc2-f880-4a10-99a2-ae480df3b5b7&page=queryresults
[0m16:03:19.851963 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9eb1dfc2-f880-4a10-99a2-ae480df3b5b7&page=queryresults
[0m16:03:19.861908 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  No matching signature for function DATE_DIFF
    Argument types: STRING, STRING, DATE_TIME_PART
    Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP at [47:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:03:19.863318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '589f831d-b6f0-4abe-9b3f-f0bdec8a4bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f66810>]}
[0m16:03:19.863874 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.23s]
[0m16:03:19.864405 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m16:03:19.866053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:19.866328 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m16:03:19.866543 [info ] [MainThread]: 
[0m16:03:19.866759 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m16:03:19.867735 [debug] [MainThread]: Command end result
[0m16:03:19.931433 [info ] [MainThread]: 
[0m16:03:19.932307 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:19.932697 [info ] [MainThread]: 
[0m16:03:19.933320 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  No matching signature for function DATE_DIFF
    Argument types: STRING, STRING, DATE_TIME_PART
    Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)
      Argument 1: Unable to coerce type STRING to expected type DATE
    Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)
      Argument 1: Unable to coerce type STRING to expected type DATETIME
    Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)
      Argument 1: Unable to coerce type STRING to expected type TIMESTAMP at [47:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m16:03:19.933723 [info ] [MainThread]: 
[0m16:03:19.934128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:19.937951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.2761083, "process_user_time": 2.721501, "process_kernel_time": 1.584506, "process_mem_max_rss": "208633856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:03:19.938863 [debug] [MainThread]: Command `dbt run` failed at 16:03:19.938642 after 6.28 seconds
[0m16:03:19.939552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f1efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149951270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149e75950>]}
[0m16:03:19.939979 [debug] [MainThread]: Flushing usage events
[0m16:05:32.983084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102982660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e7ed0>]}


============================== 16:05:32.991293 | d1b8fe8b-dd6a-421a-8870-58afd0ff2ebb ==============================
[0m16:05:32.991293 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:05:32.992179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:05:35.153527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b8fe8b-dd6a-421a-8870-58afd0ff2ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113588fc0>]}
[0m16:05:35.255875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b8fe8b-dd6a-421a-8870-58afd0ff2ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113259590>]}
[0m16:05:35.257051 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:05:35.467524 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:05:35.724348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:35.725713 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m16:05:36.222020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1b8fe8b-dd6a-421a-8870-58afd0ff2ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141c8b50>]}
[0m16:05:36.465835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1b8fe8b-dd6a-421a-8870-58afd0ff2ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133a77a0>]}
[0m16:05:36.467012 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m16:05:36.467664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b8fe8b-dd6a-421a-8870-58afd0ff2ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143cbe70>]}
[0m16:05:36.470338 [info ] [MainThread]: 
[0m16:05:36.471309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:05:36.472955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:05:36.474032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:36.864227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:05:36.864718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:37.134522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b8fe8b-dd6a-421a-8870-58afd0ff2ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11445b930>]}
[0m16:05:37.135054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:37.135304 [info ] [MainThread]: 
[0m16:05:37.137957 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m16:05:37.138398 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m16:05:37.138727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m16:05:37.138994 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m16:05:37.154403 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m16:05:37.155927 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m16:05:37.236000 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m16:05:37.237600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:37.240653 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

staging AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed
FROM staging
    );
  
[0m16:05:37.910866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:69421a16-b565-4eeb-a5eb-7306854b72c2&page=queryresults
[0m16:05:42.513552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b8fe8b-dd6a-421a-8870-58afd0ff2ebb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440e450>]}
[0m16:05:42.514124 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events_users_rsvp .... [[32mCREATE TABLE (174.0k rows, 16.9 MiB processed)[0m in 5.37s]
[0m16:05:42.514665 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m16:05:42.515744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:42.515955 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m16:05:42.516242 [info ] [MainThread]: 
[0m16:05:42.516751 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.05 seconds (6.05s).
[0m16:05:42.517960 [debug] [MainThread]: Command end result
[0m16:05:42.579188 [info ] [MainThread]: 
[0m16:05:42.580073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:42.580541 [info ] [MainThread]: 
[0m16:05:42.580962 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:42.584586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.7117, "process_user_time": 2.773651, "process_kernel_time": 1.649939, "process_mem_max_rss": "209174528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:05:42.585493 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:42.585356 after 9.71 seconds
[0m16:05:42.585879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11441b120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113551270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114375950>]}
[0m16:05:42.586482 [debug] [MainThread]: Flushing usage events
[0m16:18:00.210414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104636660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066abed0>]}


============================== 16:18:00.219389 | 44dafd4f-c94f-4137-aec3-23f9e0e9ef08 ==============================
[0m16:18:00.219389 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:18:00.220504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:02.166581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44dafd4f-c94f-4137-aec3-23f9e0e9ef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da88fc0>]}
[0m16:18:02.264722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44dafd4f-c94f-4137-aec3-23f9e0e9ef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d759590>]}
[0m16:18:02.265858 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:18:02.459612 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:18:02.697239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:18:02.698638 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m16:18:03.158558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44dafd4f-c94f-4137-aec3-23f9e0e9ef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10decc850>]}
[0m16:18:03.352508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44dafd4f-c94f-4137-aec3-23f9e0e9ef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a77a0>]}
[0m16:18:03.353427 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m16:18:03.353925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44dafd4f-c94f-4137-aec3-23f9e0e9ef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfcbe70>]}
[0m16:18:03.357200 [info ] [MainThread]: 
[0m16:18:03.358230 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:18:03.359578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:18:03.360580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:03.747561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:18:03.747930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:04.020357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44dafd4f-c94f-4137-aec3-23f9e0e9ef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e05f930>]}
[0m16:18:04.020832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:18:04.021097 [info ] [MainThread]: 
[0m16:18:04.023692 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m16:18:04.024138 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m16:18:04.024470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m16:18:04.024718 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m16:18:04.036807 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m16:18:04.038375 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m16:18:04.066488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:04.402129 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m16:18:04.403847 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT 
        venue_id,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        group_id,
        name AS event_name,
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT 
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.event_description,
        e.rsvp_total_limit,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    event_description,
    rsvp_total_limit,
    rsvp_user_id
    rsvp_response,
    rsvp_response_time,
    rsvp_guests,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m16:18:04.908317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0b17d5f0-685a-45b8-958e-fcec9c450659&page=queryresults
[0m16:18:05.004158 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsvp_user_id at [74:5]; reason: invalidQuery, location: query, message: Unrecognized name: rsvp_user_id at [74:5]')
[0m16:18:05.639140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:72156041-d1ba-43cd-9eb5-c58a55a47440&page=queryresults
[0m16:18:05.807061 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:72156041-d1ba-43cd-9eb5-c58a55a47440&page=queryresults
[0m16:18:05.819597 [debug] [Thread-1 (]: Database Error in model stg_events (models/Staging/stg_events.sql)
  Unrecognized name: rsvp_user_id at [74:5]
  compiled code at target/run/keira_project/models/Staging/stg_events.sql
[0m16:18:05.820860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44dafd4f-c94f-4137-aec3-23f9e0e9ef08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e002ed0>]}
[0m16:18:05.821354 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events ................. [[31mERROR[0m in 1.80s]
[0m16:18:05.821785 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m16:18:05.823298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:05.823550 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m16:18:05.823759 [info ] [MainThread]: 
[0m16:18:05.823983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m16:18:05.824454 [debug] [MainThread]: Command end result
[0m16:18:05.888364 [info ] [MainThread]: 
[0m16:18:05.889284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:18:05.889688 [info ] [MainThread]: 
[0m16:18:05.890325 [error] [MainThread]:   Database Error in model stg_events (models/Staging/stg_events.sql)
  Unrecognized name: rsvp_user_id at [74:5]
  compiled code at target/run/keira_project/models/Staging/stg_events.sql
[0m16:18:05.890775 [info ] [MainThread]: 
[0m16:18:05.891313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:18:05.894688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7917643, "process_user_time": 2.654535, "process_kernel_time": 1.540776, "process_mem_max_rss": "209027072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:18:05.895484 [debug] [MainThread]: Command `dbt run` failed at 16:18:05.895338 after 5.79 seconds
[0m16:18:05.896247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e01edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da35270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df75950>]}
[0m16:18:05.896820 [debug] [MainThread]: Flushing usage events
[0m16:18:50.403794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7ed0>]}


============================== 16:18:50.412221 | 2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1 ==============================
[0m16:18:50.412221 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:18:50.413444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:52.322527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf88fc0>]}
[0m16:18:52.422533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd59590>]}
[0m16:18:52.423900 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:18:52.634284 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:18:52.867832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:18:52.869053 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m16:18:53.328529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbc4b50>]}
[0m16:18:53.523026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea77a0>]}
[0m16:18:53.523956 [info ] [MainThread]: Found 7 models, 4 data tests, 4 sources, 484 macros
[0m16:18:53.524605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcfe70>]}
[0m16:18:53.527319 [info ] [MainThread]: 
[0m16:18:53.528077 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:18:53.529486 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:18:53.530119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:53.897892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:18:53.898284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:54.169590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5f930>]}
[0m16:18:54.170100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:18:54.170335 [info ] [MainThread]: 
[0m16:18:54.172906 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m16:18:54.173335 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m16:18:54.173682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m16:18:54.173957 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m16:18:54.181892 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m16:18:54.182575 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m16:18:54.209978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:54.532411 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m16:18:54.534193 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT 
        venue_id,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        group_id,
        name AS event_name,
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT 
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.event_description,
        e.rsvp_total_limit,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m16:18:54.982700 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:65518a17-cdd8-4e51-83cb-0c43315aefe4&page=queryresults
[0m16:18:57.662545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b88adf8-8fc5-4b0c-8cd2-3279ff76c0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de05fd0>]}
[0m16:18:57.664069 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events ..................... [[32mCREATE TABLE (6.2k rows, 7.4 MiB processed)[0m in 3.49s]
[0m16:18:57.665259 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m16:18:57.667728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:57.668350 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m16:18:57.668838 [info ] [MainThread]: 
[0m16:18:57.669298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m16:18:57.670264 [debug] [MainThread]: Command end result
[0m16:18:57.733705 [info ] [MainThread]: 
[0m16:18:57.734657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:18:57.735104 [info ] [MainThread]: 
[0m16:18:57.735558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:18:57.739555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4418025, "process_user_time": 2.683556, "process_kernel_time": 1.547204, "process_mem_max_rss": "208650240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:18:57.740467 [debug] [MainThread]: Command `dbt run` succeeded at 16:18:57.740254 after 7.44 seconds
[0m16:18:57.740995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de1ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf51270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd75950>]}
[0m16:18:57.741460 [debug] [MainThread]: Flushing usage events
[0m16:24:51.651074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c0e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7ed0>]}


============================== 16:24:51.659608 | 81550e9e-99ab-4fcc-9511-23f6e8b8a3a6 ==============================
[0m16:24:51.659608 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:24:51.660497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_users_groups', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:53.664379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81550e9e-99ab-4fcc-9511-23f6e8b8a3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114088fc0>]}
[0m16:24:53.761840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81550e9e-99ab-4fcc-9511-23f6e8b8a3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113559590>]}
[0m16:24:53.763038 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:24:53.991454 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:24:54.240934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:24:54.241911 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_users_groups.sql
[0m16:24:54.701565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81550e9e-99ab-4fcc-9511-23f6e8b8a3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177dcb50>]}
[0m16:24:54.900321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81550e9e-99ab-4fcc-9511-23f6e8b8a3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a77a0>]}
[0m16:24:54.901153 [info ] [MainThread]: Found 8 models, 4 data tests, 4 sources, 484 macros
[0m16:24:54.901677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81550e9e-99ab-4fcc-9511-23f6e8b8a3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178dfe70>]}
[0m16:24:54.904773 [info ] [MainThread]: 
[0m16:24:54.905806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:24:54.907160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:24:54.907600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:55.288777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:24:55.289146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:55.532481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81550e9e-99ab-4fcc-9511-23f6e8b8a3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b5f930>]}
[0m16:24:55.532993 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:24:55.533239 [info ] [MainThread]: 
[0m16:24:55.535760 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users_groups
[0m16:24:55.536191 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users_groups .................... [RUN]
[0m16:24:55.536518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users_groups)
[0m16:24:55.536790 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users_groups
[0m16:24:55.553595 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m16:24:55.555247 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users_groups
[0m16:24:55.633027 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m16:24:55.635211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:55.638060 [debug] [Thread-1 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH groups AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        EXTRACT(YEAR FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_year, 
        EXTRACT(MONTH FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_month
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM groups
    );
  
[0m16:24:56.146795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:496d5db9-646f-4e71-869c-29260b7f1659&page=queryresults
[0m16:24:56.147358 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword GROUPS at [15:6]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword GROUPS at [15:6]')
[0m16:24:56.863981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:9f1e5c0a-c942-4558-a68a-037a51afbf5a&page=queryresults
[0m16:24:56.864648 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:9f1e5c0a-c942-4558-a68a-037a51afbf5a&page=queryresults
[0m16:24:56.878135 [debug] [Thread-1 (]: Database Error in model stg_users_groups (models/Staging/stg_users_groups.sql)
  Syntax error: Unexpected keyword GROUPS at [15:6]
  compiled code at target/run/keira_project/models/Staging/stg_users_groups.sql
[0m16:24:56.879770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81550e9e-99ab-4fcc-9511-23f6e8b8a3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b6ea50>]}
[0m16:24:56.887390 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_users_groups ........... [[31mERROR[0m in 1.34s]
[0m16:24:56.889841 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users_groups
[0m16:24:56.904681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:56.904959 [debug] [MainThread]: Connection 'model.keira_project.stg_users_groups' was properly closed.
[0m16:24:56.905182 [info ] [MainThread]: 
[0m16:24:56.905775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m16:24:56.907197 [debug] [MainThread]: Command end result
[0m16:24:56.977373 [info ] [MainThread]: 
[0m16:24:56.978706 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:24:56.979447 [info ] [MainThread]: 
[0m16:24:56.980423 [error] [MainThread]:   Database Error in model stg_users_groups (models/Staging/stg_users_groups.sql)
  Syntax error: Unexpected keyword GROUPS at [15:6]
  compiled code at target/run/keira_project/models/Staging/stg_users_groups.sql
[0m16:24:56.980970 [info ] [MainThread]: 
[0m16:24:56.981409 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:24:56.985375 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4415154, "process_user_time": 2.701578, "process_kernel_time": 1.614287, "process_mem_max_rss": "207568896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:24:56.986121 [debug] [MainThread]: Command `dbt run` failed at 16:24:56.986005 after 5.44 seconds
[0m16:24:56.986673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b1ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114069590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11406a3f0>]}
[0m16:24:56.987025 [debug] [MainThread]: Flushing usage events
[0m16:35:12.688949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105436660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e7ed0>]}


============================== 16:35:12.697069 | 69f6b111-6932-4498-a696-d427d6ec1300 ==============================
[0m16:35:12.697069 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:35:12.698253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_users_groups', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:14.742306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69f6b111-6932-4498-a696-d427d6ec1300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132c88fc0>]}
[0m16:35:14.842207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69f6b111-6932-4498-a696-d427d6ec1300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132959590>]}
[0m16:35:14.843304 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:35:15.045790 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:35:15.288612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:15.289981 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_users_groups.sql
[0m16:35:15.762084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69f6b111-6932-4498-a696-d427d6ec1300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1330d9050>]}
[0m16:35:15.958152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69f6b111-6932-4498-a696-d427d6ec1300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132ba7b60>]}
[0m16:35:15.958861 [info ] [MainThread]: Found 8 models, 4 data tests, 4 sources, 484 macros
[0m16:35:15.959319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f6b111-6932-4498-a696-d427d6ec1300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13339c050>]}
[0m16:35:15.962489 [info ] [MainThread]: 
[0m16:35:15.963552 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:15.964897 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:35:15.965729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:16.349540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:35:16.349905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:16.647876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f6b111-6932-4498-a696-d427d6ec1300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133363930>]}
[0m16:35:16.648352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:16.648571 [info ] [MainThread]: 
[0m16:35:16.651166 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users_groups
[0m16:35:16.651581 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users_groups .................... [RUN]
[0m16:35:16.651904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users_groups)
[0m16:35:16.652150 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users_groups
[0m16:35:16.659739 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m16:35:16.660633 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users_groups
[0m16:35:16.733174 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m16:35:16.734699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:16.737319 [debug] [Thread-1 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        EXTRACT(YEAR FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_year, 
        EXTRACT(MONTH FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_month
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM usergroup
    );
  
[0m16:35:17.816969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:4a1636c7-abf7-4b29-9bd1-334978a407dc&page=queryresults
[0m16:35:20.594996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f6b111-6932-4498-a696-d427d6ec1300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13336e450>]}
[0m16:35:20.595562 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_users_groups ............... [[32mCREATE TABLE (145.5k rows, 4.5 MiB processed)[0m in 3.94s]
[0m16:35:20.596021 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users_groups
[0m16:35:20.597009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:20.597363 [debug] [MainThread]: Connection 'model.keira_project.stg_users_groups' was properly closed.
[0m16:35:20.597943 [info ] [MainThread]: 
[0m16:35:20.598466 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m16:35:20.599756 [debug] [MainThread]: Command end result
[0m16:35:20.662904 [info ] [MainThread]: 
[0m16:35:20.663970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:20.664380 [info ] [MainThread]: 
[0m16:35:20.664894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:20.669127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.086877, "process_user_time": 2.687221, "process_kernel_time": 1.562431, "process_mem_max_rss": "208945152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:20.670176 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:20.670012 after 8.09 seconds
[0m16:35:20.670781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132fd6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132c68ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132c69770>]}
[0m16:35:20.671345 [debug] [MainThread]: Flushing usage events
[0m16:38:28.178216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10286a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cbed0>]}


============================== 16:38:28.185958 | 409384c0-7db3-4133-b6de-9b36efa5bf95 ==============================
[0m16:38:28.185958 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:38:28.186899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_users', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:30.478516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '409384c0-7db3-4133-b6de-9b36efa5bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d4fc0>]}
[0m16:38:30.587286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '409384c0-7db3-4133-b6de-9b36efa5bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a5590>]}
[0m16:38:30.588941 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:38:30.826494 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:38:31.071157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:31.072192 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_users.sql
[0m16:38:31.541527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '409384c0-7db3-4133-b6de-9b36efa5bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a808e50>]}
[0m16:38:31.744315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '409384c0-7db3-4133-b6de-9b36efa5bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f3b60>]}
[0m16:38:31.745835 [info ] [MainThread]: Found 8 models, 4 data tests, 4 sources, 484 macros
[0m16:38:31.746446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409384c0-7db3-4133-b6de-9b36efa5bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e0050>]}
[0m16:38:31.749615 [info ] [MainThread]: 
[0m16:38:31.751070 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:31.752650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:38:31.753160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:32.113510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:38:32.113971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:32.406072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409384c0-7db3-4133-b6de-9b36efa5bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ab930>]}
[0m16:38:32.406711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:32.407056 [info ] [MainThread]: 
[0m16:38:32.410066 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m16:38:32.410773 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users ........................... [RUN]
[0m16:38:32.411349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users)
[0m16:38:32.411786 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m16:38:32.421047 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m16:38:32.422221 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m16:38:32.454403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:32.802011 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m16:38:32.803026 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown,
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM users
    );
  
[0m16:38:33.194890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d4773456-9c60-4b24-9481-352bcac60426&page=queryresults
[0m16:38:35.872810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409384c0-7db3-4133-b6de-9b36efa5bf95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b9550>]}
[0m16:38:35.873438 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_users ...................... [[32mCREATE TABLE (145.5k rows, 5.4 MiB processed)[0m in 3.46s]
[0m16:38:35.873916 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m16:38:35.875084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:35.875313 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m16:38:35.875516 [info ] [MainThread]: 
[0m16:38:35.875736 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m16:38:35.876259 [debug] [MainThread]: Command end result
[0m16:38:35.939518 [info ] [MainThread]: 
[0m16:38:35.940540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:35.940946 [info ] [MainThread]: 
[0m16:38:35.941522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:38:35.945901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8757644, "process_user_time": 2.782395, "process_kernel_time": 1.589815, "process_mem_max_rss": "209371136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:35.946747 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:35.946630 after 7.88 seconds
[0m16:38:35.947407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a722db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b4ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b5770>]}
[0m16:38:35.947879 [debug] [MainThread]: Flushing usage events
[0m16:38:48.868268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ee7ed0>]}


============================== 16:38:48.875299 | 6e1777b2-521f-4d8e-ac45-a287cccd2cf3 ==============================
[0m16:38:48.875299 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:38:48.876122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_users', 'send_anonymous_usage_stats': 'True'}
[0m16:38:50.571164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e1777b2-521f-4d8e-ac45-a287cccd2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b88fc0>]}
[0m16:38:50.670372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e1777b2-521f-4d8e-ac45-a287cccd2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149959590>]}
[0m16:38:50.671618 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:38:50.877433 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:38:51.111070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:51.112366 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_users.sql
[0m16:38:51.566058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e1777b2-521f-4d8e-ac45-a287cccd2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149ebd050>]}
[0m16:38:51.756232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e1777b2-521f-4d8e-ac45-a287cccd2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149aa3b60>]}
[0m16:38:51.757145 [info ] [MainThread]: Found 8 models, 4 data tests, 4 sources, 484 macros
[0m16:38:51.757639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1777b2-521f-4d8e-ac45-a287cccd2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a194050>]}
[0m16:38:51.760614 [info ] [MainThread]: 
[0m16:38:51.761383 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:51.762622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m16:38:51.763330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:52.123172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m16:38:52.123550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:52.395211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1777b2-521f-4d8e-ac45-a287cccd2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a15f930>]}
[0m16:38:52.395711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:52.395936 [info ] [MainThread]: 
[0m16:38:52.397759 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m16:38:52.398209 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users ........................... [RUN]
[0m16:38:52.398550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users)
[0m16:38:52.398802 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m16:38:52.406558 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m16:38:52.407360 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m16:38:52.433201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:52.775490 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m16:38:52.776894 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown
    FROM `keira-xebia`.`meetupservice`.`source_users`   
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM users
    );
  
[0m16:38:53.265164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9ef90b17-46c2-4bc1-b29d-e7a59af22ae9&page=queryresults
[0m16:38:55.942838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e1777b2-521f-4d8e-ac45-a287cccd2cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a16a390>]}
[0m16:38:55.943457 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_users ...................... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.54s]
[0m16:38:55.944232 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m16:38:55.946303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:55.946815 [debug] [MainThread]: Connection 'model.keira_project.stg_users' was properly closed.
[0m16:38:55.947110 [info ] [MainThread]: 
[0m16:38:55.947440 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m16:38:55.948884 [debug] [MainThread]: Command end result
[0m16:38:56.009694 [info ] [MainThread]: 
[0m16:38:56.010531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:56.011078 [info ] [MainThread]: 
[0m16:38:56.011853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:38:56.015485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.254659, "process_user_time": 2.697067, "process_kernel_time": 1.457628, "process_mem_max_rss": "209305600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:56.016337 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:56.016125 after 7.26 seconds
[0m16:38:56.016903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149dd2e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b68ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b69770>]}
[0m16:38:56.017351 [debug] [MainThread]: Flushing usage events
[0m17:18:18.823084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ffc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ffed0>]}


============================== 17:18:18.831197 | 30ce1548-95a6-4565-b01e-90d14007f2f0 ==============================
[0m17:18:18.831197 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:18:18.832379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_venues', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:18:20.792511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30ce1548-95a6-4565-b01e-90d14007f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe88fc0>]}
[0m17:18:20.886185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30ce1548-95a6-4565-b01e-90d14007f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb59590>]}
[0m17:18:20.887728 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:18:21.078996 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:18:21.326324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:18:21.327761 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certitifed_events.sql
[0m17:18:21.328377 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_venues.sql
[0m17:18:21.801376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30ce1548-95a6-4565-b01e-90d14007f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4e4150>]}
[0m17:18:22.008053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30ce1548-95a6-4565-b01e-90d14007f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fca7b60>]}
[0m17:18:22.009116 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m17:18:22.009713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30ce1548-95a6-4565-b01e-90d14007f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6ac670>]}
[0m17:18:22.012866 [info ] [MainThread]: 
[0m17:18:22.013933 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:18:22.015684 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m17:18:22.016523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:22.403476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m17:18:22.403886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:22.675065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30ce1548-95a6-4565-b01e-90d14007f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b59b520>]}
[0m17:18:22.675786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:18:22.676122 [info ] [MainThread]: 
[0m17:18:22.678927 [debug] [Thread-1 (]: Began running node model.keira_project.stg_venues
[0m17:18:22.679377 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_venues .......................... [RUN]
[0m17:18:22.679724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_venues)
[0m17:18:22.679972 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_venues
[0m17:18:22.696939 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_venues"
[0m17:18:22.698741 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_venues
[0m17:18:22.780328 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_venues"
[0m17:18:22.783035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:22.785915 [debug] [Thread-1 (]: On model.keira_project.stg_venues: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_venues"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_venues`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    venue_id,
    name AS venue_name,
    city AS venue_city,
    country AS venue_country,
    lat AS venue_lat,
    lon AS venue_lon
FROM `keira-xebia`.`meetupservice`.`source_venues`
    );
  
[0m17:18:23.967917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:5648ee5b-1feb-402d-bb38-5ef3938a220b&page=queryresults
[0m17:18:26.621981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30ce1548-95a6-4565-b01e-90d14007f2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b61a5d0>]}
[0m17:18:26.623382 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_venues ..................... [[32mCREATE TABLE (1.7k rows, 97.0 KiB processed)[0m in 3.94s]
[0m17:18:26.623935 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_venues
[0m17:18:26.625051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:26.625286 [debug] [MainThread]: Connection 'model.keira_project.stg_venues' was properly closed.
[0m17:18:26.625504 [info ] [MainThread]: 
[0m17:18:26.625723 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m17:18:26.626282 [debug] [MainThread]: Command end result
[0m17:18:26.685878 [info ] [MainThread]: 
[0m17:18:26.686957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:26.687405 [info ] [MainThread]: 
[0m17:18:26.687998 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:18:26.691834 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9775453, "process_user_time": 2.685061, "process_kernel_time": 1.560708, "process_mem_max_rss": "207716352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:18:26.692644 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:26.692532 after 7.98 seconds
[0m17:18:26.693096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b637d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe69130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe68ff0>]}
[0m17:18:26.693579 [debug] [MainThread]: Flushing usage events
[0m17:36:57.145218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7ed0>]}


============================== 17:36:57.153570 | 549a678e-f0f0-4e36-b7ac-57bde95cfe43 ==============================
[0m17:36:57.153570 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:36:57.154404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:59.227655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '549a678e-f0f0-4e36-b7ac-57bde95cfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126288fc0>]}
[0m17:36:59.321481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '549a678e-f0f0-4e36-b7ac-57bde95cfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125759590>]}
[0m17:36:59.322867 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:36:59.496196 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:36:59.750444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:59.751460 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m17:37:00.220298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '549a678e-f0f0-4e36-b7ac-57bde95cfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266c8350>]}
[0m17:37:00.414430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '549a678e-f0f0-4e36-b7ac-57bde95cfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261a7b60>]}
[0m17:37:00.415269 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m17:37:00.415969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549a678e-f0f0-4e36-b7ac-57bde95cfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268a0590>]}
[0m17:37:00.419191 [info ] [MainThread]: 
[0m17:37:00.420264 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:37:00.421606 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m17:37:00.422113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:00.821465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m17:37:00.821831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:01.086609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549a678e-f0f0-4e36-b7ac-57bde95cfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12686b930>]}
[0m17:37:01.087140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:37:01.087385 [info ] [MainThread]: 
[0m17:37:01.090015 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m17:37:01.090452 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m17:37:01.090854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m17:37:01.091143 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m17:37:01.098965 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m17:37:01.099910 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m17:37:01.127468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:01.441475 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m17:37:01.442833 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.final_response_duration,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.venue_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN stg_users u 
    ON f.rsvp_user_id = u.user_id
    JOIN  stg_venues v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m17:37:01.617426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:b9d07641-09e0-4122-b723-08a900b4e457&page=queryresults
[0m17:37:01.617996 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg_users" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg_users, message: Table "stg_users" must be qualified with a dataset (e.g. dataset.table).')
[0m17:37:02.753204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:6728fcec-0d7b-4211-9c95-c15a08fbb6e1&page=queryresults
[0m17:37:02.753819 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:6728fcec-0d7b-4211-9c95-c15a08fbb6e1&page=queryresults
[0m17:37:02.763584 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Table "stg_users" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m17:37:02.764907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549a678e-f0f0-4e36-b7ac-57bde95cfe43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12681e750>]}
[0m17:37:02.765419 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 1.67s]
[0m17:37:02.765867 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m17:37:02.767412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:02.767645 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m17:37:02.767842 [info ] [MainThread]: 
[0m17:37:02.768053 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m17:37:02.768570 [debug] [MainThread]: Command end result
[0m17:37:02.827274 [info ] [MainThread]: 
[0m17:37:02.828146 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:02.828592 [info ] [MainThread]: 
[0m17:37:02.829327 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Table "stg_users" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m17:37:02.829786 [info ] [MainThread]: 
[0m17:37:02.830213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:37:02.834621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7950068, "process_user_time": 2.690174, "process_kernel_time": 1.533749, "process_mem_max_rss": "208830464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:37:02.835509 [debug] [MainThread]: Command `dbt run` failed at 17:37:02.835271 after 5.80 seconds
[0m17:37:02.835953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126836a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262698b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126269590>]}
[0m17:37:02.836670 [debug] [MainThread]: Flushing usage events
[0m17:37:53.435739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105436660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e7ed0>]}


============================== 17:37:53.444615 | cde5f844-55d8-4809-a5f4-08e9d7eff09f ==============================
[0m17:37:53.444615 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:37:53.445657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:55.357450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cde5f844-55d8-4809-a5f4-08e9d7eff09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef88fc0>]}
[0m17:37:55.462194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cde5f844-55d8-4809-a5f4-08e9d7eff09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb59590>]}
[0m17:37:55.463428 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:37:55.678611 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:37:55.913798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:55.915198 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m17:37:56.368079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cde5f844-55d8-4809-a5f4-08e9d7eff09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbc8250>]}
[0m17:37:56.564019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cde5f844-55d8-4809-a5f4-08e9d7eff09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eea7b60>]}
[0m17:37:56.565055 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m17:37:56.565647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cde5f844-55d8-4809-a5f4-08e9d7eff09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd94590>]}
[0m17:37:56.568987 [info ] [MainThread]: 
[0m17:37:56.569892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:37:56.571263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m17:37:56.571909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:56.932884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m17:37:56.933245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:57.176168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cde5f844-55d8-4809-a5f4-08e9d7eff09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd63930>]}
[0m17:37:57.176637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:37:57.176859 [info ] [MainThread]: 
[0m17:37:57.180988 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m17:37:57.181884 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m17:37:57.182607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m17:37:57.183183 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m17:37:57.201229 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m17:37:57.202452 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m17:37:57.230159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:57.548586 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m17:37:57.550596 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.final_response_duration,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.venue_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m17:37:58.074689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:c7cc6ec2-944a-4f73-8dbb-b8de4198ef8b&page=queryresults
[0m17:37:58.172351 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name venue_city not found inside u at [70:73]; reason: invalidQuery, location: query, message: Name venue_city not found inside u at [70:73]')
[0m17:37:59.527087 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:5d70ba38-b5ac-4e43-a2ff-2dde35f8ab94&page=queryresults
[0m17:37:59.609679 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:5d70ba38-b5ac-4e43-a2ff-2dde35f8ab94&page=queryresults
[0m17:37:59.620346 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Name venue_city not found inside u at [70:73]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m17:37:59.621740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde5f844-55d8-4809-a5f4-08e9d7eff09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faeabd0>]}
[0m17:37:59.622273 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.44s]
[0m17:37:59.622719 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m17:37:59.624253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:59.624477 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m17:37:59.624679 [info ] [MainThread]: 
[0m17:37:59.624890 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m17:37:59.625345 [debug] [MainThread]: Command end result
[0m17:37:59.692399 [info ] [MainThread]: 
[0m17:37:59.693264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:37:59.693859 [info ] [MainThread]: 
[0m17:37:59.694575 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  Name venue_city not found inside u at [70:73]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m17:37:59.695124 [info ] [MainThread]: 
[0m17:37:59.695656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:37:59.699439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3690324, "process_user_time": 2.67843, "process_kernel_time": 1.557324, "process_mem_max_rss": "208437248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:37:59.700150 [debug] [MainThread]: Command `dbt run` failed at 17:37:59.700076 after 6.37 seconds
[0m17:37:59.700853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd26af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef37c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef36cb0>]}
[0m17:37:59.701867 [debug] [MainThread]: Flushing usage events
[0m17:38:36.494918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eabed0>]}


============================== 17:38:36.504127 | eacae0be-b2c5-451e-8a1d-0ca9efaedcdb ==============================
[0m17:38:36.504127 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:38:36.504968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:38.724765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eacae0be-b2c5-451e-8a1d-0ca9efaedcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f488fc0>]}
[0m17:38:38.829095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eacae0be-b2c5-451e-8a1d-0ca9efaedcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e559590>]}
[0m17:38:38.830430 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:38:39.025704 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:38:39.302106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:39.303449 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m17:38:39.799852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eacae0be-b2c5-451e-8a1d-0ca9efaedcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ad050>]}
[0m17:38:39.998651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eacae0be-b2c5-451e-8a1d-0ca9efaedcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a7980>]}
[0m17:38:39.999622 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m17:38:40.000155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacae0be-b2c5-451e-8a1d-0ca9efaedcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119198590>]}
[0m17:38:40.003122 [info ] [MainThread]: 
[0m17:38:40.004117 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:40.005222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m17:38:40.006047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:40.365046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m17:38:40.365420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:40.618807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eacae0be-b2c5-451e-8a1d-0ca9efaedcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11915f930>]}
[0m17:38:40.620091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:40.620637 [info ] [MainThread]: 
[0m17:38:40.626278 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m17:38:40.627404 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m17:38:40.628334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m17:38:40.629054 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m17:38:40.650901 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m17:38:40.652449 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m17:38:40.685520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:41.013508 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m17:38:41.015148 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.final_response_duration,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    final_response_duration,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m17:38:41.488274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d4f3bc1b-a672-4cca-b418-88b2b7f542f8&page=queryresults
[0m17:38:45.591126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eacae0be-b2c5-451e-8a1d-0ca9efaedcdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e6510>]}
[0m17:38:45.591747 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events_users_rsvp .... [[32mCREATE TABLE (174.0k rows, 18.2 MiB processed)[0m in 4.96s]
[0m17:38:45.592324 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m17:38:45.594393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:45.594933 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m17:38:45.595441 [info ] [MainThread]: 
[0m17:38:45.595865 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m17:38:45.597055 [debug] [MainThread]: Command end result
[0m17:38:45.661384 [info ] [MainThread]: 
[0m17:38:45.662047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:45.662865 [info ] [MainThread]: 
[0m17:38:45.663476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:38:45.667257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.29745, "process_user_time": 2.861693, "process_kernel_time": 1.702582, "process_mem_max_rss": "208027648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:38:45.668156 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:45.668010 after 9.30 seconds
[0m17:38:45.668832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f453110>]}
[0m17:38:45.669483 [debug] [MainThread]: Flushing usage events
[0m18:15:40.274443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104debc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104debed0>]}


============================== 18:15:40.283010 | e256893c-38ba-4872-a403-2212e18991e4 ==============================
[0m18:15:40.283010 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:40.283864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'send_anonymous_usage_stats': 'True'}
[0m18:15:42.516376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e256893c-38ba-4872-a403-2212e18991e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b888fc0>]}
[0m18:15:42.621189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e256893c-38ba-4872-a403-2212e18991e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b559590>]}
[0m18:15:42.622762 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:15:42.827876 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:15:43.109123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:15:43.110498 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m18:15:43.642015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e256893c-38ba-4872-a403-2212e18991e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccd050>]}
[0m18:15:43.885659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e256893c-38ba-4872-a403-2212e18991e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7a7980>]}
[0m18:15:43.886802 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:15:43.887173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e256893c-38ba-4872-a403-2212e18991e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf9c590>]}
[0m18:15:43.890595 [info ] [MainThread]: 
[0m18:15:43.891605 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:15:43.893503 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:15:43.894150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:44.262308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:15:44.262734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:44.531057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e256893c-38ba-4872-a403-2212e18991e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf5f930>]}
[0m18:15:44.531599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:44.531841 [info ] [MainThread]: 
[0m18:15:44.534444 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m18:15:44.534887 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m18:15:44.535222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m18:15:44.535469 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m18:15:44.551838 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m18:15:44.553387 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m18:15:44.583956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:44.930085 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m18:15:44.931758 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date) AS first_response_duration,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_duration,
        f.final_response_duration,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_duration,
    final_response_duration,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m18:15:45.411858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:8de2d8a5-d151-4510-891b-a7aff7978774&page=queryresults
[0m18:15:45.504138 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function DATE_DIFF\n  Argument types: DATE, DATE\n  Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)\n    Signature requires at least 3 arguments, found 2 arguments\n  Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)\n    Signature requires at least 3 arguments, found 2 arguments\n  Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)\n    Signature requires at least 3 arguments, found 2 arguments at [47:9]; reason: invalidQuery, location: query, message: No matching signature for function DATE_DIFF\n  Argument types: DATE, DATE\n  Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)\n    Signature requires at least 3 arguments, found 2 arguments\n  Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)\n    Signature requires at least 3 arguments, found 2 arguments\n  Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)\n    Signature requires at least 3 arguments, found 2 arguments at [47:9]')
[0m18:15:46.436399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:18e14867-aec6-4ef1-91e6-a265629ba63e&page=queryresults
[0m18:15:46.522910 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:18e14867-aec6-4ef1-91e6-a265629ba63e&page=queryresults
[0m18:15:46.534982 [debug] [Thread-1 (]: Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  No matching signature for function DATE_DIFF
    Argument types: DATE, DATE
    Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)
      Signature requires at least 3 arguments, found 2 arguments
    Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)
      Signature requires at least 3 arguments, found 2 arguments
    Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)
      Signature requires at least 3 arguments, found 2 arguments at [47:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m18:15:46.536544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e256893c-38ba-4872-a403-2212e18991e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf22b10>]}
[0m18:15:46.537136 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events_users_rsvp  [[31mERROR[0m in 2.00s]
[0m18:15:46.537648 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m18:15:46.539307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:46.539553 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m18:15:46.539764 [info ] [MainThread]: 
[0m18:15:46.539985 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m18:15:46.540480 [debug] [MainThread]: Command end result
[0m18:15:46.615635 [info ] [MainThread]: 
[0m18:15:46.616798 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:15:46.617450 [info ] [MainThread]: 
[0m18:15:46.618416 [error] [MainThread]:   Database Error in model certified_events_users_rsvp (models/Certified/certified_events_users_rsvp.sql)
  No matching signature for function DATE_DIFF
    Argument types: DATE, DATE
    Signature: DATE_DIFF(DATE, DATE, DATE_TIME_PART)
      Signature requires at least 3 arguments, found 2 arguments
    Signature: DATE_DIFF(DATETIME, DATETIME, DATE_TIME_PART)
      Signature requires at least 3 arguments, found 2 arguments
    Signature: DATE_DIFF(TIMESTAMP, TIMESTAMP, DATE_TIME_PART)
      Signature requires at least 3 arguments, found 2 arguments at [47:9]
  compiled code at target/run/keira_project/models/Certified/certified_events_users_rsvp.sql
[0m18:15:46.619144 [info ] [MainThread]: 
[0m18:15:46.619619 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:15:46.624300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.462165, "process_user_time": 2.858538, "process_kernel_time": 1.696995, "process_mem_max_rss": "208289792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:15:46.625329 [debug] [MainThread]: Command `dbt run` failed at 18:15:46.625037 after 6.46 seconds
[0m18:15:46.626117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b853c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b852cb0>]}
[0m18:15:46.627033 [debug] [MainThread]: Flushing usage events
[0m18:17:31.709241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106debc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106debed0>]}


============================== 18:17:31.717384 | 95010664-505f-4e7e-b37a-20d560dbe67d ==============================
[0m18:17:31.717384 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:17:31.718219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:33.700728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95010664-505f-4e7e-b37a-20d560dbe67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e088fc0>]}
[0m18:17:33.799062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95010664-505f-4e7e-b37a-20d560dbe67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d659590>]}
[0m18:17:33.800188 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:17:34.010323 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:17:34.256197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:17:34.257300 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m18:17:34.725528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95010664-505f-4e7e-b37a-20d560dbe67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e49d050>]}
[0m18:17:34.923445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95010664-505f-4e7e-b37a-20d560dbe67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7a7980>]}
[0m18:17:34.924404 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:17:34.924839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95010664-505f-4e7e-b37a-20d560dbe67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e694590>]}
[0m18:17:34.927953 [info ] [MainThread]: 
[0m18:17:34.929170 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:17:34.930560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:17:34.931131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:35.306896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:17:35.307306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:35.576222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95010664-505f-4e7e-b37a-20d560dbe67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e663930>]}
[0m18:17:35.576966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:17:35.577258 [info ] [MainThread]: 
[0m18:17:35.579981 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m18:17:35.580433 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m18:17:35.580813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m18:17:35.581351 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m18:17:35.601808 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m18:17:35.603668 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m18:17:35.642003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:35.963114 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m18:17:35.964711 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_duration,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_duration, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_duration,
        f.final_response_duration,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_duration,
    final_response_duration,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m18:17:36.311043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1ced621b-2efb-4e21-b661-509507971ce7&page=queryresults
[0m18:17:40.503569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95010664-505f-4e7e-b37a-20d560dbe67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3e62d0>]}
[0m18:17:40.504679 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events_users_rsvp .... [[32mCREATE TABLE (174.0k rows, 18.2 MiB processed)[0m in 4.92s]
[0m18:17:40.505917 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m18:17:40.508009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:40.508505 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m18:17:40.509150 [info ] [MainThread]: 
[0m18:17:40.509638 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m18:17:40.510972 [debug] [MainThread]: Command end result
[0m18:17:40.579343 [info ] [MainThread]: 
[0m18:17:40.580161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:40.580704 [info ] [MainThread]: 
[0m18:17:40.581059 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:17:40.584838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.984505, "process_user_time": 2.700822, "process_kernel_time": 1.602829, "process_mem_max_rss": "209518592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:17:40.585700 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:40.585485 after 8.99 seconds
[0m18:17:40.586085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3d6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e053110>]}
[0m18:17:40.586854 [debug] [MainThread]: Flushing usage events
[0m18:25:24.691753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e7ed0>]}


============================== 18:25:24.700882 | 90472469-c195-4135-9b59-8a58691c29a7 ==============================
[0m18:25:24.700882 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:25:24.701841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models certified_events', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:25:26.690821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90472469-c195-4135-9b59-8a58691c29a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115188fc0>]}
[0m18:25:26.790240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90472469-c195-4135-9b59-8a58691c29a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f59590>]}
[0m18:25:26.791753 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:25:27.008779 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:25:27.253452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:27.254732 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certitifed_events.sql
[0m18:25:27.739729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90472469-c195-4135-9b59-8a58691c29a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155ac250>]}
[0m18:25:27.943048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90472469-c195-4135-9b59-8a58691c29a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150a7b60>]}
[0m18:25:27.943802 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:25:27.944356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90472469-c195-4135-9b59-8a58691c29a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157a0210>]}
[0m18:25:27.945312 [warn ] [MainThread]: The selection criterion 'certified_events' does not match any enabled nodes
[0m18:25:27.947436 [info ] [MainThread]: 
[0m18:25:27.948116 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:25:27.948902 [debug] [MainThread]: Command end result
[0m18:25:28.008853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4283326, "process_user_time": 2.467413, "process_kernel_time": 1.537466, "process_mem_max_rss": "205094912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:25:28.009785 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:28.009596 after 3.43 seconds
[0m18:25:28.010373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11572bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154f93d0>]}
[0m18:25:28.010866 [debug] [MainThread]: Flushing usage events
[0m18:26:10.133150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103236660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052abed0>]}


============================== 18:26:10.140871 | 541fd5b9-720b-45d5-806a-1615a6dc48a8 ==============================
[0m18:26:10.140871 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:26:10.141887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_events', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:26:12.350832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '541fd5b9-720b-45d5-806a-1615a6dc48a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba88fc0>]}
[0m18:26:12.457941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '541fd5b9-720b-45d5-806a-1615a6dc48a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b859590>]}
[0m18:26:12.459710 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:26:12.668505 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:26:12.917412 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:26:12.918816 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_events.sql
[0m18:26:12.919289 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/Certified/certitifed_events.sql
[0m18:26:13.394729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '541fd5b9-720b-45d5-806a-1615a6dc48a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bfc4350>]}
[0m18:26:13.597100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '541fd5b9-720b-45d5-806a-1615a6dc48a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b9a7b60>]}
[0m18:26:13.598039 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:26:13.598510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '541fd5b9-720b-45d5-806a-1615a6dc48a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13caa0050>]}
[0m18:26:13.601146 [info ] [MainThread]: 
[0m18:26:13.602218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:26:13.603586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:26:13.604339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:14.020371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:26:14.020803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:14.276925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '541fd5b9-720b-45d5-806a-1615a6dc48a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ca6b930>]}
[0m18:26:14.277437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:14.277671 [info ] [MainThread]: 
[0m18:26:14.280286 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:26:14.280719 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:26:14.281046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:26:14.281297 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:26:14.293601 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:26:14.295366 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:26:14.372967 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:26:14.374638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:14.377604 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        response_yes_cnt * 1.00 / total_user AS accept_rate,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        response_no_cnt * 1.00 / total_user AS decline_rate,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END)/total_user AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

events AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_rate,
        r.decline_user_cnt,
        r.decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM stg_events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:26:14.662936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1d299ff2-463f-41d2-8a06-74f4868da0a2&page=queryresults
[0m18:26:14.663518 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "staging" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: staging, message: Table "staging" must be qualified with a dataset (e.g. dataset.table).')
[0m18:26:15.188220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e4cf5300-2694-48a8-ad64-35fdce084f8a&page=queryresults
[0m18:26:15.188827 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e4cf5300-2694-48a8-ad64-35fdce084f8a&page=queryresults
[0m18:26:15.199081 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Table "staging" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:26:15.200337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541fd5b9-720b-45d5-806a-1615a6dc48a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bdfa990>]}
[0m18:26:15.200828 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 0.92s]
[0m18:26:15.201257 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:26:15.202712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:15.202960 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:26:15.203165 [info ] [MainThread]: 
[0m18:26:15.203423 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m18:26:15.203940 [debug] [MainThread]: Command end result
[0m18:26:15.270776 [info ] [MainThread]: 
[0m18:26:15.271649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:15.271985 [info ] [MainThread]: 
[0m18:26:15.272823 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Table "staging" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:26:15.273474 [info ] [MainThread]: 
[0m18:26:15.273823 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:26:15.278823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.266112, "process_user_time": 2.817317, "process_kernel_time": 1.69142, "process_mem_max_rss": "207798272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:26:15.279963 [debug] [MainThread]: Command `dbt run` failed at 18:26:15.279793 after 5.27 seconds
[0m18:26:15.280505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bdd7330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba6a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba6be30>]}
[0m18:26:15.281460 [debug] [MainThread]: Flushing usage events
[0m18:26:53.749957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2abed0>]}


============================== 18:26:53.757653 | 989851d5-031c-44ba-88ba-d48f0d35e9f7 ==============================
[0m18:26:53.757653 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:26:53.758515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:26:55.895891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '989851d5-031c-44ba-88ba-d48f0d35e9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c188fc0>]}
[0m18:26:56.026267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '989851d5-031c-44ba-88ba-d48f0d35e9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf59590>]}
[0m18:26:56.028196 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:26:56.295600 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:26:56.556959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:56.558344 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m18:26:57.069366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '989851d5-031c-44ba-88ba-d48f0d35e9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c5c8350>]}
[0m18:26:57.279769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '989851d5-031c-44ba-88ba-d48f0d35e9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c0a7b60>]}
[0m18:26:57.280900 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:26:57.282081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '989851d5-031c-44ba-88ba-d48f0d35e9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d09c050>]}
[0m18:26:57.285278 [info ] [MainThread]: 
[0m18:26:57.286372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:26:57.289356 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:26:57.290699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:57.684155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:26:57.684559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:58.001805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '989851d5-031c-44ba-88ba-d48f0d35e9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d06b930>]}
[0m18:26:58.002305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:58.002525 [info ] [MainThread]: 
[0m18:26:58.005358 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:26:58.005837 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:26:58.006229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:26:58.006519 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:26:58.016382 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:26:58.017822 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:26:58.111269 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:26:58.113767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:58.117786 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        response_yes_cnt * 1.00 / total_user AS accept_rate,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        response_no_cnt * 1.00 / total_user AS decline_rate,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END)/total_user AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_rate,
        r.decline_user_cnt,
        r.decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM stg_events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:26:58.434404 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f971323f-5ff7-4115-84db-0aa87eb7e71e&page=queryresults
[0m18:26:58.435031 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stg_events" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stg_events, message: Table "stg_events" must be qualified with a dataset (e.g. dataset.table).')
[0m18:26:59.526023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2bef38f2-b751-4527-8d47-503980faf022&page=queryresults
[0m18:26:59.526635 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2bef38f2-b751-4527-8d47-503980faf022&page=queryresults
[0m18:26:59.536966 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Table "stg_events" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:26:59.538242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '989851d5-031c-44ba-88ba-d48f0d35e9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c4fe990>]}
[0m18:26:59.538792 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 1.53s]
[0m18:26:59.539263 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:26:59.540744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:59.540994 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:26:59.541201 [info ] [MainThread]: 
[0m18:26:59.541418 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m18:26:59.541884 [debug] [MainThread]: Command end result
[0m18:26:59.618480 [info ] [MainThread]: 
[0m18:26:59.619311 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:59.619826 [info ] [MainThread]: 
[0m18:26:59.620420 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Table "stg_events" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:26:59.620728 [info ] [MainThread]: 
[0m18:26:59.621157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:26:59.624372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9831996, "process_user_time": 2.836802, "process_kernel_time": 1.735485, "process_mem_max_rss": "207863808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:26:59.625232 [debug] [MainThread]: Command `dbt run` failed at 18:26:59.625073 after 5.98 seconds
[0m18:26:59.625812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c4d7330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c16a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c16be30>]}
[0m18:26:59.626165 [debug] [MainThread]: Flushing usage events
[0m18:27:23.287896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110abed0>]}


============================== 18:27:23.297334 | 523e74ff-8e2e-4717-a549-e4327ba6fc8d ==============================
[0m18:27:23.297334 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:27:23.298333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:25.321550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '523e74ff-8e2e-4717-a549-e4327ba6fc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130588fc0>]}
[0m18:27:25.424791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '523e74ff-8e2e-4717-a549-e4327ba6fc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130259590>]}
[0m18:27:25.426255 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:27:25.638615 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:27:25.886624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:25.888026 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m18:27:26.363910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '523e74ff-8e2e-4717-a549-e4327ba6fc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311cc350>]}
[0m18:27:26.567827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '523e74ff-8e2e-4717-a549-e4327ba6fc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1304a7980>]}
[0m18:27:26.568532 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:27:26.569083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '523e74ff-8e2e-4717-a549-e4327ba6fc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131398050>]}
[0m18:27:26.572145 [info ] [MainThread]: 
[0m18:27:26.573155 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:26.574973 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:27:26.575745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:26.919612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:27:26.919976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:27.163090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '523e74ff-8e2e-4717-a549-e4327ba6fc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131363930>]}
[0m18:27:27.163947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:27.164534 [info ] [MainThread]: 
[0m18:27:27.169578 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:27:27.170782 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:27:27.171810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:27:27.172349 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:27:27.190932 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:27:27.192352 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:27:27.270490 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:27:27.272363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:27.275177 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        response_yes_cnt * 1.00 / total_user AS accept_rate,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        response_no_cnt * 1.00 / total_user AS decline_rate,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END)/total_user AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_rate,
        r.decline_user_cnt,
        r.decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_events` e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:27:28.081953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7f1a3c46-a912-4583-8899-c7ae1cc51cff&page=queryresults
[0m18:27:28.176120 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: user_id; Did you mean user_city? at [22:15]; reason: invalidQuery, location: query, message: Unrecognized name: user_id; Did you mean user_city? at [22:15]')
[0m18:27:29.408949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:fa705be6-14f4-4e97-9aaf-530896763d4e&page=queryresults
[0m18:27:29.484994 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:fa705be6-14f4-4e97-9aaf-530896763d4e&page=queryresults
[0m18:27:29.495527 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: user_id; Did you mean user_city? at [22:15]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:27:29.496813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '523e74ff-8e2e-4717-a549-e4327ba6fc8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310e6990>]}
[0m18:27:29.497332 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 2.32s]
[0m18:27:29.497819 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:27:29.499318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:29.499558 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:27:29.499764 [info ] [MainThread]: 
[0m18:27:29.499991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m18:27:29.501436 [debug] [MainThread]: Command end result
[0m18:27:29.569096 [info ] [MainThread]: 
[0m18:27:29.569755 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:29.570188 [info ] [MainThread]: 
[0m18:27:29.570923 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: user_id; Did you mean user_city? at [22:15]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:27:29.571268 [info ] [MainThread]: 
[0m18:27:29.571739 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:27:29.575464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.407041, "process_user_time": 2.784487, "process_kernel_time": 1.660297, "process_mem_max_rss": "207863808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:29.576238 [debug] [MainThread]: Command `dbt run` failed at 18:27:29.576039 after 6.41 seconds
[0m18:27:29.576623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310d6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130553c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130552cb0>]}
[0m18:27:29.577061 [debug] [MainThread]: Flushing usage events
[0m18:28:19.883224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105236660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e7ed0>]}


============================== 18:28:19.891836 | 829f7472-6d80-4d1a-8c79-71e49f315bd7 ==============================
[0m18:28:19.891836 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:28:19.892864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:28:21.834638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '829f7472-6d80-4d1a-8c79-71e49f315bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137688fc0>]}
[0m18:28:21.936769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '829f7472-6d80-4d1a-8c79-71e49f315bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137259590>]}
[0m18:28:21.938257 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:28:22.164923 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:28:22.415820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:22.416929 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m18:28:22.890278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '829f7472-6d80-4d1a-8c79-71e49f315bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ac4550>]}
[0m18:28:23.092898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '829f7472-6d80-4d1a-8c79-71e49f315bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373a7c50>]}
[0m18:28:23.093603 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:28:23.094065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829f7472-6d80-4d1a-8c79-71e49f315bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c98050>]}
[0m18:28:23.097066 [info ] [MainThread]: 
[0m18:28:23.098299 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:28:23.099776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:28:23.100348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:23.472607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:28:23.472973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:23.732443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829f7472-6d80-4d1a-8c79-71e49f315bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c5f930>]}
[0m18:28:23.732978 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:28:23.733214 [info ] [MainThread]: 
[0m18:28:23.735681 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:28:23.736092 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:28:23.736437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:28:23.736708 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:28:23.748939 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:28:23.750287 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:28:23.826301 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:28:23.828562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:23.831435 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        response_yes_cnt * 1.00 / total_user AS accept_rate,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        response_no_cnt * 1.00 / total_user AS decline_rate,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END)/total_user AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_rate,
        r.decline_user_cnt,
        r.decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_events` e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:28:24.399088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:bf26d674-24a8-4855-bca7-a089040888c5&page=queryresults
[0m18:28:24.502623 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: response_yes_cnt at [25:9]; reason: invalidQuery, location: query, message: Unrecognized name: response_yes_cnt at [25:9]')
[0m18:28:25.558739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:dc63281d-214d-42fb-8d0a-0fdb2f683512&page=queryresults
[0m18:28:25.710037 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:dc63281d-214d-42fb-8d0a-0fdb2f683512&page=queryresults
[0m18:28:25.723138 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: response_yes_cnt at [25:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:28:25.724397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829f7472-6d80-4d1a-8c79-71e49f315bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378ea2d0>]}
[0m18:28:25.724885 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 1.99s]
[0m18:28:25.725311 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:28:25.727801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:25.728382 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:28:25.728812 [info ] [MainThread]: 
[0m18:28:25.729352 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m18:28:25.730833 [debug] [MainThread]: Command end result
[0m18:28:25.798083 [info ] [MainThread]: 
[0m18:28:25.799016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:28:25.799516 [info ] [MainThread]: 
[0m18:28:25.800159 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: response_yes_cnt at [25:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:28:25.800649 [info ] [MainThread]: 
[0m18:28:25.801121 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:28:25.804849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.0311737, "process_user_time": 2.675691, "process_kernel_time": 1.600154, "process_mem_max_rss": "208158720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:28:25.805720 [debug] [MainThread]: Command `dbt run` failed at 18:28:25.805405 after 6.03 seconds
[0m18:28:25.806503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378dafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137653c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137652cb0>]}
[0m18:28:25.807074 [debug] [MainThread]: Flushing usage events
[0m18:29:07.898058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be7ed0>]}


============================== 18:29:07.906233 | 9f0df785-120c-4bec-acb1-958fce257a11 ==============================
[0m18:29:07.906233 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:29:07.907061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:29:09.903026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f0df785-120c-4bec-acb1-958fce257a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125788fc0>]}
[0m18:29:09.985206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f0df785-120c-4bec-acb1-958fce257a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125359590>]}
[0m18:29:09.986066 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:29:10.220363 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:29:10.473090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:10.474635 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m18:29:10.945642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f0df785-120c-4bec-acb1-958fce257a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130bc8550>]}
[0m18:29:11.153797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f0df785-120c-4bec-acb1-958fce257a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255a7c50>]}
[0m18:29:11.154849 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:29:11.155338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f0df785-120c-4bec-acb1-958fce257a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d98050>]}
[0m18:29:11.158113 [info ] [MainThread]: 
[0m18:29:11.159022 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:29:11.160387 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:29:11.160947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:11.549528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:29:11.549915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:29:11.804252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f0df785-120c-4bec-acb1-958fce257a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d63930>]}
[0m18:29:11.804756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:29:11.804991 [info ] [MainThread]: 
[0m18:29:11.807148 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:29:11.807599 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:29:11.807940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:29:11.808197 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:29:11.824638 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:29:11.825852 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:29:11.902623 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:29:11.904067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:11.906996 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        accept_user_cnt * 1.00 / total_user AS accept_rate,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        decline_user_cnt * 1.00 / total_user AS decline_rate,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END)/total_user AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_rate,
        r.decline_user_cnt,
        r.decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_events` e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:29:12.533230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:26221173-7311-4987-a597-d2734f921264&page=queryresults
[0m18:29:12.631977 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: accept_user_cnt at [25:9]; reason: invalidQuery, location: query, message: Unrecognized name: accept_user_cnt at [25:9]')
[0m18:29:13.653760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7aaef667-4b12-475f-928c-38a2bb17af95&page=queryresults
[0m18:29:13.749457 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7aaef667-4b12-475f-928c-38a2bb17af95&page=queryresults
[0m18:29:13.759810 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: accept_user_cnt at [25:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:29:13.761154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f0df785-120c-4bec-acb1-958fce257a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1309eab10>]}
[0m18:29:13.761930 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 1.95s]
[0m18:29:13.762604 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:29:13.764919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:13.765454 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:29:13.766233 [info ] [MainThread]: 
[0m18:29:13.766927 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m18:29:13.767942 [debug] [MainThread]: Command end result
[0m18:29:13.835997 [info ] [MainThread]: 
[0m18:29:13.836685 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:29:13.837245 [info ] [MainThread]: 
[0m18:29:13.837916 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: accept_user_cnt at [25:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:29:13.838304 [info ] [MainThread]: 
[0m18:29:13.838551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:29:13.842649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.051831, "process_user_time": 2.682521, "process_kernel_time": 1.598833, "process_mem_max_rss": "208781312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:29:13.843473 [debug] [MainThread]: Command `dbt run` failed at 18:29:13.843203 after 6.05 seconds
[0m18:29:13.844019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1309deba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125753c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125752cb0>]}
[0m18:29:13.844875 [debug] [MainThread]: Flushing usage events
[0m18:34:25.803141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7ed0>]}


============================== 18:34:25.811911 | c174f035-916b-46fa-819d-acd81c8ae8f4 ==============================
[0m18:34:25.811911 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:34:25.812714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:27.773199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c174f035-916b-46fa-819d-acd81c8ae8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d688fc0>]}
[0m18:34:27.870139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c174f035-916b-46fa-819d-acd81c8ae8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d359590>]}
[0m18:34:27.871753 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:34:28.090688 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:34:28.332136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:28.333190 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m18:34:28.809432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c174f035-916b-46fa-819d-acd81c8ae8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1d0550>]}
[0m18:34:29.015733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c174f035-916b-46fa-819d-acd81c8ae8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a7c50>]}
[0m18:34:29.016721 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:34:29.017489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c174f035-916b-46fa-819d-acd81c8ae8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f398050>]}
[0m18:34:29.020555 [info ] [MainThread]: 
[0m18:34:29.021475 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:34:29.022653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:34:29.023097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:29.413830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:34:29.414195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:29.675454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c174f035-916b-46fa-819d-acd81c8ae8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35f930>]}
[0m18:34:29.675956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:34:29.676201 [info ] [MainThread]: 
[0m18:34:29.678289 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:34:29.678773 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:34:29.679107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:34:29.679383 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:34:29.689246 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:34:29.690651 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:34:29.770318 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:34:29.771872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.775083 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        decline_user_cnt * 1.00 / total_user AS decline_rate,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END)/total_user AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_events` e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:34:30.375949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e677904c-799a-4347-a48a-ffc1a7291a96&page=queryresults
[0m18:34:30.475149 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: decline_user_cnt at [26:9]; reason: invalidQuery, location: query, message: Unrecognized name: decline_user_cnt at [26:9]')
[0m18:34:31.094276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:905d89a5-1792-439e-bc78-d0d1bf62d700&page=queryresults
[0m18:34:31.174042 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:905d89a5-1792-439e-bc78-d0d1bf62d700&page=queryresults
[0m18:34:31.184090 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: decline_user_cnt at [26:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:34:31.185424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c174f035-916b-46fa-819d-acd81c8ae8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fab10>]}
[0m18:34:31.185950 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 1.51s]
[0m18:34:31.186386 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:34:31.187999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:31.188240 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:34:31.188446 [info ] [MainThread]: 
[0m18:34:31.188703 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m18:34:31.189190 [debug] [MainThread]: Command end result
[0m18:34:31.258470 [info ] [MainThread]: 
[0m18:34:31.259321 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:34:31.259776 [info ] [MainThread]: 
[0m18:34:31.260553 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: decline_user_cnt at [26:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:34:31.261441 [info ] [MainThread]: 
[0m18:34:31.261772 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:34:31.266034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.5782657, "process_user_time": 2.695957, "process_kernel_time": 1.609373, "process_mem_max_rss": "208617472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:34:31.266917 [debug] [MainThread]: Command `dbt run` failed at 18:34:31.266804 after 5.58 seconds
[0m18:34:31.267577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d653c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d652cb0>]}
[0m18:34:31.268239 [debug] [MainThread]: Flushing usage events
[0m18:35:16.134616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047abed0>]}


============================== 18:35:16.142967 | 7f5ad3bd-04ab-4f79-835d-927d1d536ceb ==============================
[0m18:35:16.142967 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:35:16.144096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:18.067115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f5ad3bd-04ab-4f79-835d-927d1d536ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b088fc0>]}
[0m18:35:18.165454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f5ad3bd-04ab-4f79-835d-927d1d536ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad59590>]}
[0m18:35:18.166951 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:35:18.381111 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:35:18.627256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:18.628715 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m18:35:19.110854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f5ad3bd-04ab-4f79-835d-927d1d536ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4cc550>]}
[0m18:35:19.309329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f5ad3bd-04ab-4f79-835d-927d1d536ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa7c50>]}
[0m18:35:19.310441 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:35:19.311099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5ad3bd-04ab-4f79-835d-927d1d536ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea60050>]}
[0m18:35:19.314254 [info ] [MainThread]: 
[0m18:35:19.315311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:19.317157 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:35:19.317921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:19.685932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:35:19.686298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:19.947066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5ad3bd-04ab-4f79-835d-927d1d536ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea27930>]}
[0m18:35:19.947534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:35:19.947755 [info ] [MainThread]: 
[0m18:35:19.950297 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:35:19.950720 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:35:19.951035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:35:19.951277 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:35:19.963854 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:35:19.965291 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:35:20.042144 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:35:20.043710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:20.046762 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END)/total_user AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_events` e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:35:20.756150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f22ce418-245f-4d70-a69f-f660f507fd1c&page=queryresults
[0m18:35:20.849157 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: total_user at [26:63]; reason: invalidQuery, location: query, message: Unrecognized name: total_user at [26:63]')
[0m18:35:22.291976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9f9dfa51-af24-4b6d-9a67-14f287bcab06&page=queryresults
[0m18:35:22.368872 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9f9dfa51-af24-4b6d-9a67-14f287bcab06&page=queryresults
[0m18:35:22.379111 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: total_user at [26:63]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:35:22.380372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5ad3bd-04ab-4f79-835d-927d1d536ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3fe990>]}
[0m18:35:22.380877 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 2.43s]
[0m18:35:22.381314 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:35:22.382791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:22.383007 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:35:22.383205 [info ] [MainThread]: 
[0m18:35:22.383414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m18:35:22.383861 [debug] [MainThread]: Command end result
[0m18:35:22.447876 [info ] [MainThread]: 
[0m18:35:22.448651 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:22.449015 [info ] [MainThread]: 
[0m18:35:22.449565 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: total_user at [26:63]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:35:22.449996 [info ] [MainThread]: 
[0m18:35:22.450476 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:35:22.454713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.427375, "process_user_time": 2.697889, "process_kernel_time": 1.556182, "process_mem_max_rss": "209174528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:35:22.455406 [debug] [MainThread]: Command `dbt run` failed at 18:35:22.455307 after 6.43 seconds
[0m18:35:22.455966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b053c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b052cb0>]}
[0m18:35:22.456490 [debug] [MainThread]: Flushing usage events
[0m18:38:37.146343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387abed0>]}


============================== 18:38:37.154826 | e8202cb9-ab3a-4f82-817b-6f42bc8de250 ==============================
[0m18:38:37.154826 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:38:37.155725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_events', 'send_anonymous_usage_stats': 'True'}
[0m18:38:39.150794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8202cb9-ab3a-4f82-817b-6f42bc8de250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a88fc0>]}
[0m18:38:39.252906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8202cb9-ab3a-4f82-817b-6f42bc8de250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149859590>]}
[0m18:38:39.254331 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:38:39.468320 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:38:39.809582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:39.811037 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m18:38:40.291202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8202cb9-ab3a-4f82-817b-6f42bc8de250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aed0550>]}
[0m18:38:40.556035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8202cb9-ab3a-4f82-817b-6f42bc8de250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1499a7c50>]}
[0m18:38:40.557293 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m18:38:40.557977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8202cb9-ab3a-4f82-817b-6f42bc8de250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c898050>]}
[0m18:38:40.561292 [info ] [MainThread]: 
[0m18:38:40.562342 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:38:40.564124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m18:38:40.564731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:40.947807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m18:38:40.948215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:41.198660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8202cb9-ab3a-4f82-817b-6f42bc8de250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c85f930>]}
[0m18:38:41.199147 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:38:41.199403 [info ] [MainThread]: 
[0m18:38:41.202066 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m18:38:41.202526 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m18:38:41.202944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m18:38:41.203277 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m18:38:41.211630 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m18:38:41.212376 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m18:38:41.286732 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m18:38:41.288492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:41.291530 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_date) AS avg_first_response_date,
        AVG(final_response_date) AS abg_final_response_date,
        AVG(first_response_duration) AS avg_first_response_duration,
        AVG(final_response_duration) AS avg_final_response_duration,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_start_time)) AS event_date,
        e.event_status,
        e.event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', e.event_create_time)) AS event_create_date,
        e.event_description,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_lat,
        e.venue_lon,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_date,
        r.avg_final_response_duration,
        r.location_same_cnt,
        r.location_diff_cnt,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_events` e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_duration,
    event_duration_level,
    event_create_date,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_lat,
    venue_lon,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_date,
    avg_final_response_duration,
    location_same_cnt,
    location_diff_cnt,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m18:38:42.381832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:378a8f20-f116-4a6b-b575-868aa891a8aa&page=queryresults
[0m18:38:42.478474 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for aggregate function AVG\n  Argument types: DATE\n  Signature: AVG(INT64)\n    Argument 1: Unable to coerce type DATE to expected type INT64\n  Signature: AVG(FLOAT64)\n    Argument 1: Unable to coerce type DATE to expected type FLOAT64\n  Signature: AVG(NUMERIC)\n    Argument 1: Unable to coerce type DATE to expected type NUMERIC\n  Signature: AVG(BIGNUMERIC)\n    Argument 1: Unable to coerce type DATE to expected type BIGNUMERIC\n  Signature: AVG(INTERVAL)\n    Argument 1: Unable to coerce type DATE to expected type INTERVAL at [28:9]; reason: invalidQuery, location: query, message: No matching signature for aggregate function AVG\n  Argument types: DATE\n  Signature: AVG(INT64)\n    Argument 1: Unable to coerce type DATE to expected type INT64\n  Signature: AVG(FLOAT64)\n    Argument 1: Unable to coerce type DATE to expected type FLOAT64\n  Signature: AVG(NUMERIC)\n    Argument 1: Unable to coerce type DATE to expected type NUMERIC\n  Signature: AVG(BIGNUMERIC)\n    Argument 1: Unable to coerce type DATE to expected type BIGNUMERIC\n  Signature: AVG(INTERVAL)\n    Argument 1: Unable to coerce type DATE to expected type INTERVAL at [28:9]')
[0m18:38:43.712896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ec7cd07d-8e37-4afc-bdf1-81d81bf0e2b8&page=queryresults
[0m18:38:43.804691 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ec7cd07d-8e37-4afc-bdf1-81d81bf0e2b8&page=queryresults
[0m18:38:43.815049 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  No matching signature for aggregate function AVG
    Argument types: DATE
    Signature: AVG(INT64)
      Argument 1: Unable to coerce type DATE to expected type INT64
    Signature: AVG(FLOAT64)
      Argument 1: Unable to coerce type DATE to expected type FLOAT64
    Signature: AVG(NUMERIC)
      Argument 1: Unable to coerce type DATE to expected type NUMERIC
    Signature: AVG(BIGNUMERIC)
      Argument 1: Unable to coerce type DATE to expected type BIGNUMERIC
    Signature: AVG(INTERVAL)
      Argument 1: Unable to coerce type DATE to expected type INTERVAL at [28:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:38:43.816329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8202cb9-ab3a-4f82-817b-6f42bc8de250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149dfa990>]}
[0m18:38:43.816821 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 2.61s]
[0m18:38:43.817265 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m18:38:43.818771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:43.819022 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m18:38:43.819231 [info ] [MainThread]: 
[0m18:38:43.819450 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m18:38:43.819971 [debug] [MainThread]: Command end result
[0m18:38:43.866429 [info ] [MainThread]: 
[0m18:38:43.867435 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:38:43.868071 [info ] [MainThread]: 
[0m18:38:43.868652 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  No matching signature for aggregate function AVG
    Argument types: DATE
    Signature: AVG(INT64)
      Argument 1: Unable to coerce type DATE to expected type INT64
    Signature: AVG(FLOAT64)
      Argument 1: Unable to coerce type DATE to expected type FLOAT64
    Signature: AVG(NUMERIC)
      Argument 1: Unable to coerce type DATE to expected type NUMERIC
    Signature: AVG(BIGNUMERIC)
      Argument 1: Unable to coerce type DATE to expected type BIGNUMERIC
    Signature: AVG(INTERVAL)
      Argument 1: Unable to coerce type DATE to expected type INTERVAL at [28:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m18:38:43.869459 [info ] [MainThread]: 
[0m18:38:43.869902 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:38:43.873438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8364034, "process_user_time": 2.706511, "process_kernel_time": 1.600111, "process_mem_max_rss": "209715200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:38:43.874383 [debug] [MainThread]: Command `dbt run` failed at 18:38:43.874210 after 6.84 seconds
[0m18:38:43.874953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149dd6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a53c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149a52cb0>]}
[0m18:38:43.875595 [debug] [MainThread]: Flushing usage events
[0m19:05:38.426981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7ed0>]}


============================== 19:05:38.437263 | 60b1f85f-eee0-411d-8cb5-60ae0cd544f9 ==============================
[0m19:05:38.437263 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:05:38.438830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:05:40.459514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60b1f85f-eee0-411d-8cb5-60ae0cd544f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123588fc0>]}
[0m19:05:40.554303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60b1f85f-eee0-411d-8cb5-60ae0cd544f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123359590>]}
[0m19:05:40.555643 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:05:40.761654 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:05:41.014828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:05:41.016115 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m19:05:41.492902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60b1f85f-eee0-411d-8cb5-60ae0cd544f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241e0550>]}
[0m19:05:41.697746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60b1f85f-eee0-411d-8cb5-60ae0cd544f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234a7c50>]}
[0m19:05:41.698631 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m19:05:41.699340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b1f85f-eee0-411d-8cb5-60ae0cd544f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124498130>]}
[0m19:05:41.702014 [info ] [MainThread]: 
[0m19:05:41.702876 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:05:41.704781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m19:05:41.705321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:42.085454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m19:05:42.085875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:42.340645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b1f85f-eee0-411d-8cb5-60ae0cd544f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124463930>]}
[0m19:05:42.341138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:42.341375 [info ] [MainThread]: 
[0m19:05:42.343459 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m19:05:42.343869 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m19:05:42.344235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m19:05:42.344517 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m19:05:42.362671 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m19:05:42.364512 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m19:05:42.393336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:42.713945 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m19:05:42.715582 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m19:05:43.271150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:54966623-a150-428d-99f2-750aed9689f3&page=queryresults
[0m19:05:47.889525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b1f85f-eee0-411d-8cb5-60ae0cd544f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240fa2d0>]}
[0m19:05:47.890793 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events_users_rsvp .... [[32mCREATE TABLE (174.0k rows, 18.2 MiB processed)[0m in 5.54s]
[0m19:05:47.891563 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m19:05:47.894201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:47.894841 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m19:05:47.895212 [info ] [MainThread]: 
[0m19:05:47.895933 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.19 seconds (6.19s).
[0m19:05:47.897372 [debug] [MainThread]: Command end result
[0m19:05:47.961923 [info ] [MainThread]: 
[0m19:05:47.962581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:47.963153 [info ] [MainThread]: 
[0m19:05:47.963865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:05:47.968182 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.668332, "process_user_time": 2.73758, "process_kernel_time": 1.641535, "process_mem_max_rss": "207601664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:05:47.968993 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:47.968832 after 9.67 seconds
[0m19:05:47.969590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240d6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123553110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123551270>]}
[0m19:05:47.970121 [debug] [MainThread]: Flushing usage events
[0m20:03:52.485838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7ed0>]}


============================== 20:03:52.494538 | 6620f325-f13e-4164-829d-0988251c7534 ==============================
[0m20:03:52.494538 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:03:52.495489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:03:54.425366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6620f325-f13e-4164-829d-0988251c7534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d388fc0>]}
[0m20:03:54.506015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6620f325-f13e-4164-829d-0988251c7534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d159590>]}
[0m20:03:54.506339 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:03:54.846811 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:03:55.105138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:03:55.106645 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m20:03:55.592294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6620f325-f13e-4164-829d-0988251c7534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7c8550>]}
[0m20:03:55.800907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6620f325-f13e-4164-829d-0988251c7534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a7c50>]}
[0m20:03:55.801656 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m20:03:55.802258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6620f325-f13e-4164-829d-0988251c7534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e198050>]}
[0m20:03:55.805392 [info ] [MainThread]: 
[0m20:03:55.806494 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:03:55.808092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m20:03:55.808672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:56.195662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m20:03:56.196026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:56.490934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6620f325-f13e-4164-829d-0988251c7534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e163930>]}
[0m20:03:56.491413 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:03:56.491648 [info ] [MainThread]: 
[0m20:03:56.494161 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m20:03:56.494581 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m20:03:56.494903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m20:03:56.495142 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m20:03:56.503352 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m20:03:56.504154 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m20:03:56.583862 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m20:03:56.585366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:56.588353 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
),

events AS (
    SELECT 
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / create_to_start_duration) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / create_to_start_duration) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m20:03:57.280158 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:60a78659-c656-4db7-9611-e42363fcb90c&page=queryresults
[0m20:03:57.394465 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column event_name which is neither grouped nor aggregated at [18:9]; reason: invalidQuery, location: query, message: SELECT list expression references column event_name which is neither grouped nor aggregated at [18:9]')
[0m20:03:58.713565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:88fb4215-b432-48a3-96fe-fb42dc17f9a4&page=queryresults
[0m20:03:58.808656 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:88fb4215-b432-48a3-96fe-fb42dc17f9a4&page=queryresults
[0m20:03:58.818910 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  SELECT list expression references column event_name which is neither grouped nor aggregated at [18:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m20:03:58.820157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6620f325-f13e-4164-829d-0988251c7534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6fa990>]}
[0m20:03:58.820679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 2.32s]
[0m20:03:58.821194 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m20:03:58.822626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:58.822872 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m20:03:58.823101 [info ] [MainThread]: 
[0m20:03:58.823353 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m20:03:58.823851 [debug] [MainThread]: Command end result
[0m20:03:58.886402 [info ] [MainThread]: 
[0m20:03:58.887319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:03:58.887868 [info ] [MainThread]: 
[0m20:03:58.888513 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  SELECT list expression references column event_name which is neither grouped nor aggregated at [18:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m20:03:58.888888 [info ] [MainThread]: 
[0m20:03:58.889422 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:03:58.892733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5188, "process_user_time": 2.561817, "process_kernel_time": 1.639416, "process_mem_max_rss": "206946304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:03:58.893761 [debug] [MainThread]: Command `dbt run` failed at 20:03:58.893563 after 6.52 seconds
[0m20:03:58.894402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d4f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07d310>]}
[0m20:03:58.895103 [debug] [MainThread]: Flushing usage events
[0m20:05:19.443164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105436660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e7ed0>]}


============================== 20:05:19.451818 | ca153b1b-0cc1-4e43-a25d-1e51342e9bcc ==============================
[0m20:05:19.451818 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:05:19.452837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:05:21.539773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca153b1b-0cc1-4e43-a25d-1e51342e9bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152888fc0>]}
[0m20:05:21.645797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca153b1b-0cc1-4e43-a25d-1e51342e9bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152559590>]}
[0m20:05:21.647008 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:05:21.847623 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:05:22.110294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:05:22.111311 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m20:05:22.628775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca153b1b-0cc1-4e43-a25d-1e51342e9bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152bc4550>]}
[0m20:05:22.839152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca153b1b-0cc1-4e43-a25d-1e51342e9bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1526a7c50>]}
[0m20:05:22.840286 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m20:05:22.841075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca153b1b-0cc1-4e43-a25d-1e51342e9bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152e98050>]}
[0m20:05:22.844248 [info ] [MainThread]: 
[0m20:05:22.845320 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:22.846529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m20:05:22.847094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:23.708172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m20:05:23.708539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:23.968061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca153b1b-0cc1-4e43-a25d-1e51342e9bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152e63930>]}
[0m20:05:23.968532 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:23.968765 [info ] [MainThread]: 
[0m20:05:23.971353 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m20:05:23.971789 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m20:05:23.972154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m20:05:23.972434 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m20:05:23.982892 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m20:05:23.984570 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m20:05:24.063185 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m20:05:24.064470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:24.067759 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / create_to_start_duration) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / create_to_start_duration) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_start_time = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m20:05:24.832153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:91ebfce6-0253-487a-998d-c8016363aa5f&page=queryresults
[0m20:05:24.937402 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name event_start_time not found inside e at [105:15]; reason: invalidQuery, location: query, message: Name event_start_time not found inside e at [105:15]')
[0m20:05:25.546762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a1a7e474-fb47-4f5e-87ec-a0dbfda8f462&page=queryresults
[0m20:05:25.644158 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a1a7e474-fb47-4f5e-87ec-a0dbfda8f462&page=queryresults
[0m20:05:25.654939 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Name event_start_time not found inside e at [105:15]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m20:05:25.656327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca153b1b-0cc1-4e43-a25d-1e51342e9bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152afa990>]}
[0m20:05:25.656837 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 1.68s]
[0m20:05:25.657272 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m20:05:25.658897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:25.659161 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m20:05:25.659377 [info ] [MainThread]: 
[0m20:05:25.659602 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m20:05:25.660070 [debug] [MainThread]: Command end result
[0m20:05:25.732568 [info ] [MainThread]: 
[0m20:05:25.733926 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:05:25.734916 [info ] [MainThread]: 
[0m20:05:25.735992 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Name event_start_time not found inside e at [105:15]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m20:05:25.736861 [info ] [MainThread]: 
[0m20:05:25.737596 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:05:25.741734 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.4084144, "process_user_time": 2.62162, "process_kernel_time": 1.686132, "process_mem_max_rss": "209338368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:05:25.743256 [debug] [MainThread]: Command `dbt run` failed at 20:05:25.742571 after 6.41 seconds
[0m20:05:25.744408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152ad6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152853c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152852cb0>]}
[0m20:05:25.745243 [debug] [MainThread]: Flushing usage events
[0m20:07:11.830748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288ebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288ebed0>]}


============================== 20:07:11.838252 | 66af31aa-062c-4e9d-866c-8877a939ba5c ==============================
[0m20:07:11.838252 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:07:11.839361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models certified_events', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:07:13.875945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66af31aa-062c-4e9d-866c-8877a939ba5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148e88fc0>]}
[0m20:07:13.982993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66af31aa-062c-4e9d-866c-8877a939ba5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148c59590>]}
[0m20:07:13.984493 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:07:14.168590 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:07:14.436236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:07:14.437703 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m20:07:14.925773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66af31aa-062c-4e9d-866c-8877a939ba5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1499c8550>]}
[0m20:07:15.133649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66af31aa-062c-4e9d-866c-8877a939ba5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148da7c50>]}
[0m20:07:15.134620 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m20:07:15.135097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66af31aa-062c-4e9d-866c-8877a939ba5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b98050>]}
[0m20:07:15.138304 [info ] [MainThread]: 
[0m20:07:15.139454 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:07:15.141038 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m20:07:15.141556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:15.508824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m20:07:15.509194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:15.765836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66af31aa-062c-4e9d-866c-8877a939ba5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b63930>]}
[0m20:07:15.766313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:15.766544 [info ] [MainThread]: 
[0m20:07:15.769152 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m20:07:15.769569 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m20:07:15.769890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m20:07:15.770131 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m20:07:15.788145 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m20:07:15.789803 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m20:07:15.866055 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m20:07:15.867628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:15.870927 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / create_to_start_duration) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / create_to_start_duration) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_date = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m20:07:17.061084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:32191a50-4ea0-452d-a8eb-06d8f67ae650&page=queryresults
[0m20:07:17.547147 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/keira-xebia/queries/32191a50-4ea0-452d-a8eb-06d8f67ae650?maxResults=0&location=EU&prettyPrint=false: division by zero: 0 / 0')
[0m20:07:18.513524 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:24ee00f4-e74e-4d55-a1a4-e3b35fd23569&page=queryresults
[0m20:07:19.312392 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:24ee00f4-e74e-4d55-a1a4-e3b35fd23569&page=queryresults
[0m20:07:19.325449 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  division by zero: 0 / 0
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m20:07:19.326728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66af31aa-062c-4e9d-866c-8877a939ba5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1498fb050>]}
[0m20:07:19.327227 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 3.56s]
[0m20:07:19.327660 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m20:07:19.330851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:19.331185 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m20:07:19.331696 [info ] [MainThread]: 
[0m20:07:19.332148 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m20:07:19.333347 [debug] [MainThread]: Command end result
[0m20:07:19.400736 [info ] [MainThread]: 
[0m20:07:19.401883 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:07:19.402356 [info ] [MainThread]: 
[0m20:07:19.402996 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  division by zero: 0 / 0
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m20:07:19.403384 [info ] [MainThread]: 
[0m20:07:19.403948 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:07:19.407979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.697666, "process_user_time": 2.628112, "process_kernel_time": 1.700098, "process_mem_max_rss": "209125376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:07:19.408780 [debug] [MainThread]: Command `dbt run` failed at 20:07:19.408657 after 7.70 seconds
[0m20:07:19.409462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1498d71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148e53c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148e52cb0>]}
[0m20:07:19.410036 [debug] [MainThread]: Flushing usage events
[0m20:11:39.320067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107336660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e7ed0>]}


============================== 20:11:39.328046 | c1d58dec-fa6a-4b80-b80b-6caf97ef9c96 ==============================
[0m20:11:39.328046 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:11:39.328811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_events', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:11:41.357092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1d58dec-fa6a-4b80-b80b-6caf97ef9c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e88fc0>]}
[0m20:11:41.459532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1d58dec-fa6a-4b80-b80b-6caf97ef9c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c59590>]}
[0m20:11:41.460764 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:11:41.676452 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:11:41.930065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:41.931149 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m20:11:42.413877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1d58dec-fa6a-4b80-b80b-6caf97ef9c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1336c0550>]}
[0m20:11:42.621801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1d58dec-fa6a-4b80-b80b-6caf97ef9c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117da7c50>]}
[0m20:11:42.622730 [info ] [MainThread]: Found 10 models, 4 data tests, 4 sources, 484 macros
[0m20:11:42.623326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1d58dec-fa6a-4b80-b80b-6caf97ef9c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134098050>]}
[0m20:11:42.626105 [info ] [MainThread]: 
[0m20:11:42.627287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:11:42.628896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m20:11:42.629534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:43.008200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m20:11:43.008563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:43.278732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1d58dec-fa6a-4b80-b80b-6caf97ef9c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134063930>]}
[0m20:11:43.279236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:43.279493 [info ] [MainThread]: 
[0m20:11:43.282026 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m20:11:43.282478 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m20:11:43.282825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m20:11:43.283074 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m20:11:43.294353 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m20:11:43.295693 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m20:11:43.374454 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m20:11:43.375862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:43.378682 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_date = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m20:11:44.117401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a1afdb56-8628-4b34-928d-7cbab10a8e3b&page=queryresults
[0m20:11:47.697225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1d58dec-fa6a-4b80-b80b-6caf97ef9c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133406390>]}
[0m20:11:47.697808 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events ............... [[32mCREATE TABLE (6.2k rows, 27.8 MiB processed)[0m in 4.41s]
[0m20:11:47.698281 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m20:11:47.699293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:47.699503 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m20:11:47.699702 [info ] [MainThread]: 
[0m20:11:47.700252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m20:11:47.701527 [debug] [MainThread]: Command end result
[0m20:11:47.771429 [info ] [MainThread]: 
[0m20:11:47.772264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:47.772942 [info ] [MainThread]: 
[0m20:11:47.773510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:11:47.779435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.571709, "process_user_time": 2.610551, "process_kernel_time": 1.687357, "process_mem_max_rss": "207847424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:11:47.781583 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:47.780995 after 8.57 seconds
[0m20:11:47.782460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333e3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e53110>]}
[0m20:11:47.784234 [debug] [MainThread]: Flushing usage events
[0m23:12:52.545029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7ed0>]}


============================== 23:12:52.553542 | 91f3c06f-7499-462f-894d-2c9e959eca6e ==============================
[0m23:12:52.553542 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:12:52.554700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_users', 'send_anonymous_usage_stats': 'True'}
[0m23:12:54.524084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91f3c06f-7499-462f-894d-2c9e959eca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c388fc0>]}
[0m23:12:54.618402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91f3c06f-7499-462f-894d-2c9e959eca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b759590>]}
[0m23:12:54.619544 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:12:54.830931 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:12:55.085842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:12:55.087158 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_users.sql
[0m23:12:55.574979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91f3c06f-7499-462f-894d-2c9e959eca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c6cc550>]}
[0m23:12:55.923959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91f3c06f-7499-462f-894d-2c9e959eca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c1a7980>]}
[0m23:12:55.925042 [info ] [MainThread]: Found 11 models, 4 data tests, 4 sources, 484 macros
[0m23:12:55.925474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91f3c06f-7499-462f-894d-2c9e959eca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8a0210>]}
[0m23:12:55.928058 [info ] [MainThread]: 
[0m23:12:55.929283 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:12:55.931265 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:12:55.931756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:56.279372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:12:56.279897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:56.534871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91f3c06f-7499-462f-894d-2c9e959eca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c793450>]}
[0m23:12:56.536005 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:56.536610 [info ] [MainThread]: 
[0m23:12:56.541875 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users
[0m23:12:56.543002 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users ..................... [RUN]
[0m23:12:56.543858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users)
[0m23:12:56.544391 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users
[0m23:12:56.562030 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users"
[0m23:12:56.563811 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users
[0m23:12:56.642487 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users"
[0m23:12:56.644484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:12:56.647580 [debug] [Thread-1 (]: On model.keira_project.certified_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM `keira-xebia`.`meetupservice`.`stg_users`
    );
  
[0m23:12:57.237498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:14e18348-4391-4b1a-9e7f-b587f79f8cc3&page=queryresults
[0m23:12:59.849129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91f3c06f-7499-462f-894d-2c9e959eca6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5f9610>]}
[0m23:12:59.849754 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_users ................ [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.30s]
[0m23:12:59.850217 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users
[0m23:12:59.851299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:59.851515 [debug] [MainThread]: Connection 'model.keira_project.certified_users' was properly closed.
[0m23:12:59.851716 [info ] [MainThread]: 
[0m23:12:59.851928 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m23:12:59.852681 [debug] [MainThread]: Command end result
[0m23:12:59.922306 [info ] [MainThread]: 
[0m23:12:59.923041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:59.923492 [info ] [MainThread]: 
[0m23:12:59.924177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:12:59.927911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4939494, "process_user_time": 2.682422, "process_kernel_time": 1.565586, "process_mem_max_rss": "209125376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:12:59.928954 [debug] [MainThread]: Command `dbt run` succeeded at 23:12:59.928776 after 7.50 seconds
[0m23:12:59.929614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5d6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023fb070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c368370>]}
[0m23:12:59.930173 [debug] [MainThread]: Flushing usage events
[0m23:18:14.805252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fe7ed0>]}


============================== 23:18:14.813649 | 7271afcc-4768-4fea-91a8-3560b3938705 ==============================
[0m23:18:14.813649 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:18:14.814718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_groups', 'send_anonymous_usage_stats': 'True'}
[0m23:18:16.747751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7271afcc-4768-4fea-91a8-3560b3938705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131b88fc0>]}
[0m23:18:16.842702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7271afcc-4768-4fea-91a8-3560b3938705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131859590>]}
[0m23:18:16.844209 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:18:17.011687 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:18:17.255798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:18:17.256935 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_groups.sql
[0m23:18:17.722257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7271afcc-4768-4fea-91a8-3560b3938705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131fb0550>]}
[0m23:18:17.918823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7271afcc-4768-4fea-91a8-3560b3938705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1319a7d40>]}
[0m23:18:17.919966 [info ] [MainThread]: Found 12 models, 4 data tests, 4 sources, 484 macros
[0m23:18:17.920519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7271afcc-4768-4fea-91a8-3560b3938705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132952190>]}
[0m23:18:17.923307 [info ] [MainThread]: 
[0m23:18:17.924275 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:18:17.925677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:18:17.926322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:18.288916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:18:18.289285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:18.543467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7271afcc-4768-4fea-91a8-3560b3938705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13286f2b0>]}
[0m23:18:18.544017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:18:18.544254 [info ] [MainThread]: 
[0m23:18:18.548338 [debug] [Thread-1 (]: Began running node model.keira_project.certified_groups
[0m23:18:18.549227 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_groups .................... [RUN]
[0m23:18:18.550185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_groups)
[0m23:18:18.550844 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_groups
[0m23:18:18.566447 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_groups"
[0m23:18:18.568015 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_groups
[0m23:18:18.643463 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_groups"
[0m23:18:18.645141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:18.648446 [debug] [Thread-1 (]: On model.keira_project.certified_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_groups`
      
    
    

    OPTIONS()
    as (
      


SELECT 
    group_id, --unique identifier of a group
    group_name,
    group_created_year,
    group_created_month,
    group_description,
    group_city,
    group_lat,
    group_lon
FROM `keira-xebia`.`meetupservice`.`stg_groups`
    );
  
[0m23:18:19.285487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:79ba1bec-ae02-4c75-890f-173e2085adf4&page=queryresults
[0m23:18:21.916307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7271afcc-4768-4fea-91a8-3560b3938705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131eea990>]}
[0m23:18:21.916875 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_groups ............... [[32mCREATE TABLE (711.0 rows, 448.3 KiB processed)[0m in 3.37s]
[0m23:18:21.917364 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_groups
[0m23:18:21.918423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:21.918655 [debug] [MainThread]: Connection 'model.keira_project.certified_groups' was properly closed.
[0m23:18:21.918866 [info ] [MainThread]: 
[0m23:18:21.919094 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m23:18:21.919575 [debug] [MainThread]: Command end result
[0m23:18:21.985313 [info ] [MainThread]: 
[0m23:18:21.986057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:21.986337 [info ] [MainThread]: 
[0m23:18:21.986661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:18:21.990057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2996254, "process_user_time": 2.695616, "process_kernel_time": 1.540007, "process_mem_max_rss": "207470592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:18:21.990924 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:21.990766 after 7.30 seconds
[0m23:18:21.991629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131efb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131b50870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131b53b10>]}
[0m23:18:21.992175 [debug] [MainThread]: Flushing usage events
[0m23:22:04.795342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103436660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e7ed0>]}


============================== 23:22:04.803222 | be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c ==============================
[0m23:22:04.803222 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:22:04.804184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_users_groups', 'send_anonymous_usage_stats': 'True'}
[0m23:22:06.740255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c688fc0>]}
[0m23:22:06.834844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c359590>]}
[0m23:22:06.836212 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m23:22:07.054258 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:22:07.300778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:22:07.301882 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_users_groups.sql
[0m23:22:07.774459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9e0550>]}
[0m23:22:07.971722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c5a7d40>]}
[0m23:22:07.972428 [info ] [MainThread]: Found 13 models, 4 data tests, 4 sources, 484 macros
[0m23:22:07.972975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb56270>]}
[0m23:22:07.976027 [info ] [MainThread]: 
[0m23:22:07.976956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:22:07.978248 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m23:22:07.978811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:08.353070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m23:22:08.353480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:08.608286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca73450>]}
[0m23:22:08.608815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:22:08.609071 [info ] [MainThread]: 
[0m23:22:08.611710 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m23:22:08.612163 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m23:22:08.612494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m23:22:08.612745 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m23:22:08.628797 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m23:22:08.630249 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m23:22:08.707330 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m23:22:08.708757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:08.711708 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
    );
  
[0m23:22:09.378450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:eff6396b-f28f-4285-aa42-9a62f1369cc1&page=queryresults
[0m23:22:12.025184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be3d2cca-a5a4-4bf8-a570-a6fa3313cf1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8feb10>]}
[0m23:22:12.025750 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_users_groups ......... [[32mCREATE TABLE (145.5k rows, 6.3 MiB processed)[0m in 3.41s]
[0m23:22:12.026206 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m23:22:12.027266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:12.027473 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m23:22:12.027670 [info ] [MainThread]: 
[0m23:22:12.028100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m23:22:12.029295 [debug] [MainThread]: Command end result
[0m23:22:12.093673 [info ] [MainThread]: 
[0m23:22:12.094387 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:22:12.094979 [info ] [MainThread]: 
[0m23:22:12.095544 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:22:12.099280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4089575, "process_user_time": 2.670352, "process_kernel_time": 1.555572, "process_mem_max_rss": "208568320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:22:12.099968 [debug] [MainThread]: Command `dbt run` succeeded at 23:22:12.099890 after 7.41 seconds
[0m23:22:12.100430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c91b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca332f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca32e90>]}
[0m23:22:12.101141 [debug] [MainThread]: Flushing usage events
[0m11:32:16.087378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d46660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de7ed0>]}


============================== 11:32:16.095801 | 6256c40a-0b57-4bf6-aa4c-54883b20e7cd ==============================
[0m11:32:16.095801 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:32:16.096938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_events_o', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:32:18.048786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6256c40a-0b57-4bf6-aa4c-54883b20e7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116188fc0>]}
[0m11:32:18.143197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6256c40a-0b57-4bf6-aa4c-54883b20e7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115759590>]}
[0m11:32:18.144286 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m11:32:18.354414 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:32:18.596952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:32:18.598111 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_events_o.sql
[0m11:32:19.057232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6256c40a-0b57-4bf6-aa4c-54883b20e7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164e0550>]}
[0m11:32:19.256540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6256c40a-0b57-4bf6-aa4c-54883b20e7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160a7d40>]}
[0m11:32:19.257727 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m11:32:19.258291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6256c40a-0b57-4bf6-aa4c-54883b20e7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166567b0>]}
[0m11:32:19.260591 [info ] [MainThread]: 
[0m11:32:19.261564 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:32:19.263027 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m11:32:19.263523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:19.660738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m11:32:19.661137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:19.923135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6256c40a-0b57-4bf6-aa4c-54883b20e7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116573860>]}
[0m11:32:19.923663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:19.923895 [info ] [MainThread]: 
[0m11:32:19.926440 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_o
[0m11:32:19.926865 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_o ........................ [RUN]
[0m11:32:19.927255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_o)
[0m11:32:19.927969 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_o
[0m11:32:19.944938 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m11:32:19.946589 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_o
[0m11:32:20.021343 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m11:32:20.023600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:20.026607 [debug] [Thread-1 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(HASH(event_name, group_id, venue_id, event_start_time) AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsbp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m11:32:20.442316 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:90dcaf9f-15c5-4a49-b105-24e791e29dc6&page=queryresults
[0m11:32:20.442921 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword HASH at [38:14]; reason: invalidQuery, location: query, message: Syntax error: Unexpected keyword HASH at [38:14]')
[0m11:32:21.316871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:94b6dec1-80f9-41c3-8856-e0e6ae3387d7&page=queryresults
[0m11:32:21.317925 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:94b6dec1-80f9-41c3-8856-e0e6ae3387d7&page=queryresults
[0m11:32:21.330250 [debug] [Thread-1 (]: Database Error in model stg_events_o (models/Staging/stg_events_o.sql)
  Syntax error: Unexpected keyword HASH at [38:14]
  compiled code at target/run/keira_project/models/Staging/stg_events_o.sql
[0m11:32:21.332435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6256c40a-0b57-4bf6-aa4c-54883b20e7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163cef90>]}
[0m11:32:21.334441 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events_o ............... [[31mERROR[0m in 1.40s]
[0m11:32:21.335724 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_o
[0m11:32:21.339325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:21.340188 [debug] [MainThread]: Connection 'model.keira_project.stg_events_o' was properly closed.
[0m11:32:21.340842 [info ] [MainThread]: 
[0m11:32:21.341711 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m11:32:21.342959 [debug] [MainThread]: Command end result
[0m11:32:21.409957 [info ] [MainThread]: 
[0m11:32:21.410851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:21.411564 [info ] [MainThread]: 
[0m11:32:21.412194 [error] [MainThread]:   Database Error in model stg_events_o (models/Staging/stg_events_o.sql)
  Syntax error: Unexpected keyword HASH at [38:14]
  compiled code at target/run/keira_project/models/Staging/stg_events_o.sql
[0m11:32:21.412520 [info ] [MainThread]: 
[0m11:32:21.413381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:32:21.417326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4376073, "process_user_time": 2.689005, "process_kernel_time": 1.558964, "process_mem_max_rss": "208797696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:21.418081 [debug] [MainThread]: Command `dbt run` failed at 11:32:21.417967 after 5.44 seconds
[0m11:32:21.418759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11663b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160db9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160dbcf0>]}
[0m11:32:21.419199 [debug] [MainThread]: Flushing usage events
[0m11:36:18.138907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7ed0>]}


============================== 11:36:18.148682 | 76221a00-1c3a-44c0-96f7-324a77cdf07b ==============================
[0m11:36:18.148682 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:36:18.149976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_events_o', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:36:20.122464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76221a00-1c3a-44c0-96f7-324a77cdf07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113588fc0>]}
[0m11:36:20.221955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76221a00-1c3a-44c0-96f7-324a77cdf07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113359590>]}
[0m11:36:20.223037 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m11:36:20.416036 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:36:20.663332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:20.664797 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events_o.sql
[0m11:36:21.132378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76221a00-1c3a-44c0-96f7-324a77cdf07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141c8550>]}
[0m11:36:21.337688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76221a00-1c3a-44c0-96f7-324a77cdf07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a7d40>]}
[0m11:36:21.338636 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m11:36:21.339013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76221a00-1c3a-44c0-96f7-324a77cdf07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143527b0>]}
[0m11:36:21.341741 [info ] [MainThread]: 
[0m11:36:21.342765 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:36:21.344593 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m11:36:21.345097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:21.714027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m11:36:21.714419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:21.978569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76221a00-1c3a-44c0-96f7-324a77cdf07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114277d40>]}
[0m11:36:21.979081 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:21.979338 [info ] [MainThread]: 
[0m11:36:21.981917 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_o
[0m11:36:21.982354 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_o ........................ [RUN]
[0m11:36:21.982686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_o)
[0m11:36:21.982932 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_o
[0m11:36:21.990525 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m11:36:21.991377 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_o
[0m11:36:22.068105 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m11:36:22.070311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:22.073387 [debug] [Thread-1 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(FARM_FINGERPRINT(
            CONCAT(event_name, CAST(group_id AS STRING), CAST(venue_id AS STRING), CAST(event_start_time AS STRING))) 
            AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsbp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m11:36:22.773251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:303cf00a-c029-4cff-b0fd-61be6837e978&page=queryresults
[0m11:36:22.868481 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rsbp_total_limit; Did you mean rsvp_total_limit? at [53:5]; reason: invalidQuery, location: query, message: Unrecognized name: rsbp_total_limit; Did you mean rsvp_total_limit? at [53:5]')
[0m11:36:23.590937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d1707b6e-e1dd-409d-8ce0-5d54d6dded67&page=queryresults
[0m11:36:23.795084 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d1707b6e-e1dd-409d-8ce0-5d54d6dded67&page=queryresults
[0m11:36:23.807779 [debug] [Thread-1 (]: Database Error in model stg_events_o (models/Staging/stg_events_o.sql)
  Unrecognized name: rsbp_total_limit; Did you mean rsvp_total_limit? at [53:5]
  compiled code at target/run/keira_project/models/Staging/stg_events_o.sql
[0m11:36:23.809101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76221a00-1c3a-44c0-96f7-324a77cdf07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114367410>]}
[0m11:36:23.809698 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.stg_events_o ............... [[31mERROR[0m in 1.83s]
[0m11:36:23.810236 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_o
[0m11:36:23.812240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:23.812911 [debug] [MainThread]: Connection 'model.keira_project.stg_events_o' was properly closed.
[0m11:36:23.813647 [info ] [MainThread]: 
[0m11:36:23.814215 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m11:36:23.816027 [debug] [MainThread]: Command end result
[0m11:36:23.886541 [info ] [MainThread]: 
[0m11:36:23.887305 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:36:23.887892 [info ] [MainThread]: 
[0m11:36:23.888542 [error] [MainThread]:   Database Error in model stg_events_o (models/Staging/stg_events_o.sql)
  Unrecognized name: rsbp_total_limit; Did you mean rsvp_total_limit? at [53:5]
  compiled code at target/run/keira_project/models/Staging/stg_events_o.sql
[0m11:36:23.888904 [info ] [MainThread]: 
[0m11:36:23.889303 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:36:23.893614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.860774, "process_user_time": 2.708546, "process_kernel_time": 1.567963, "process_mem_max_rss": "209633280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:36:23.894418 [debug] [MainThread]: Command `dbt run` failed at 11:36:23.894246 after 5.86 seconds
[0m11:36:23.895009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114103330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114233cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114232fd0>]}
[0m11:36:23.895593 [debug] [MainThread]: Flushing usage events
[0m11:36:47.547004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103066660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c7ed0>]}


============================== 11:36:47.554693 | 885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134 ==============================
[0m11:36:47.554693 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:36:47.555364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_events_o', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:36:49.462988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd0fc0>]}
[0m11:36:49.555005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa1590>]}
[0m11:36:49.556302 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m11:36:49.761753 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:36:50.004494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:50.005805 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events_o.sql
[0m11:36:50.492729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b010550>]}
[0m11:36:50.684957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abefd40>]}
[0m11:36:50.686372 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m11:36:50.686903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b19a7b0>]}
[0m11:36:50.689478 [info ] [MainThread]: 
[0m11:36:50.690548 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:36:50.691697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m11:36:50.692210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:51.051148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m11:36:51.051546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:51.304111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0bf450>]}
[0m11:36:51.305009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:51.305570 [info ] [MainThread]: 
[0m11:36:51.310400 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_o
[0m11:36:51.311143 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_o ........................ [RUN]
[0m11:36:51.311966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_o)
[0m11:36:51.312600 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_o
[0m11:36:51.328868 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m11:36:51.330362 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_o
[0m11:36:51.406782 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m11:36:51.408347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:51.411446 [debug] [Thread-1 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(FARM_FINGERPRINT(
            CONCAT(event_name, CAST(group_id AS STRING), CAST(venue_id AS STRING), CAST(event_start_time AS STRING))) 
            AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsvp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m11:36:52.163816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f8bf6667-d394-4f8b-9bf9-203d43adaadd&page=queryresults
[0m11:36:57.286201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885d7fb9-ea2e-4455-b7cc-0cb9ed1a7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b181cd0>]}
[0m11:36:57.286808 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events_o ................... [[32mCREATE TABLE (174.1k rows, 12.1 MiB processed)[0m in 5.97s]
[0m11:36:57.287317 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_o
[0m11:36:57.288460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:57.288704 [debug] [MainThread]: Connection 'model.keira_project.stg_events_o' was properly closed.
[0m11:36:57.288923 [info ] [MainThread]: 
[0m11:36:57.289144 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m11:36:57.289637 [debug] [MainThread]: Command end result
[0m11:36:57.356780 [info ] [MainThread]: 
[0m11:36:57.357595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:57.358115 [info ] [MainThread]: 
[0m11:36:57.358781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:36:57.363043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.925613, "process_user_time": 2.68974, "process_kernel_time": 1.527565, "process_mem_max_rss": "208551936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:36:57.363936 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:57.363774 after 9.93 seconds
[0m11:36:57.364788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af2ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07fcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07efd0>]}
[0m11:36:57.365222 [debug] [MainThread]: Flushing usage events
[0m11:44:19.771529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ae7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ae7ed0>]}


============================== 11:44:19.778896 | 11976c90-fc7c-49e5-9caf-079573b8b69a ==============================
[0m11:44:19.778896 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:44:19.779829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_events', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:21.715587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11976c90-fc7c-49e5-9caf-079573b8b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122688fc0>]}
[0m11:44:21.807752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11976c90-fc7c-49e5-9caf-079573b8b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122459590>]}
[0m11:44:21.809217 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m11:44:21.991158 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:44:22.232378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:44:22.233555 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m11:44:22.686510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11976c90-fc7c-49e5-9caf-079573b8b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232e0550>]}
[0m11:44:22.886060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11976c90-fc7c-49e5-9caf-079573b8b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225a7d40>]}
[0m11:44:22.887133 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m11:44:22.887587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11976c90-fc7c-49e5-9caf-079573b8b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12354a350>]}
[0m11:44:22.890843 [info ] [MainThread]: 
[0m11:44:22.891759 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:44:22.893407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m11:44:22.894166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:23.342645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m11:44:23.343040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:23.613546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11976c90-fc7c-49e5-9caf-079573b8b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123477450>]}
[0m11:44:23.614072 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:44:23.614304 [info ] [MainThread]: 
[0m11:44:23.616910 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m11:44:23.617347 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m11:44:23.617726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m11:44:23.618005 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m11:44:23.627840 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m11:44:23.629503 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m11:44:23.657425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:23.972203 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m11:44:23.974251 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
        event_description
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.event_description,
        e.rsvp_total_limit,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m11:44:24.563637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d124c01f-1f16-45b4-90f1-3c749996ee2b&page=queryresults
[0m11:44:27.547005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11976c90-fc7c-49e5-9caf-079573b8b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12314a750>]}
[0m11:44:27.547561 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events ..................... [[32mCREATE TABLE (6.2k rows, 264.4 MiB processed)[0m in 3.93s]
[0m11:44:27.548110 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m11:44:27.549692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:27.550016 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m11:44:27.550378 [info ] [MainThread]: 
[0m11:44:27.550831 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m11:44:27.551609 [debug] [MainThread]: Command end result
[0m11:44:27.613807 [info ] [MainThread]: 
[0m11:44:27.614557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:27.615032 [info ] [MainThread]: 
[0m11:44:27.615498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:44:27.619341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9562244, "process_user_time": 2.694307, "process_kernel_time": 1.516135, "process_mem_max_rss": "208830464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:44:27.620085 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:27.619878 after 7.96 seconds
[0m11:44:27.620627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12353f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122653b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122650690>]}
[0m11:44:27.621403 [debug] [MainThread]: Flushing usage events
[0m11:49:16.280453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102936660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e7ed0>]}


============================== 11:49:16.288431 | 56655509-ff44-498f-a502-d11fe458e114 ==============================
[0m11:49:16.288431 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:49:16.289819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_events', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:18.224106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56655509-ff44-498f-a502-d11fe458e114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d588fc0>]}
[0m11:49:18.319615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56655509-ff44-498f-a502-d11fe458e114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d159590>]}
[0m11:49:18.320893 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m11:49:18.499004 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:49:18.739617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:18.741085 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m11:49:19.191645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56655509-ff44-498f-a502-d11fe458e114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d8e4550>]}
[0m11:49:19.394453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56655509-ff44-498f-a502-d11fe458e114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4a7d40>]}
[0m11:49:19.395229 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m11:49:19.395837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56655509-ff44-498f-a502-d11fe458e114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da56350>]}
[0m11:49:19.398388 [info ] [MainThread]: 
[0m11:49:19.399467 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:49:19.400947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m11:49:19.401371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:19.760400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m11:49:19.760796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:20.023643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56655509-ff44-498f-a502-d11fe458e114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d977ad0>]}
[0m11:49:20.024191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:49:20.024427 [info ] [MainThread]: 
[0m11:49:20.027014 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m11:49:20.027458 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m11:49:20.027792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m11:49:20.028079 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m11:49:20.040877 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m11:49:20.042348 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m11:49:20.069958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:20.380173 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m11:49:20.382545 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
        event_description
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
    WHERE event_id IS NOT NULL 
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.event_description,
        e.rsvp_total_limit,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    event_description,
    rsvp_total_limit,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m11:49:20.804321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:b3acbb57-691a-4de7-941f-71ef044950e0&page=queryresults
[0m11:49:24.079294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56655509-ff44-498f-a502-d11fe458e114', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da328d0>]}
[0m11:49:24.080722 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events ..................... [[32mCREATE TABLE (6.2k rows, 264.4 MiB processed)[0m in 4.05s]
[0m11:49:24.081876 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m11:49:24.084241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:24.085103 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m11:49:24.085606 [info ] [MainThread]: 
[0m11:49:24.086002 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m11:49:24.087043 [debug] [MainThread]: Command end result
[0m11:49:24.153769 [info ] [MainThread]: 
[0m11:49:24.154643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:24.155098 [info ] [MainThread]: 
[0m11:49:24.155399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:49:24.159006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9832954, "process_user_time": 2.702227, "process_kernel_time": 1.519956, "process_mem_max_rss": "209829888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:49:24.159948 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:24.159743 after 7.98 seconds
[0m11:49:24.160605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d803120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d553b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d550690>]}
[0m11:49:24.161150 [debug] [MainThread]: Flushing usage events
[0m11:55:10.910007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabed0>]}


============================== 11:55:10.918004 | b8ab1b12-78fa-48db-8732-b95ed1fbcb66 ==============================
[0m11:55:10.918004 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:55:10.919116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_events', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:55:12.853834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ab1b12-78fa-48db-8732-b95ed1fbcb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138188fc0>]}
[0m11:55:12.946438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ab1b12-78fa-48db-8732-b95ed1fbcb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff59590>]}
[0m11:55:12.947538 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m11:55:13.155489 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:55:13.393654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:13.394956 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m11:55:13.858659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ab1b12-78fa-48db-8732-b95ed1fbcb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1384c8550>]}
[0m11:55:14.059678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ab1b12-78fa-48db-8732-b95ed1fbcb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380a7d40>]}
[0m11:55:14.060609 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m11:55:14.061297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ab1b12-78fa-48db-8732-b95ed1fbcb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138656350>]}
[0m11:55:14.064747 [info ] [MainThread]: 
[0m11:55:14.065709 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:14.067106 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m11:55:14.067799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:14.437016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m11:55:14.437387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:14.688993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ab1b12-78fa-48db-8732-b95ed1fbcb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138577a00>]}
[0m11:55:14.689573 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:14.689810 [info ] [MainThread]: 
[0m11:55:14.694317 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m11:55:14.695318 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events .......................... [RUN]
[0m11:55:14.695887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events)
[0m11:55:14.696688 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m11:55:14.714259 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m11:55:14.715765 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m11:55:14.744272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.055676 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m11:55:15.057829 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
    WHERE event_id IS NOT NULL 
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.rsvp_total_limit,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    rsvp_total_limit,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m11:55:15.515286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:4db174b0-6fb6-4caf-a01c-71b093672da4&page=queryresults
[0m11:55:18.198303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ab1b12-78fa-48db-8732-b95ed1fbcb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13863e750>]}
[0m11:55:18.199651 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events ..................... [[32mCREATE TABLE (6.2k rows, 19.3 MiB processed)[0m in 3.50s]
[0m11:55:18.200542 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m11:55:18.202395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:18.202869 [debug] [MainThread]: Connection 'model.keira_project.stg_events' was properly closed.
[0m11:55:18.203509 [info ] [MainThread]: 
[0m11:55:18.204282 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m11:55:18.205456 [debug] [MainThread]: Command end result
[0m11:55:18.273586 [info ] [MainThread]: 
[0m11:55:18.274404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:18.274918 [info ] [MainThread]: 
[0m11:55:18.275323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:55:18.278781 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4742126, "process_user_time": 2.692396, "process_kernel_time": 1.54227, "process_mem_max_rss": "209371136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:18.279636 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:18.279529 after 7.48 seconds
[0m11:55:18.280191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138403120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138153b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138150690>]}
[0m11:55:18.280746 [debug] [MainThread]: Flushing usage events
[0m12:03:32.085273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c26660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be7ed0>]}


============================== 12:03:32.093689 | b4fc4489-bcc5-4c92-8b5e-deb3d16b319c ==============================
[0m12:03:32.093689 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:03:32.094735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_events_rsvp', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:34.025034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4fc4489-bcc5-4c92-8b5e-deb3d16b319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd88fc0>]}
[0m12:03:34.124389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4fc4489-bcc5-4c92-8b5e-deb3d16b319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb59590>]}
[0m12:03:34.125620 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:03:34.321891 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:03:34.567227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:34.568848 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events_rsvp.sql
[0m12:03:35.016368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4fc4489-bcc5-4c92-8b5e-deb3d16b319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1c8550>]}
[0m12:03:35.214378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4fc4489-bcc5-4c92-8b5e-deb3d16b319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bca7d40>]}
[0m12:03:35.215402 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:03:35.215886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4fc4489-bcc5-4c92-8b5e-deb3d16b319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c356970>]}
[0m12:03:35.218609 [info ] [MainThread]: 
[0m12:03:35.219531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:03:35.221260 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:03:35.221977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:35.717111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:03:35.717521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:35.968767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4fc4489-bcc5-4c92-8b5e-deb3d16b319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c277a00>]}
[0m12:03:35.969263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:35.969510 [info ] [MainThread]: 
[0m12:03:35.973708 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m12:03:35.974651 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m12:03:35.975570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_rsvp)
[0m12:03:35.976162 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m12:03:35.992394 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m12:03:35.994003 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m12:03:36.021748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:36.337297 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m12:03:36.339136 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM `keira-xebia`.`meetupservice`.`stg_events_o`
    );
  
[0m12:03:36.824907 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:60402b50-5a03-4376-9c47-e7535c68913b&page=queryresults
[0m12:03:40.042015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4fc4489-bcc5-4c92-8b5e-deb3d16b319c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c05e750>]}
[0m12:03:40.042862 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_events_rsvp ................ [[32mCREATE TABLE (174.1k rows, 20.4 MiB processed)[0m in 4.07s]
[0m12:03:40.043945 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m12:03:40.045973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:40.046450 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m12:03:40.046769 [info ] [MainThread]: 
[0m12:03:40.047103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m12:03:40.048611 [debug] [MainThread]: Command end result
[0m12:03:40.112067 [info ] [MainThread]: 
[0m12:03:40.112923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:40.113628 [info ] [MainThread]: 
[0m12:03:40.114206 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:40.118126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.142257, "process_user_time": 2.685478, "process_kernel_time": 1.528526, "process_mem_max_rss": "209256448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:03:40.118866 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:40.118713 after 8.14 seconds
[0m12:03:40.119592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c342c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd53b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd50690>]}
[0m12:03:40.120124 [debug] [MainThread]: Flushing usage events
[0m12:03:54.870685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ae7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ae7ed0>]}


============================== 12:03:54.878481 | 7309e90c-3125-4fdd-b1ba-19bfa52936b2 ==============================
[0m12:03:54.878481 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:03:54.879864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:56.660353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148f88fc0>]}
[0m12:03:56.757822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148d59590>]}
[0m12:03:56.759168 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:03:56.972841 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:03:57.221486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:57.222160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:57.305977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148e75850>]}
[0m12:03:57.518175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148ea7d40>]}
[0m12:03:57.519031 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:03:57.519772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148f01d30>]}
[0m12:03:57.523971 [info ] [MainThread]: 
[0m12:03:57.525057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:03:57.533717 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:03:57.534527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:57.871773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:03:57.872176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:58.110829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c07860>]}
[0m12:03:58.111801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:58.112211 [info ] [MainThread]: 
[0m12:03:58.116907 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m12:03:58.117701 [debug] [Thread-3 (]: Began running node model.keira_project.stg_groups
[0m12:03:58.118053 [debug] [Thread-4 (]: Began running node model.keira_project.stg_users
[0m12:03:58.118527 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_o
[0m12:03:58.119273 [info ] [Thread-1 (]: 1 of 14 START sql table model meetupservice.my_first_dbt_model ................. [RUN]
[0m12:03:58.120244 [info ] [Thread-3 (]: 3 of 14 START sql table model meetupservice.stg_groups ......................... [RUN]
[0m12:03:58.120989 [info ] [Thread-4 (]: 4 of 14 START sql table model meetupservice.stg_users .......................... [RUN]
[0m12:03:58.121696 [info ] [Thread-2 (]: 2 of 14 START sql table model meetupservice.stg_events_o ....................... [RUN]
[0m12:03:58.122397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m12:03:58.122992 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.stg_groups'
[0m12:03:58.123606 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.stg_users'
[0m12:03:58.124187 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.stg_events_o'
[0m12:03:58.124670 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m12:03:58.125094 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_groups
[0m12:03:58.125615 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_users
[0m12:03:58.126267 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_o
[0m12:03:58.151196 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m12:03:58.156259 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m12:03:58.158711 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m12:03:58.165225 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m12:03:58.167716 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_groups
[0m12:03:58.168268 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m12:03:58.175014 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_o
[0m12:03:58.175559 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_users
[0m12:03:58.225549 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:03:58.241069 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:03:58.433212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:58.434661 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:03:58.895443 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m12:03:58.902671 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m12:03:58.907465 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_first_dbt_model"
[0m12:03:58.910494 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m12:03:58.911774 [debug] [Thread-3 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_year, 
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m12:03:58.912564 [debug] [Thread-4 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown
    FROM `keira-xebia`.`meetupservice`.`source_users`   
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM users
    );
  
[0m12:03:58.915735 [debug] [Thread-1 (]: On model.keira_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_first_dbt_model"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m12:03:58.918064 [debug] [Thread-2 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(FARM_FINGERPRINT(
            CONCAT(event_name, CAST(group_id AS STRING), CAST(venue_id AS STRING), CAST(event_start_time AS STRING))) 
            AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsvp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m12:03:59.288875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:66cfd3fc-5c90-4b1f-aecd-124297732b12&page=queryresults
[0m12:03:59.289405 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:42c03560-6609-4445-9687-31116dc24da0&page=queryresults
[0m12:03:59.355336 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:fc24d075-eec1-4e4b-9483-e0ac5b0d13ac&page=queryresults
[0m12:03:59.357424 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:51981616-f9ab-4d46-9f5a-94fa2f9e15d9&page=queryresults
[0m12:04:01.568850 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c6a990>]}
[0m12:04:01.569693 [info ] [Thread-3 (]: 3 of 14 OK created sql table model meetupservice.stg_groups .................... [[32mCREATE TABLE (711.0 rows, 442.7 KiB processed)[0m in 3.45s]
[0m12:04:01.570956 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_groups
[0m12:04:01.571663 [debug] [Thread-3 (]: Began running node model.keira_project.stg_users_groups
[0m12:04:01.572355 [info ] [Thread-3 (]: 5 of 14 START sql table model meetupservice.stg_users_groups ................... [RUN]
[0m12:04:01.573266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_groups, now model.keira_project.stg_users_groups)
[0m12:04:01.573865 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_users_groups
[0m12:04:01.580607 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m12:04:01.584564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c7df40>]}
[0m12:04:01.585554 [info ] [Thread-1 (]: 1 of 14 OK created sql table model meetupservice.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.46s]
[0m12:04:01.586447 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m12:04:01.587026 [debug] [Thread-1 (]: Began running node model.keira_project.stg_venues
[0m12:04:01.588339 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_users_groups
[0m12:04:01.591957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:04:01.587770 [info ] [Thread-1 (]: 6 of 14 START sql table model meetupservice.stg_venues ......................... [RUN]
[0m12:04:01.684178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_first_dbt_model, now model.keira_project.stg_venues)
[0m12:04:01.685139 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_venues
[0m12:04:01.691798 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_venues"
[0m12:04:01.693943 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_venues
[0m12:04:01.697959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:01.952512 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_venues"
[0m12:04:01.953830 [debug] [Thread-1 (]: On model.keira_project.stg_venues: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_venues"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_venues`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    venue_id,
    name AS venue_name,
    city AS venue_city,
    country AS venue_country,
    lat AS venue_lat,
    lon AS venue_lon
FROM `keira-xebia`.`meetupservice`.`source_venues`
    );
  
[0m12:04:01.969703 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m12:04:01.970967 [debug] [Thread-3 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        EXTRACT(YEAR FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_year, 
        EXTRACT(MONTH FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_month
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM usergroup
    );
  
[0m12:04:02.007892 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149e1d270>]}
[0m12:04:02.009020 [info ] [Thread-4 (]: 4 of 14 OK created sql table model meetupservice.stg_users ..................... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.88s]
[0m12:04:02.010049 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_users
[0m12:04:02.010940 [debug] [Thread-4 (]: Began running node model.keira_project.certified_groups
[0m12:04:02.011816 [info ] [Thread-4 (]: 7 of 14 START sql table model meetupservice.certified_groups ................... [RUN]
[0m12:04:02.012227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users, now model.keira_project.certified_groups)
[0m12:04:02.012846 [debug] [Thread-4 (]: Began compiling node model.keira_project.certified_groups
[0m12:04:02.026566 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.certified_groups"
[0m12:04:02.028682 [debug] [Thread-4 (]: Began executing node model.keira_project.certified_groups
[0m12:04:02.032413 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:04:02.286365 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.certified_groups"
[0m12:04:02.287639 [debug] [Thread-4 (]: On model.keira_project.certified_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_groups`
      
    
    

    OPTIONS()
    as (
      


SELECT 
    group_id, --unique identifier of a group
    group_name,
    group_created_year,
    group_created_month,
    group_description,
    group_city,
    group_lat,
    group_lon
FROM `keira-xebia`.`meetupservice`.`stg_groups`
    );
  
[0m12:04:02.382173 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:3ed67e83-0606-453d-b9b4-3c9946643b46&page=queryresults
[0m12:04:02.398769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:66b1dd51-2090-4cf5-ab2d-e9be179cf446&page=queryresults
[0m12:04:02.769113 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:29b9262a-0da3-4959-ae3e-314f3e8aca9a&page=queryresults
[0m12:04:04.696734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b51bd0>]}
[0m12:04:04.697323 [info ] [Thread-1 (]: 6 of 14 OK created sql table model meetupservice.stg_venues .................... [[32mCREATE TABLE (1.7k rows, 97.0 KiB processed)[0m in 3.01s]
[0m12:04:04.697822 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_venues
[0m12:04:04.698154 [debug] [Thread-1 (]: Began running node model.keira_project.my_second_dbt_model
[0m12:04:04.698479 [info ] [Thread-1 (]: 8 of 14 START sql view model meetupservice.my_second_dbt_model ................. [RUN]
[0m12:04:04.698834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_venues, now model.keira_project.my_second_dbt_model)
[0m12:04:04.699091 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m12:04:04.701717 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m12:04:04.702332 [debug] [Thread-1 (]: Began executing node model.keira_project.my_second_dbt_model
[0m12:04:04.728302 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_second_dbt_model"
[0m12:04:04.729650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:04.732029 [debug] [Thread-1 (]: On model.keira_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_second_dbt_model"} */


  create or replace view `keira-xebia`.`meetupservice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `keira-xebia`.`meetupservice`.`my_first_dbt_model`
where id = 1;


[0m12:04:04.828354 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d55390>]}
[0m12:04:04.829611 [info ] [Thread-2 (]: 2 of 14 OK created sql table model meetupservice.stg_events_o .................. [[32mCREATE TABLE (174.1k rows, 12.1 MiB processed)[0m in 6.70s]
[0m12:04:04.831130 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_o
[0m12:04:04.832013 [debug] [Thread-2 (]: Began running node model.keira_project.certified_users
[0m12:04:04.833019 [info ] [Thread-2 (]: 9 of 14 START sql table model meetupservice.certified_users .................... [RUN]
[0m12:04:04.834827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_o, now model.keira_project.certified_users)
[0m12:04:04.835817 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_users
[0m12:04:04.844297 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_users"
[0m12:04:04.846725 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_users
[0m12:04:04.850555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:04:05.116557 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_users"
[0m12:04:05.118531 [debug] [Thread-2 (]: On model.keira_project.certified_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM `keira-xebia`.`meetupservice`.`stg_users`
    );
  
[0m12:04:05.188280 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d2a030>]}
[0m12:04:05.188809 [info ] [Thread-3 (]: 5 of 14 OK created sql table model meetupservice.stg_users_groups .............. [[32mCREATE TABLE (145.5k rows, 4.5 MiB processed)[0m in 3.62s]
[0m12:04:05.189294 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_users_groups
[0m12:04:05.189619 [debug] [Thread-3 (]: Began running node model.keira_project.stg_events
[0m12:04:05.190007 [info ] [Thread-3 (]: 10 of 14 START sql table model meetupservice.stg_events ........................ [RUN]
[0m12:04:05.190385 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users_groups, now model.keira_project.stg_events)
[0m12:04:05.190642 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_events
[0m12:04:05.193890 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m12:04:05.194544 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_events
[0m12:04:05.196120 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:04:05.372307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:56df6a0d-d520-41b9-b95c-b1fb181834c3&page=queryresults
[0m12:04:05.390419 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149add850>]}
[0m12:04:05.391467 [info ] [Thread-4 (]: 7 of 14 OK created sql table model meetupservice.certified_groups .............. [[32mCREATE TABLE (711.0 rows, 448.3 KiB processed)[0m in 3.38s]
[0m12:04:05.392309 [debug] [Thread-4 (]: Finished running node model.keira_project.certified_groups
[0m12:04:05.393019 [debug] [Thread-4 (]: Began running node model.keira_project.stg_events_rsvp
[0m12:04:05.393804 [info ] [Thread-4 (]: 11 of 14 START sql table model meetupservice.stg_events_rsvp ................... [RUN]
[0m12:04:05.394339 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_groups, now model.keira_project.stg_events_rsvp)
[0m12:04:05.395048 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m12:04:05.400175 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m12:04:05.401294 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_events_rsvp
[0m12:04:05.406208 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:04:05.502795 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m12:04:05.505529 [debug] [Thread-3 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
    WHERE event_id IS NOT NULL 
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.rsvp_total_limit,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    rsvp_total_limit,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m12:04:05.557051 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0985106f-91b9-4c92-bbb1-2fcbdaf4755c&page=queryresults
[0m12:04:05.675816 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m12:04:05.677195 [debug] [Thread-4 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM `keira-xebia`.`meetupservice`.`stg_events_o`
    );
  
[0m12:04:05.682077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c77b30>]}
[0m12:04:05.684172 [info ] [Thread-1 (]: 8 of 14 OK created sql view model meetupservice.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m12:04:05.685491 [debug] [Thread-1 (]: Finished running node model.keira_project.my_second_dbt_model
[0m12:04:05.686626 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m12:04:05.687585 [info ] [Thread-1 (]: 12 of 14 START sql table model meetupservice.certified_users_groups ............ [RUN]
[0m12:04:05.688615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_second_dbt_model, now model.keira_project.certified_users_groups)
[0m12:04:05.689470 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m12:04:05.695260 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m12:04:05.696726 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m12:04:05.701034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:05.905240 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f63cedfa-f7de-421e-aae5-7510999ac531&page=queryresults
[0m12:04:05.945575 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m12:04:05.947144 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
    );
  
[0m12:04:06.075505 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:18dbcef5-5c7d-45b0-b7cc-d4cd5b3ac43f&page=queryresults
[0m12:04:06.394776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2d99e33c-37ab-4412-8db9-298fe372be89&page=queryresults
[0m12:04:08.096449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d0c050>]}
[0m12:04:08.096988 [info ] [Thread-2 (]: 9 of 14 OK created sql table model meetupservice.certified_users ............... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.26s]
[0m12:04:08.097424 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_users
[0m12:04:08.991088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d0c470>]}
[0m12:04:08.991641 [info ] [Thread-3 (]: 10 of 14 OK created sql table model meetupservice.stg_events ................... [[32mCREATE TABLE (6.2k rows, 19.3 MiB processed)[0m in 3.80s]
[0m12:04:08.992077 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_events
[0m12:04:09.024711 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d0d550>]}
[0m12:04:09.025239 [info ] [Thread-4 (]: 11 of 14 OK created sql table model meetupservice.stg_events_rsvp .............. [[32mCREATE TABLE (174.1k rows, 20.4 MiB processed)[0m in 3.63s]
[0m12:04:09.025743 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_events_rsvp
[0m12:04:09.026157 [debug] [Thread-2 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:04:09.026564 [info ] [Thread-2 (]: 13 of 14 START sql table model meetupservice.certified_events_users_rsvp ....... [RUN]
[0m12:04:09.026939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_users, now model.keira_project.certified_events_users_rsvp)
[0m12:04:09.027203 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:04:09.030332 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:04:09.032057 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:04:09.034510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:04:09.290757 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m12:04:09.292336 [debug] [Thread-2 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m12:04:09.318479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d0e450>]}
[0m12:04:09.319622 [info ] [Thread-1 (]: 12 of 14 OK created sql table model meetupservice.certified_users_groups ....... [[32mCREATE TABLE (145.5k rows, 6.3 MiB processed)[0m in 3.63s]
[0m12:04:09.320482 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m12:04:09.733083 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1aa8cc25-097d-4109-b2ab-8a85cab007ae&page=queryresults
[0m12:04:14.218056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d0d490>]}
[0m12:04:14.218669 [info ] [Thread-2 (]: 13 of 14 OK created sql table model meetupservice.certified_events_users_rsvp .. [[32mCREATE TABLE (174.0k rows, 18.2 MiB processed)[0m in 5.19s]
[0m12:04:14.219184 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:04:14.219762 [debug] [Thread-3 (]: Began running node model.keira_project.certified_events
[0m12:04:14.220168 [info ] [Thread-3 (]: 14 of 14 START sql table model meetupservice.certified_events .................. [RUN]
[0m12:04:14.220556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events, now model.keira_project.certified_events)
[0m12:04:14.220820 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_events
[0m12:04:14.223961 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:04:14.225836 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_events
[0m12:04:14.228055 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:04:14.469758 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m12:04:14.472600 [debug] [Thread-3 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_date = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m12:04:14.955567 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2b4289b6-cb31-424c-9d22-06560d0c4718&page=queryresults
[0m12:04:15.035065 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event_description; Did you mean event_duration? at [59:9]; reason: invalidQuery, location: query, message: Unrecognized name: event_description; Did you mean event_duration? at [59:9]')
[0m12:04:16.286451 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0ede7562-cd5b-443f-ad3a-0ee1e04e60f3&page=queryresults
[0m12:04:16.371772 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0ede7562-cd5b-443f-ad3a-0ee1e04e60f3&page=queryresults
[0m12:04:16.383513 [debug] [Thread-3 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: event_description; Did you mean event_duration? at [59:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m12:04:16.383943 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7309e90c-3125-4fdd-b1ba-19bfa52936b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149e7aab0>]}
[0m12:04:16.384405 [error] [Thread-3 (]: 14 of 14 ERROR creating sql table model meetupservice.certified_events ......... [[31mERROR[0m in 2.16s]
[0m12:04:16.384817 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_events
[0m12:04:16.386314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:16.386560 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m12:04:16.386739 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m12:04:16.386908 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m12:04:16.387070 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m12:04:16.387338 [info ] [MainThread]: 
[0m12:04:16.387937 [info ] [MainThread]: Finished running 13 table models, 1 view model in 0 hours 0 minutes and 18.86 seconds (18.86s).
[0m12:04:16.392756 [debug] [MainThread]: Command end result
[0m12:04:16.451481 [info ] [MainThread]: 
[0m12:04:16.452350 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:04:16.452775 [info ] [MainThread]: 
[0m12:04:16.453424 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  Unrecognized name: event_description; Did you mean event_duration? at [59:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m12:04:16.453991 [info ] [MainThread]: 
[0m12:04:16.454470 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m12:04:16.458297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 21.69077, "process_user_time": 3.556683, "process_kernel_time": 1.796896, "process_mem_max_rss": "207732736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:04:16.459078 [debug] [MainThread]: Command `dbt run` failed at 12:04:16.458953 after 21.69 seconds
[0m12:04:16.459525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148fae690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148f06870>]}
[0m12:04:16.460038 [debug] [MainThread]: Flushing usage events
[0m12:05:30.911051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104886660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7ed0>]}


============================== 12:05:30.919249 | 0f22718b-1938-4d86-8bec-4a8d247bd100 ==============================
[0m12:05:30.919249 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:05:30.920468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:05:32.852615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116388fc0>]}
[0m12:05:32.946718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116059590>]}
[0m12:05:32.948015 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:05:33.180158 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:05:33.428496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:33.429779 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m12:05:33.876297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166e4550>]}
[0m12:05:34.069765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161a7d40>]}
[0m12:05:34.070744 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:05:34.071240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168567b0>]}
[0m12:05:34.076162 [info ] [MainThread]: 
[0m12:05:34.077180 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:05:34.086492 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:05:34.087255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:34.459166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:05:34.459561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:34.695449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116777a00>]}
[0m12:05:34.696282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:34.697057 [info ] [MainThread]: 
[0m12:05:34.701972 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m12:05:34.703380 [debug] [Thread-4 (]: Began running node model.keira_project.stg_users
[0m12:05:34.704759 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_o
[0m12:05:34.702960 [info ] [Thread-1 (]: 1 of 14 START sql table model meetupservice.my_first_dbt_model ................. [RUN]
[0m12:05:34.707172 [debug] [Thread-3 (]: Began running node model.keira_project.stg_groups
[0m12:05:34.705632 [info ] [Thread-4 (]: 4 of 14 START sql table model meetupservice.stg_users .......................... [RUN]
[0m12:05:34.708253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m12:05:34.706418 [info ] [Thread-2 (]: 2 of 14 START sql table model meetupservice.stg_events_o ....................... [RUN]
[0m12:05:34.709161 [info ] [Thread-3 (]: 3 of 14 START sql table model meetupservice.stg_groups ......................... [RUN]
[0m12:05:34.710048 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.stg_users'
[0m12:05:34.710668 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m12:05:34.711433 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.stg_events_o'
[0m12:05:34.712251 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.stg_groups'
[0m12:05:34.712932 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_users
[0m12:05:34.725421 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_o
[0m12:05:34.728993 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m12:05:34.729703 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_groups
[0m12:05:34.734754 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m12:05:34.741217 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m12:05:34.746823 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m12:05:34.748391 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_groups
[0m12:05:34.754796 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_users
[0m12:05:34.755391 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m12:05:34.769636 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_o
[0m12:05:34.836573 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:05:34.838035 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:05:34.846714 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:05:34.847843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:35.503469 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m12:05:35.504570 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_first_dbt_model"
[0m12:05:35.505227 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m12:05:35.509010 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m12:05:35.511053 [debug] [Thread-4 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown
    FROM `keira-xebia`.`meetupservice`.`source_users`   
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM users
    );
  
[0m12:05:35.513057 [debug] [Thread-3 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_year, 
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m12:05:35.514085 [debug] [Thread-1 (]: On model.keira_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_first_dbt_model"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m12:05:35.516676 [debug] [Thread-2 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(FARM_FINGERPRINT(
            CONCAT(event_name, CAST(group_id AS STRING), CAST(venue_id AS STRING), CAST(event_start_time AS STRING))) 
            AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsvp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m12:05:35.954346 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1e3a4965-fcc2-4e82-a4f6-57994a7e8cb7&page=queryresults
[0m12:05:35.954846 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:727f9131-6f9e-41a8-82bb-5d0afae9c04a&page=queryresults
[0m12:05:35.955740 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:82e36007-593a-4673-bf90-65bd19030346&page=queryresults
[0m12:05:35.956409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d88399d7-c361-4ae1-bfcf-b299e4dd025e&page=queryresults
[0m12:05:38.219639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11655f410>]}
[0m12:05:38.221037 [info ] [Thread-1 (]: 1 of 14 OK created sql table model meetupservice.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.51s]
[0m12:05:38.222409 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m12:05:38.223097 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users_groups
[0m12:05:38.224320 [info ] [Thread-1 (]: 5 of 14 START sql table model meetupservice.stg_users_groups ................... [RUN]
[0m12:05:38.225002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_first_dbt_model, now model.keira_project.stg_users_groups)
[0m12:05:38.225453 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users_groups
[0m12:05:38.230655 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m12:05:38.232834 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users_groups
[0m12:05:38.236169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:38.496569 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m12:05:38.498253 [debug] [Thread-1 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        EXTRACT(YEAR FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_year, 
        EXTRACT(MONTH FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_month
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM usergroup
    );
  
[0m12:05:38.514364 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116843960>]}
[0m12:05:38.515282 [info ] [Thread-4 (]: 4 of 14 OK created sql table model meetupservice.stg_users ..................... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.80s]
[0m12:05:38.516252 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_users
[0m12:05:38.516774 [debug] [Thread-4 (]: Began running node model.keira_project.stg_venues
[0m12:05:38.517760 [info ] [Thread-4 (]: 6 of 14 START sql table model meetupservice.stg_venues ......................... [RUN]
[0m12:05:38.518333 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users, now model.keira_project.stg_venues)
[0m12:05:38.518887 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_venues
[0m12:05:38.524123 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_venues"
[0m12:05:38.525660 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_venues
[0m12:05:38.529310 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:05:38.625837 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163354f0>]}
[0m12:05:38.627268 [info ] [Thread-3 (]: 3 of 14 OK created sql table model meetupservice.stg_groups .................... [[32mCREATE TABLE (711.0 rows, 442.7 KiB processed)[0m in 3.91s]
[0m12:05:38.628586 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_groups
[0m12:05:38.629146 [debug] [Thread-3 (]: Began running node model.keira_project.my_second_dbt_model
[0m12:05:38.630011 [info ] [Thread-3 (]: 7 of 14 START sql view model meetupservice.my_second_dbt_model ................. [RUN]
[0m12:05:38.631061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_groups, now model.keira_project.my_second_dbt_model)
[0m12:05:38.631893 [debug] [Thread-3 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m12:05:38.637666 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m12:05:38.639103 [debug] [Thread-3 (]: Began executing node model.keira_project.my_second_dbt_model
[0m12:05:38.681076 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.my_second_dbt_model"
[0m12:05:38.683135 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:05:38.685683 [debug] [Thread-3 (]: On model.keira_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_second_dbt_model"} */


  create or replace view `keira-xebia`.`meetupservice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `keira-xebia`.`meetupservice`.`my_first_dbt_model`
where id = 1;


[0m12:05:38.809439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2dade1fd-27cc-42e7-a8df-a09da9553300&page=queryresults
[0m12:05:38.894232 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_venues"
[0m12:05:38.896462 [debug] [Thread-4 (]: On model.keira_project.stg_venues: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_venues"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_venues`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    venue_id,
    name AS venue_name,
    city AS venue_city,
    country AS venue_country,
    lat AS venue_lat,
    lon AS venue_lon
FROM `keira-xebia`.`meetupservice`.`source_venues`
    );
  
[0m12:05:39.317721 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f0a2402e-e73f-4589-8aee-ea04163cd711&page=queryresults
[0m12:05:39.428462 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:8e0cbaf5-4b05-4b7c-a548-3ca9a3f5de69&page=queryresults
[0m12:05:39.521669 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168fb850>]}
[0m12:05:39.522211 [info ] [Thread-3 (]: 7 of 14 OK created sql view model meetupservice.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m12:05:39.522690 [debug] [Thread-3 (]: Finished running node model.keira_project.my_second_dbt_model
[0m12:05:39.523024 [debug] [Thread-3 (]: Began running node model.keira_project.certified_users
[0m12:05:39.523354 [info ] [Thread-3 (]: 8 of 14 START sql table model meetupservice.certified_users .................... [RUN]
[0m12:05:39.523744 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.my_second_dbt_model, now model.keira_project.certified_users)
[0m12:05:39.523982 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_users
[0m12:05:39.526454 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_users"
[0m12:05:39.527738 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_users
[0m12:05:39.529410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:05:39.782336 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_users"
[0m12:05:39.783209 [debug] [Thread-3 (]: On model.keira_project.certified_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM `keira-xebia`.`meetupservice`.`stg_users`
    );
  
[0m12:05:40.159695 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:03872356-602b-40e1-bcc3-7e6d9af82b0e&page=queryresults
[0m12:05:41.174421 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11684ae40>]}
[0m12:05:41.174986 [info ] [Thread-2 (]: 2 of 14 OK created sql table model meetupservice.stg_events_o .................. [[32mCREATE TABLE (174.1k rows, 12.1 MiB processed)[0m in 6.46s]
[0m12:05:41.175471 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_o
[0m12:05:41.175801 [debug] [Thread-2 (]: Began running node model.keira_project.certified_groups
[0m12:05:41.176261 [info ] [Thread-2 (]: 9 of 14 START sql table model meetupservice.certified_groups ................... [RUN]
[0m12:05:41.176660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_o, now model.keira_project.certified_groups)
[0m12:05:41.176916 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_groups
[0m12:05:41.179352 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_groups"
[0m12:05:41.182279 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_groups
[0m12:05:41.184183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:41.281210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168a3410>]}
[0m12:05:41.282292 [info ] [Thread-1 (]: 5 of 14 OK created sql table model meetupservice.stg_users_groups .............. [[32mCREATE TABLE (145.5k rows, 4.5 MiB processed)[0m in 3.06s]
[0m12:05:41.283092 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users_groups
[0m12:05:41.283871 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events
[0m12:05:41.284604 [info ] [Thread-1 (]: 10 of 14 START sql table model meetupservice.stg_events ........................ [RUN]
[0m12:05:41.285281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users_groups, now model.keira_project.stg_events)
[0m12:05:41.285965 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events
[0m12:05:41.293276 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m12:05:41.294706 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events
[0m12:05:41.298428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:41.544039 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_groups"
[0m12:05:41.545976 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m12:05:41.547146 [debug] [Thread-1 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
        event_description
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
    WHERE event_id IS NOT NULL 
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.rsvp_total_limit,
        e.event_description
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    rsvp_total_limit,
    event_description,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m12:05:41.548831 [debug] [Thread-2 (]: On model.keira_project.certified_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_groups`
      
    
    

    OPTIONS()
    as (
      


SELECT 
    group_id, --unique identifier of a group
    group_name,
    group_created_year,
    group_created_month,
    group_description,
    group_city,
    group_lat,
    group_lon
FROM `keira-xebia`.`meetupservice`.`stg_groups`
    );
  
[0m12:05:41.808059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:3a536a26-30ee-45fa-b135-aa7675f8d934&page=queryresults
[0m12:05:41.808637 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "." at [56:10]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "." at [56:10]')
[0m12:05:41.971939 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163042f0>]}
[0m12:05:41.972482 [info ] [Thread-4 (]: 6 of 14 OK created sql table model meetupservice.stg_venues .................... [[32mCREATE TABLE (1.7k rows, 97.0 KiB processed)[0m in 3.45s]
[0m12:05:41.972953 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_venues
[0m12:05:41.973267 [debug] [Thread-4 (]: Began running node model.keira_project.stg_events_rsvp
[0m12:05:41.973620 [info ] [Thread-4 (]: 11 of 14 START sql table model meetupservice.stg_events_rsvp ................... [RUN]
[0m12:05:41.973934 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_venues, now model.keira_project.stg_events_rsvp)
[0m12:05:41.974181 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m12:05:41.976962 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m12:05:41.977593 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_events_rsvp
[0m12:05:41.979199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:05:42.119395 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2edce3e1-2634-4480-837b-b539887fcd4d&page=queryresults
[0m12:05:42.175940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:7348bba0-34ba-4d26-a94d-3a09835e7f81&page=queryresults
[0m12:05:42.176938 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:7348bba0-34ba-4d26-a94d-3a09835e7f81&page=queryresults
[0m12:05:42.196987 [debug] [Thread-1 (]: Database Error in model stg_events (models/Staging/stg_events.sql)
  Syntax error: Expected ")" but got "." at [56:10]
  compiled code at target/run/keira_project/models/Staging/stg_events.sql
[0m12:05:42.197733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116be6450>]}
[0m12:05:42.198760 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model meetupservice.stg_events ............... [[31mERROR[0m in 0.91s]
[0m12:05:42.199348 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events
[0m12:05:42.199954 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m12:05:42.200413 [info ] [Thread-1 (]: 12 of 14 START sql table model meetupservice.certified_users_groups ............ [RUN]
[0m12:05:42.202408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events, now model.keira_project.certified_users_groups)
[0m12:05:42.203005 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m12:05:42.208413 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m12:05:42.210010 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m12:05:42.214882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:42.309247 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m12:05:42.311399 [debug] [Thread-4 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM `keira-xebia`.`meetupservice`.`stg_events_o`
    );
  
[0m12:05:42.465984 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m12:05:42.467532 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
    );
  
[0m12:05:42.877798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:af92b3d4-ca24-46ae-9216-db33ebc1fd74&page=queryresults
[0m12:05:43.006005 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169fa030>]}
[0m12:05:43.006560 [info ] [Thread-3 (]: 8 of 14 OK created sql table model meetupservice.certified_users ............... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.48s]
[0m12:05:43.007048 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_users
[0m12:05:43.110499 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:c80aaa7e-afc4-4256-824c-5c40e6f83abb&page=queryresults
[0m12:05:45.049118 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169f8710>]}
[0m12:05:45.049691 [info ] [Thread-2 (]: 9 of 14 OK created sql table model meetupservice.certified_groups .............. [[32mCREATE TABLE (711.0 rows, 448.3 KiB processed)[0m in 3.87s]
[0m12:05:45.050173 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_groups
[0m12:05:45.430913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c3c410>]}
[0m12:05:45.431492 [info ] [Thread-1 (]: 12 of 14 OK created sql table model meetupservice.certified_users_groups ....... [[32mCREATE TABLE (145.5k rows, 6.3 MiB processed)[0m in 3.23s]
[0m12:05:45.431937 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m12:05:47.011556 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169fb3b0>]}
[0m12:05:47.012097 [info ] [Thread-4 (]: 11 of 14 OK created sql table model meetupservice.stg_events_rsvp .............. [[32mCREATE TABLE (174.1k rows, 20.4 MiB processed)[0m in 5.04s]
[0m12:05:47.012536 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_events_rsvp
[0m12:05:47.013116 [debug] [Thread-3 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:05:47.013467 [info ] [Thread-3 (]: 13 of 14 START sql table model meetupservice.certified_events_users_rsvp ....... [RUN]
[0m12:05:47.013800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_users, now model.keira_project.certified_events_users_rsvp)
[0m12:05:47.014081 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:05:47.018228 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:05:47.018948 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:05:47.020644 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:05:47.277242 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m12:05:47.279278 [debug] [Thread-3 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m12:05:48.138957 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:67195493-680e-481c-8dbb-a07909a8a4a9&page=queryresults
[0m12:05:52.309373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f22718b-1938-4d86-8bec-4a8d247bd100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c6fe30>]}
[0m12:05:52.309932 [info ] [Thread-3 (]: 13 of 14 OK created sql table model meetupservice.certified_events_users_rsvp .. [[32mCREATE TABLE (174.0k rows, 18.2 MiB processed)[0m in 5.30s]
[0m12:05:52.310369 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:05:52.310956 [debug] [Thread-2 (]: Began running node model.keira_project.certified_events
[0m12:05:52.311295 [info ] [Thread-2 (]: 14 of 14 SKIP relation meetupservice.certified_events .......................... [[33mSKIP[0m]
[0m12:05:52.311667 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_events
[0m12:05:52.313173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:52.313584 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m12:05:52.313783 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m12:05:52.313980 [debug] [MainThread]: Connection 'model.keira_project.certified_groups' was properly closed.
[0m12:05:52.314158 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m12:05:52.314447 [info ] [MainThread]: 
[0m12:05:52.314685 [info ] [MainThread]: Finished running 13 table models, 1 view model in 0 hours 0 minutes and 18.24 seconds (18.24s).
[0m12:05:52.316613 [debug] [MainThread]: Command end result
[0m12:05:52.385771 [info ] [MainThread]: 
[0m12:05:52.386418 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:05:52.387060 [info ] [MainThread]: 
[0m12:05:52.387626 [error] [MainThread]:   Database Error in model stg_events (models/Staging/stg_events.sql)
  Syntax error: Expected ")" but got "." at [56:10]
  compiled code at target/run/keira_project/models/Staging/stg_events.sql
[0m12:05:52.388051 [info ] [MainThread]: 
[0m12:05:52.388651 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 TOTAL=14
[0m12:05:52.392465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 21.586039, "process_user_time": 3.667307, "process_kernel_time": 1.904107, "process_mem_max_rss": "211238912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:05:52.393595 [debug] [MainThread]: Command `dbt run` failed at 12:05:52.393446 after 21.59 seconds
[0m12:05:52.394200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c71f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168a2ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168a1970>]}
[0m12:05:52.394707 [debug] [MainThread]: Flushing usage events
[0m12:06:58.981743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be7ed0>]}


============================== 12:06:58.989923 | 8dff4d95-86b8-494c-b724-b3387850aafe ==============================
[0m12:06:58.989923 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:06:58.990825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:00.738898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e88fc0>]}
[0m12:07:00.838776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b59590>]}
[0m12:07:00.840159 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:07:01.049819 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:07:01.295157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:01.296471 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m12:07:01.742548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143e4550>]}
[0m12:07:01.940360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ca7d40>]}
[0m12:07:01.941131 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:07:01.941628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117862890>]}
[0m12:07:01.945367 [info ] [MainThread]: 
[0m12:07:01.946365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:01.955413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:07:01.956118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:02.316327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:07:02.316808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:02.556567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117787450>]}
[0m12:07:02.558234 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:02.558864 [info ] [MainThread]: 
[0m12:07:02.563423 [debug] [Thread-3 (]: Began running node model.keira_project.stg_groups
[0m12:07:02.564093 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m12:07:02.566069 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_o
[0m12:07:02.566932 [info ] [Thread-3 (]: 3 of 14 START sql table model meetupservice.stg_groups ......................... [RUN]
[0m12:07:02.567982 [info ] [Thread-1 (]: 1 of 14 START sql table model meetupservice.my_first_dbt_model ................. [RUN]
[0m12:07:02.568626 [info ] [Thread-2 (]: 2 of 14 START sql table model meetupservice.stg_events_o ....................... [RUN]
[0m12:07:02.569509 [debug] [Thread-4 (]: Began running node model.keira_project.stg_users
[0m12:07:02.570787 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.stg_groups'
[0m12:07:02.571583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m12:07:02.572401 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.stg_events_o'
[0m12:07:02.573662 [info ] [Thread-4 (]: 4 of 14 START sql table model meetupservice.stg_users .......................... [RUN]
[0m12:07:02.574421 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_groups
[0m12:07:02.574986 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m12:07:02.575396 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_o
[0m12:07:02.576252 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.stg_users'
[0m12:07:02.591780 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_users
[0m12:07:02.591397 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m12:07:02.596805 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m12:07:02.602974 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m12:07:02.607450 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m12:07:02.608785 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_groups
[0m12:07:02.610022 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m12:07:02.610833 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_o
[0m12:07:02.653176 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:07:02.659360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:02.659966 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_users
[0m12:07:02.663110 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:07:02.855977 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:07:03.332325 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m12:07:03.336852 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_first_dbt_model"
[0m12:07:03.339547 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m12:07:03.340412 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m12:07:03.342712 [debug] [Thread-4 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown
    FROM `keira-xebia`.`meetupservice`.`source_users`   
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM users
    );
  
[0m12:07:03.344082 [debug] [Thread-1 (]: On model.keira_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_first_dbt_model"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m12:07:03.345516 [debug] [Thread-3 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_year, 
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m12:07:03.347004 [debug] [Thread-2 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(FARM_FINGERPRINT(
            CONCAT(event_name, CAST(group_id AS STRING), CAST(venue_id AS STRING), CAST(event_start_time AS STRING))) 
            AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsvp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m12:07:03.608688 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:df0253d4-de93-4d45-816c-a543bde30ad4&page=queryresults
[0m12:07:03.725274 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f6b54fa7-c29d-42ed-bf0d-338ae6e9b671&page=queryresults
[0m12:07:03.733411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0bfeba6a-339b-44bb-8202-25f9c96b63cf&page=queryresults
[0m12:07:03.787919 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7a471082-46e9-4705-992a-18e7780155b6&page=queryresults
[0m12:07:06.358742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11783b650>]}
[0m12:07:06.362045 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178b5650>]}
[0m12:07:06.364246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e5d30>]}
[0m12:07:06.365361 [info ] [Thread-1 (]: 1 of 14 OK created sql table model meetupservice.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.79s]
[0m12:07:06.368121 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m12:07:06.366387 [info ] [Thread-4 (]: 4 of 14 OK created sql table model meetupservice.stg_users ..................... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.79s]
[0m12:07:06.367393 [info ] [Thread-3 (]: 3 of 14 OK created sql table model meetupservice.stg_groups .................... [[32mCREATE TABLE (711.0 rows, 442.7 KiB processed)[0m in 3.79s]
[0m12:07:06.368901 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users_groups
[0m12:07:06.370144 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_users
[0m12:07:06.371246 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_groups
[0m12:07:06.371927 [info ] [Thread-1 (]: 5 of 14 START sql table model meetupservice.stg_users_groups ................... [RUN]
[0m12:07:06.372767 [debug] [Thread-4 (]: Began running node model.keira_project.stg_venues
[0m12:07:06.373447 [debug] [Thread-3 (]: Began running node model.keira_project.my_second_dbt_model
[0m12:07:06.374159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_first_dbt_model, now model.keira_project.stg_users_groups)
[0m12:07:06.374915 [info ] [Thread-4 (]: 6 of 14 START sql table model meetupservice.stg_venues ......................... [RUN]
[0m12:07:06.376188 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users_groups
[0m12:07:06.376693 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users, now model.keira_project.stg_venues)
[0m12:07:06.375780 [info ] [Thread-3 (]: 7 of 14 START sql view model meetupservice.my_second_dbt_model ................. [RUN]
[0m12:07:06.383631 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m12:07:06.384115 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_venues
[0m12:07:06.384785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_groups, now model.keira_project.my_second_dbt_model)
[0m12:07:06.389681 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_venues"
[0m12:07:06.390299 [debug] [Thread-3 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m12:07:06.391036 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users_groups
[0m12:07:06.394887 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m12:07:06.399492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:06.400343 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_venues
[0m12:07:06.406183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:07:06.591439 [debug] [Thread-3 (]: Began executing node model.keira_project.my_second_dbt_model
[0m12:07:06.633452 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.my_second_dbt_model"
[0m12:07:06.634684 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:07:06.637492 [debug] [Thread-3 (]: On model.keira_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_second_dbt_model"} */


  create or replace view `keira-xebia`.`meetupservice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `keira-xebia`.`meetupservice`.`my_first_dbt_model`
where id = 1;


[0m12:07:06.886227 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_venues"
[0m12:07:06.888037 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m12:07:06.889931 [debug] [Thread-1 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        EXTRACT(YEAR FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_year, 
        EXTRACT(MONTH FROM TIMESTAMP_SECONDS
        (CAST(membership.joined / 1000 AS INT64))) AS join_group_month
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM usergroup
    );
  
[0m12:07:06.890666 [debug] [Thread-4 (]: On model.keira_project.stg_venues: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_venues"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_venues`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    venue_id,
    name AS venue_name,
    city AS venue_city,
    country AS venue_country,
    lat AS venue_lat,
    lon AS venue_lon
FROM `keira-xebia`.`meetupservice`.`source_venues`
    );
  
[0m12:07:07.293989 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:88dc23ae-4a60-4fff-9a22-389ce6b6998c&page=queryresults
[0m12:07:07.294645 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:583268de-8a82-40c9-a34e-5e269edcd556&page=queryresults
[0m12:07:07.440018 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179e70d0>]}
[0m12:07:07.440610 [info ] [Thread-3 (]: 7 of 14 OK created sql view model meetupservice.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m12:07:07.441108 [debug] [Thread-3 (]: Finished running node model.keira_project.my_second_dbt_model
[0m12:07:07.441420 [debug] [Thread-3 (]: Began running node model.keira_project.certified_users
[0m12:07:07.441772 [info ] [Thread-3 (]: 8 of 14 START sql table model meetupservice.certified_users .................... [RUN]
[0m12:07:07.442099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.my_second_dbt_model, now model.keira_project.certified_users)
[0m12:07:07.442350 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_users
[0m12:07:07.444709 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_users"
[0m12:07:07.445719 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_users
[0m12:07:07.448180 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:07:07.682287 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_users"
[0m12:07:07.684274 [debug] [Thread-3 (]: On model.keira_project.certified_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM `keira-xebia`.`meetupservice`.`stg_users`
    );
  
[0m12:07:07.736782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:20753966-b05a-47e1-9f36-28243d61bcef&page=queryresults
[0m12:07:08.623433 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:96fca6a9-32bc-4678-8668-c47ed1c5ef6d&page=queryresults
[0m12:07:09.114156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117866e40>]}
[0m12:07:09.114747 [info ] [Thread-2 (]: 2 of 14 OK created sql table model meetupservice.stg_events_o .................. [[32mCREATE TABLE (174.1k rows, 12.1 MiB processed)[0m in 6.54s]
[0m12:07:09.115199 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_o
[0m12:07:09.115531 [debug] [Thread-2 (]: Began running node model.keira_project.certified_groups
[0m12:07:09.115934 [info ] [Thread-2 (]: 9 of 14 START sql table model meetupservice.certified_groups ................... [RUN]
[0m12:07:09.116325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_o, now model.keira_project.certified_groups)
[0m12:07:09.116613 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_groups
[0m12:07:09.119090 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_groups"
[0m12:07:09.120405 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_groups
[0m12:07:09.122590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:07:09.369783 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_groups"
[0m12:07:09.418508 [debug] [Thread-2 (]: On model.keira_project.certified_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_groups`
      
    
    

    OPTIONS()
    as (
      


SELECT 
    group_id, --unique identifier of a group
    group_name,
    group_created_year,
    group_created_month,
    group_description,
    group_city,
    group_lat,
    group_lon
FROM `keira-xebia`.`meetupservice`.`stg_groups`
    );
  
[0m12:07:09.789650 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178abdd0>]}
[0m12:07:09.790299 [info ] [Thread-4 (]: 6 of 14 OK created sql table model meetupservice.stg_venues .................... [[32mCREATE TABLE (1.7k rows, 97.0 KiB processed)[0m in 3.41s]
[0m12:07:09.790819 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_venues
[0m12:07:09.791140 [debug] [Thread-4 (]: Began running node model.keira_project.stg_events
[0m12:07:09.791517 [info ] [Thread-4 (]: 10 of 14 START sql table model meetupservice.stg_events ........................ [RUN]
[0m12:07:09.791843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_venues, now model.keira_project.stg_events)
[0m12:07:09.792092 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_events
[0m12:07:09.795037 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m12:07:09.795722 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_events
[0m12:07:09.797870 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:07:09.887430 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:96c3b7db-7e1b-480e-9128-e3fbdcbbe933&page=queryresults
[0m12:07:10.047372 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m12:07:10.049582 [debug] [Thread-4 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
        event_description
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
    WHERE event_id IS NOT NULL 
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.rsvp_total_limit,
        e.event_description,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    rsvp_total_limit,
    event_description,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m12:07:10.257561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11774ce30>]}
[0m12:07:10.258157 [info ] [Thread-1 (]: 5 of 14 OK created sql table model meetupservice.stg_users_groups .............. [[32mCREATE TABLE (145.5k rows, 4.5 MiB processed)[0m in 3.88s]
[0m12:07:10.258667 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users_groups
[0m12:07:10.258987 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m12:07:10.259313 [info ] [Thread-1 (]: 11 of 14 START sql table model meetupservice.stg_events_rsvp ................... [RUN]
[0m12:07:10.259762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users_groups, now model.keira_project.stg_events_rsvp)
[0m12:07:10.260025 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m12:07:10.262536 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m12:07:10.263203 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m12:07:10.265467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:10.457708 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:468c9e03-0508-4f07-938e-88dcae83e808&page=queryresults
[0m12:07:10.542059 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m12:07:10.543831 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM `keira-xebia`.`meetupservice`.`stg_events_o`
    );
  
[0m12:07:10.978698 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d0a22aa6-335c-4132-bcf0-0f13a06d1ca6&page=queryresults
[0m12:07:11.421231 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178aa2d0>]}
[0m12:07:11.421798 [info ] [Thread-3 (]: 8 of 14 OK created sql table model meetupservice.certified_users ............... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.98s]
[0m12:07:11.422266 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_users
[0m12:07:11.422575 [debug] [Thread-3 (]: Began running node model.keira_project.certified_users_groups
[0m12:07:11.422932 [info ] [Thread-3 (]: 12 of 14 START sql table model meetupservice.certified_users_groups ............ [RUN]
[0m12:07:11.423239 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_users, now model.keira_project.certified_users_groups)
[0m12:07:11.423486 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_users_groups
[0m12:07:11.425872 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m12:07:11.427149 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_users_groups
[0m12:07:11.428762 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:07:11.675459 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m12:07:11.676259 [debug] [Thread-3 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    join_group_id,
    join_group_year,
    join_group_month
FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
    );
  
[0m12:07:12.112329 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:dc7dd14a-ecc3-4131-ace7-889bb3160bd8&page=queryresults
[0m12:07:12.485354 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178abd10>]}
[0m12:07:12.485981 [info ] [Thread-2 (]: 9 of 14 OK created sql table model meetupservice.certified_groups .............. [[32mCREATE TABLE (711.0 rows, 448.3 KiB processed)[0m in 3.37s]
[0m12:07:12.486445 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_groups
[0m12:07:13.084758 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179f2570>]}
[0m12:07:13.085393 [info ] [Thread-4 (]: 10 of 14 OK created sql table model meetupservice.stg_events ................... [[32mCREATE TABLE (6.2k rows, 264.4 MiB processed)[0m in 3.29s]
[0m12:07:13.085889 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_events
[0m12:07:14.726769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179f2f90>]}
[0m12:07:14.727365 [info ] [Thread-1 (]: 11 of 14 OK created sql table model meetupservice.stg_events_rsvp .............. [[32mCREATE TABLE (174.1k rows, 20.4 MiB processed)[0m in 4.47s]
[0m12:07:14.727843 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m12:07:14.728339 [debug] [Thread-2 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:07:14.728704 [info ] [Thread-2 (]: 13 of 14 START sql table model meetupservice.certified_events_users_rsvp ....... [RUN]
[0m12:07:14.729029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_groups, now model.keira_project.certified_events_users_rsvp)
[0m12:07:14.729279 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:07:14.732427 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:07:14.733135 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:07:14.734749 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:07:14.990628 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m12:07:14.992011 [debug] [Thread-2 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY venue_id, group_id, event_name, event_start_time, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m12:07:15.048522 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ad4350>]}
[0m12:07:15.049058 [info ] [Thread-3 (]: 12 of 14 OK created sql table model meetupservice.certified_users_groups ....... [[32mCREATE TABLE (145.5k rows, 6.3 MiB processed)[0m in 3.63s]
[0m12:07:15.049495 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_users_groups
[0m12:07:15.250352 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:48503b71-67aa-4510-90ba-7859ff81b485&page=queryresults
[0m12:07:19.058277 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ad5730>]}
[0m12:07:19.058931 [info ] [Thread-2 (]: 13 of 14 OK created sql table model meetupservice.certified_events_users_rsvp .. [[32mCREATE TABLE (174.0k rows, 18.2 MiB processed)[0m in 4.33s]
[0m12:07:19.059456 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:07:19.060209 [debug] [Thread-4 (]: Began running node model.keira_project.certified_events
[0m12:07:19.060609 [info ] [Thread-4 (]: 14 of 14 START sql table model meetupservice.certified_events .................. [RUN]
[0m12:07:19.061152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events, now model.keira_project.certified_events)
[0m12:07:19.061794 [debug] [Thread-4 (]: Began compiling node model.keira_project.certified_events
[0m12:07:19.065713 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:07:19.067174 [debug] [Thread-4 (]: Began executing node model.keira_project.certified_events
[0m12:07:19.069025 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:07:19.359488 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m12:07:19.361482 [debug] [Thread-4 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_name = r.event_name 
        AND e.event_date = r.event_date
        AND e.group_id = r.group_id
        AND e.venue_id = r.venue_id
)

SELECT
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m12:07:19.762790 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:268eb8d9-b4ae-4e6b-a3b4-d2c678555749&page=queryresults
[0m12:07:22.621044 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dff4d95-86b8-494c-b724-b3387850aafe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179f35f0>]}
[0m12:07:22.621797 [info ] [Thread-4 (]: 14 of 14 OK created sql table model meetupservice.certified_events ............. [[32mCREATE TABLE (6.2k rows, 27.8 MiB processed)[0m in 3.56s]
[0m12:07:22.622362 [debug] [Thread-4 (]: Finished running node model.keira_project.certified_events
[0m12:07:22.624173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:22.624550 [debug] [MainThread]: Connection 'model.keira_project.stg_events_rsvp' was properly closed.
[0m12:07:22.624765 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m12:07:22.624950 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m12:07:22.625125 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m12:07:22.625445 [info ] [MainThread]: 
[0m12:07:22.625730 [info ] [MainThread]: Finished running 13 table models, 1 view model in 0 hours 0 minutes and 20.68 seconds (20.68s).
[0m12:07:22.627962 [debug] [MainThread]: Command end result
[0m12:07:22.698395 [info ] [MainThread]: 
[0m12:07:22.699004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:22.699813 [info ] [MainThread]: 
[0m12:07:22.700754 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m12:07:22.706305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.832325, "process_user_time": 3.753998, "process_kernel_time": 1.878187, "process_mem_max_rss": "209993728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:07:22.707919 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:22.707535 after 23.83 seconds
[0m12:07:22.708739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eae930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ad7e90>]}
[0m12:07:22.709598 [debug] [MainThread]: Flushing usage events
[0m12:10:42.919700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206abed0>]}


============================== 12:10:42.927361 | 31ea0abd-2664-4843-a5a1-5b9a97b4558f ==============================
[0m12:10:42.927361 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:10:42.928326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'send_anonymous_usage_stats': 'True'}
[0m12:10:44.927972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31ea0abd-2664-4843-a5a1-5b9a97b4558f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127188fc0>]}
[0m12:10:45.023850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31ea0abd-2664-4843-a5a1-5b9a97b4558f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e59590>]}
[0m12:10:45.025294 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:10:45.234020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:10:45.473969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:45.475429 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m12:10:45.929542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31ea0abd-2664-4843-a5a1-5b9a97b4558f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274c8550>]}
[0m12:10:46.133367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31ea0abd-2664-4843-a5a1-5b9a97b4558f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270a7d40>]}
[0m12:10:46.134052 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:10:46.134634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31ea0abd-2664-4843-a5a1-5b9a97b4558f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127656970>]}
[0m12:10:46.137524 [info ] [MainThread]: 
[0m12:10:46.138408 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:10:46.139857 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:10:46.140533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:46.498900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:10:46.499291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:46.744652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31ea0abd-2664-4843-a5a1-5b9a97b4558f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127577860>]}
[0m12:10:46.745527 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:46.746040 [info ] [MainThread]: 
[0m12:10:46.750967 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:10:46.751878 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m12:10:46.752540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m12:10:46.753172 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:10:46.771984 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:10:46.774010 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:10:46.803802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:47.104051 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m12:10:47.105781 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY event_id, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY event_id, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_id,
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_id,
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m12:10:47.552751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1ba85312-7447-4bbc-9e54-450795f996e5&page=queryresults
[0m12:10:52.075954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31ea0abd-2664-4843-a5a1-5b9a97b4558f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273619d0>]}
[0m12:10:52.076558 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events_users_rsvp .... [[32mCREATE TABLE (174.0k rows, 21.7 MiB processed)[0m in 5.32s]
[0m12:10:52.077030 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:10:52.078051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:52.078420 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m12:10:52.078923 [info ] [MainThread]: 
[0m12:10:52.079476 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m12:10:52.080465 [debug] [MainThread]: Command end result
[0m12:10:52.148713 [info ] [MainThread]: 
[0m12:10:52.149621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:52.150309 [info ] [MainThread]: 
[0m12:10:52.150854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:10:52.154929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.340464, "process_user_time": 2.72772, "process_kernel_time": 1.555772, "process_mem_max_rss": "208732160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:10:52.156099 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:52.155854 after 9.34 seconds
[0m12:10:52.156649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12763ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127536fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206beb70>]}
[0m12:10:52.157417 [debug] [MainThread]: Flushing usage events
[0m12:12:07.390826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7ed0>]}


============================== 12:12:07.398716 | 33c3a1df-efcd-446e-962c-0b72fa747fcf ==============================
[0m12:12:07.398716 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:12:07.399726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models certified_events', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:09.324651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33c3a1df-efcd-446e-962c-0b72fa747fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a88fc0>]}
[0m12:12:09.418740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33c3a1df-efcd-446e-962c-0b72fa747fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125859590>]}
[0m12:12:09.420190 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:12:09.593157 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:12:09.836624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:09.837636 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m12:12:10.285358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33c3a1df-efcd-446e-962c-0b72fa747fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dc8550>]}
[0m12:12:10.485033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33c3a1df-efcd-446e-962c-0b72fa747fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259a7d40>]}
[0m12:12:10.485977 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:12:10.486616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c3a1df-efcd-446e-962c-0b72fa747fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f56970>]}
[0m12:12:10.489338 [info ] [MainThread]: 
[0m12:12:10.490208 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:10.491721 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:12:10.492300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:10.857790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:12:10.858148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:11.099839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c3a1df-efcd-446e-962c-0b72fa747fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e77790>]}
[0m12:12:11.100986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:11.101349 [info ] [MainThread]: 
[0m12:12:11.105608 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m12:12:11.106579 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m12:12:11.107500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m12:12:11.108101 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m12:12:11.125577 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:12:11.127029 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m12:12:11.154860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:11.473512 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m12:12:11.475347 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_id,
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_id,
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_id,
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_id = r.event_id
)

SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m12:12:12.091763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ae382fae-dd36-42df-bbce-6f6442b917c8&page=queryresults
[0m12:12:12.187609 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column event_id which is neither grouped nor aggregated at [18:9]; reason: invalidQuery, location: query, message: SELECT list expression references column event_id which is neither grouped nor aggregated at [18:9]')
[0m12:12:13.423018 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0954c3d3-7fe9-41f0-bfe7-97c1e7b00c30&page=queryresults
[0m12:12:13.505149 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0954c3d3-7fe9-41f0-bfe7-97c1e7b00c30&page=queryresults
[0m12:12:13.515368 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  SELECT list expression references column event_id which is neither grouped nor aggregated at [18:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m12:12:13.516581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3a1df-efcd-446e-962c-0b72fa747fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c5ef90>]}
[0m12:12:13.517067 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 2.41s]
[0m12:12:13.517501 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m12:12:13.518923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:13.519165 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m12:12:13.519380 [info ] [MainThread]: 
[0m12:12:13.519599 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m12:12:13.520141 [debug] [MainThread]: Command end result
[0m12:12:13.588433 [info ] [MainThread]: 
[0m12:12:13.589110 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:12:13.589588 [info ] [MainThread]: 
[0m12:12:13.590232 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  SELECT list expression references column event_id which is neither grouped nor aggregated at [18:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m12:12:13.590541 [info ] [MainThread]: 
[0m12:12:13.590883 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:13.594660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.3081775, "process_user_time": 2.685719, "process_kernel_time": 1.514648, "process_mem_max_rss": "209911808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:12:13.595328 [debug] [MainThread]: Command `dbt run` failed at 12:12:13.595209 after 6.31 seconds
[0m12:12:13.596056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f3b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023af070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a50910>]}
[0m12:12:13.596675 [debug] [MainThread]: Flushing usage events
[0m12:13:04.626080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eebed0>]}


============================== 12:13:04.634301 | 1a9069d2-b103-4602-9fbc-c6f41dcb5321 ==============================
[0m12:13:04.634301 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:13:04.635165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models certified_events', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:06.537689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a9069d2-b103-4602-9fbc-c6f41dcb5321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a88fc0>]}
[0m12:13:06.636184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a9069d2-b103-4602-9fbc-c6f41dcb5321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120859590>]}
[0m12:13:06.637712 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:13:06.842251 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:13:07.085416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:07.086895 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m12:13:07.550148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a9069d2-b103-4602-9fbc-c6f41dcb5321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dc8550>]}
[0m12:13:07.748468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a9069d2-b103-4602-9fbc-c6f41dcb5321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209a7d40>]}
[0m12:13:07.749558 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:13:07.750078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a9069d2-b103-4602-9fbc-c6f41dcb5321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f567b0>]}
[0m12:13:07.752772 [info ] [MainThread]: 
[0m12:13:07.753663 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:13:07.755259 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:13:07.755940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:08.098470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:13:08.098862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:08.327131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a9069d2-b103-4602-9fbc-c6f41dcb5321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e77450>]}
[0m12:13:08.328259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:08.328804 [info ] [MainThread]: 
[0m12:13:08.333413 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m12:13:08.334427 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m12:13:08.335193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m12:13:08.335898 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m12:13:08.353849 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:13:08.355228 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m12:13:08.385043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:08.675413 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m12:13:08.677143 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_id,
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_id
),

events AS (
    SELECT 
        event_id,
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_id,
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_id = r.event_id
)

SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m12:13:08.922842 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ccbc98ec-04a0-40ac-ab0b-7256be620bf9&page=queryresults
[0m12:13:09.066096 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/keira-xebia/queries/ccbc98ec-04a0-40ac-ab0b-7256be620bf9?maxResults=0&location=EU&prettyPrint=false: SELECT list expression references column event_name which is neither grouped nor aggregated at [19:9]')
[0m12:13:10.359078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:25668196-feb8-4730-ab1d-c314c8e7f036&page=queryresults
[0m12:13:10.426261 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:25668196-feb8-4730-ab1d-c314c8e7f036&page=queryresults
[0m12:13:10.437071 [debug] [Thread-1 (]: Database Error in model certified_events (models/Certified/certified_events.sql)
  SELECT list expression references column event_name which is neither grouped nor aggregated at [19:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m12:13:10.438991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9069d2-b103-4602-9fbc-c6f41dcb5321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d03110>]}
[0m12:13:10.439645 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_events ........... [[31mERROR[0m in 2.10s]
[0m12:13:10.440149 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m12:13:10.441852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:10.442100 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m12:13:10.442309 [info ] [MainThread]: 
[0m12:13:10.442540 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m12:13:10.443026 [debug] [MainThread]: Command end result
[0m12:13:10.520287 [info ] [MainThread]: 
[0m12:13:10.521076 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:13:10.521607 [info ] [MainThread]: 
[0m12:13:10.522166 [error] [MainThread]:   Database Error in model certified_events (models/Certified/certified_events.sql)
  SELECT list expression references column event_name which is neither grouped nor aggregated at [19:9]
  compiled code at target/run/keira_project/models/Certified/certified_events.sql
[0m12:13:10.522809 [info ] [MainThread]: 
[0m12:13:10.523306 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:13:10.527009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.008956, "process_user_time": 2.696164, "process_kernel_time": 1.532066, "process_mem_max_rss": "207028224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:13:10.527956 [debug] [MainThread]: Command `dbt run` failed at 12:13:10.527859 after 6.01 seconds
[0m12:13:10.528575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c62e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a50870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a507d0>]}
[0m12:13:10.529065 [debug] [MainThread]: Flushing usage events
[0m12:14:27.505015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110abed0>]}


============================== 12:14:27.512678 | 2f3adf01-0282-4f87-8d90-aad8db77aa8a ==============================
[0m12:14:27.512678 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:14:27.513464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_events', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:14:29.538555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f3adf01-0282-4f87-8d90-aad8db77aa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b88fc0>]}
[0m12:14:29.645164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f3adf01-0282-4f87-8d90-aad8db77aa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121859590>]}
[0m12:14:29.646561 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:14:29.851673 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:14:30.101196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:30.102620 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_events.sql
[0m12:14:30.566915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f3adf01-0282-4f87-8d90-aad8db77aa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ec8550>]}
[0m12:14:30.759491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f3adf01-0282-4f87-8d90-aad8db77aa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219abd40>]}
[0m12:14:30.760219 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:14:30.760777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3adf01-0282-4f87-8d90-aad8db77aa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12202a7b0>]}
[0m12:14:30.764016 [info ] [MainThread]: 
[0m12:14:30.764965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:14:30.766387 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:14:30.767041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:31.566014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:14:31.566451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:32.001774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f3adf01-0282-4f87-8d90-aad8db77aa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f77450>]}
[0m12:14:32.002409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:32.002735 [info ] [MainThread]: 
[0m12:14:32.005182 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m12:14:32.005949 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events .................... [RUN]
[0m12:14:32.006451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events)
[0m12:14:32.006781 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m12:14:32.017259 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:14:32.018989 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m12:14:32.050837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:32.374027 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m12:14:32.375780 [debug] [Thread-1 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_id,
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_id, event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_id,
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_id,
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_id = r.event_id
)

SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m12:14:33.200326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1cdf8dc8-042c-4460-95b4-124455c92200&page=queryresults
[0m12:14:35.839873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f3adf01-0282-4f87-8d90-aad8db77aa8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122031910>]}
[0m12:14:35.840456 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events ............... [[32mCREATE TABLE (6.2k rows, 31.4 MiB processed)[0m in 3.83s]
[0m12:14:35.840961 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m12:14:35.842056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:35.842624 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m12:14:35.843036 [info ] [MainThread]: 
[0m12:14:35.843588 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m12:14:35.844765 [debug] [MainThread]: Command end result
[0m12:14:35.911251 [info ] [MainThread]: 
[0m12:14:35.912714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:35.913258 [info ] [MainThread]: 
[0m12:14:35.913878 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:35.918149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.5204, "process_user_time": 2.760728, "process_kernel_time": 1.564473, "process_mem_max_rss": "210436096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:14:35.918832 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:35.918744 after 8.52 seconds
[0m12:14:35.919475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e02db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b37b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b34690>]}
[0m12:14:35.920109 [debug] [MainThread]: Flushing usage events
[0m12:34:52.744339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031aa660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e7ed0>]}


============================== 12:34:52.752539 | 54518bdb-975a-429b-ad3b-c5e868dec4aa ==============================
[0m12:34:52.752539 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:34:52.753318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_users_groups', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:54.670037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54518bdb-975a-429b-ad3b-c5e868dec4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a88fc0>]}
[0m12:34:54.768943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54518bdb-975a-429b-ad3b-c5e868dec4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114359590>]}
[0m12:34:54.770147 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:34:54.981916 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:34:55.225367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:34:55.226603 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_users_groups.sql
[0m12:34:55.679861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54518bdb-975a-429b-ad3b-c5e868dec4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117de4550>]}
[0m12:34:55.878762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54518bdb-975a-429b-ad3b-c5e868dec4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179a7d40>]}
[0m12:34:55.879872 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:34:55.880501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54518bdb-975a-429b-ad3b-c5e868dec4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f52970>]}
[0m12:34:55.883814 [info ] [MainThread]: 
[0m12:34:55.884887 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:34:55.886601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:34:55.887459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:56.256719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:34:56.257090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:56.513693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54518bdb-975a-429b-ad3b-c5e868dec4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e7b860>]}
[0m12:34:56.514214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:34:56.515128 [info ] [MainThread]: 
[0m12:34:56.517790 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users_groups
[0m12:34:56.518243 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_users_groups .................... [RUN]
[0m12:34:56.518610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_users_groups)
[0m12:34:56.518882 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users_groups
[0m12:34:56.532481 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m12:34:56.533858 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users_groups
[0m12:34:56.563857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:56.875956 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m12:34:56.877614 [debug] [Thread-1 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        TIMESTAMP_SECONDS(CAST(membership.joined / 1000 AS INT64)) AS join_group_time --timestamp
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_time
FROM usergroup
    );
  
[0m12:34:57.400512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0c4b4b12-ecf8-49c5-9ed9-008259c182ab&page=queryresults
[0m12:34:59.756397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54518bdb-975a-429b-ad3b-c5e868dec4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d028d0>]}
[0m12:34:59.757472 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_users_groups ............... [[32mCREATE TABLE (145.5k rows, 4.5 MiB processed)[0m in 3.24s]
[0m12:34:59.758635 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users_groups
[0m12:34:59.760771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:59.761331 [debug] [MainThread]: Connection 'model.keira_project.stg_users_groups' was properly closed.
[0m12:34:59.761880 [info ] [MainThread]: 
[0m12:34:59.762585 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m12:34:59.763791 [debug] [MainThread]: Command end result
[0m12:34:59.828498 [info ] [MainThread]: 
[0m12:34:59.829400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:59.829843 [info ] [MainThread]: 
[0m12:34:59.830409 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:34:59.834181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1966233, "process_user_time": 2.672269, "process_kernel_time": 1.536502, "process_mem_max_rss": "208306176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:59.835406 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:59.835224 after 7.20 seconds
[0m12:34:59.836144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f46db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a53b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a50690>]}
[0m12:34:59.836752 [debug] [MainThread]: Flushing usage events
[0m12:36:35.795291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7ed0>]}


============================== 12:36:35.804047 | 03b9c021-5c64-4098-98c9-c5a0650a84f1 ==============================
[0m12:36:35.804047 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:36:35.805168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_users_groups', 'send_anonymous_usage_stats': 'True'}
[0m12:36:37.841032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03b9c021-5c64-4098-98c9-c5a0650a84f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a88fc0>]}
[0m12:36:37.940846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03b9c021-5c64-4098-98c9-c5a0650a84f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f59590>]}
[0m12:36:37.942078 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:36:38.161347 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:36:38.405322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:38.406466 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_users_groups.sql
[0m12:36:38.860149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03b9c021-5c64-4098-98c9-c5a0650a84f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115de4550>]}
[0m12:36:39.060106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03b9c021-5c64-4098-98c9-c5a0650a84f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158a7f20>]}
[0m12:36:39.061026 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m12:36:39.061379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b9c021-5c64-4098-98c9-c5a0650a84f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f4e970>]}
[0m12:36:39.064350 [info ] [MainThread]: 
[0m12:36:39.065546 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:36:39.066773 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:36:39.067275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:39.421488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:36:39.421897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:39.674683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b9c021-5c64-4098-98c9-c5a0650a84f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e77450>]}
[0m12:36:39.675200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:36:39.675436 [info ] [MainThread]: 
[0m12:36:39.678777 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m12:36:39.679866 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m12:36:39.680576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m12:36:39.681054 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m12:36:39.698338 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m12:36:39.699766 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m12:36:39.727911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:40.032232 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m12:36:40.034390 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    join_group_id,
    FORMAT_TIMESTAMP('%Y-%m', join_group_time) AS join_group_year_month
FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
    );
  
[0m12:36:40.724145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ae822cf3-d740-4eaf-a3c9-bed41909eef2&page=queryresults
[0m12:36:43.267022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03b9c021-5c64-4098-98c9-c5a0650a84f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c5e750>]}
[0m12:36:43.267648 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_users_groups ......... [[32mCREATE TABLE (145.5k rows, 5.1 MiB processed)[0m in 3.59s]
[0m12:36:43.268159 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m12:36:43.269261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:43.269496 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m12:36:43.269704 [info ] [MainThread]: 
[0m12:36:43.269958 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m12:36:43.271256 [debug] [MainThread]: Command end result
[0m12:36:43.338757 [info ] [MainThread]: 
[0m12:36:43.339692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:43.340409 [info ] [MainThread]: 
[0m12:36:43.340880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:43.344819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6519127, "process_user_time": 2.705811, "process_kernel_time": 1.558884, "process_mem_max_rss": "208158720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:43.345648 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:43.345516 after 7.65 seconds
[0m12:36:43.346188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f46db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e36fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fab70>]}
[0m12:36:43.346849 [debug] [MainThread]: Flushing usage events
[0m13:07:09.135618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102836660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e7ed0>]}


============================== 13:07:09.143607 | 444ce07d-8e2e-4f96-9ae5-b922fbaef5b0 ==============================
[0m13:07:09.143607 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:07:09.144491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models certified_users_groups', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:07:11.097747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '444ce07d-8e2e-4f96-9ae5-b922fbaef5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff30fc0>]}
[0m13:07:11.196008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '444ce07d-8e2e-4f96-9ae5-b922fbaef5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c959590>]}
[0m13:07:11.197125 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m13:07:11.397950 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:07:11.647216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:07:11.648500 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_users_groups.sql
[0m13:07:12.133068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '444ce07d-8e2e-4f96-9ae5-b922fbaef5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1383c8550>]}
[0m13:07:12.358127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '444ce07d-8e2e-4f96-9ae5-b922fbaef5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe4fe30>]}
[0m13:07:12.359502 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m13:07:12.359796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '444ce07d-8e2e-4f96-9ae5-b922fbaef5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138556890>]}
[0m13:07:12.362517 [info ] [MainThread]: 
[0m13:07:12.363661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:07:12.365667 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m13:07:12.366208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:13.590412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m13:07:13.590891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:13.854453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '444ce07d-8e2e-4f96-9ae5-b922fbaef5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138477380>]}
[0m13:07:13.855015 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:07:13.855251 [info ] [MainThread]: 
[0m13:07:13.857914 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m13:07:13.858368 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m13:07:13.858775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m13:07:13.859201 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m13:07:13.876731 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m13:07:13.878454 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m13:07:13.910532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:14.229990 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m13:07:14.232334 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM (CASE WHEN (e.final_response = 'yes' THEN 1 ELSE 0 END )) THEN accept_event_cnt,
        SUM (CASE WHEN (e.final_response != 'yes' THEN 1 ELSE 0 END )) THEN decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m13:07:14.622399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:b73b6b5e-e845-40a3-8b16-d9c6204e4279&page=queryresults
[0m13:07:14.623154 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "," but got keyword THEN at [28:50]; reason: invalidQuery, location: query, message: Syntax error: Expected "," but got keyword THEN at [28:50]')
[0m13:07:15.698176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:8fd7ea9b-f9e7-48ee-932e-2309cdf34af0&page=queryresults
[0m13:07:15.698732 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:8fd7ea9b-f9e7-48ee-932e-2309cdf34af0&page=queryresults
[0m13:07:15.709062 [debug] [Thread-1 (]: Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  Syntax error: Expected "," but got keyword THEN at [28:50]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:07:15.710359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '444ce07d-8e2e-4f96-9ae5-b922fbaef5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382662d0>]}
[0m13:07:15.710867 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_users_groups ..... [[31mERROR[0m in 1.85s]
[0m13:07:15.711364 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m13:07:15.713008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:15.713246 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m13:07:15.713455 [info ] [MainThread]: 
[0m13:07:15.713665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m13:07:15.714119 [debug] [MainThread]: Command end result
[0m13:07:15.781078 [info ] [MainThread]: 
[0m13:07:15.782174 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:07:15.782699 [info ] [MainThread]: 
[0m13:07:15.783434 [error] [MainThread]:   Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  Syntax error: Expected "," but got keyword THEN at [28:50]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:07:15.783755 [info ] [MainThread]: 
[0m13:07:15.784184 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:07:15.787809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.7776375, "process_user_time": 2.750381, "process_kernel_time": 1.567405, "process_mem_max_rss": "205668352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:07:15.788692 [debug] [MainThread]: Command `dbt run` failed at 13:07:15.788521 after 6.78 seconds
[0m13:07:15.789317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382eaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047fab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047fbf70>]}
[0m13:07:15.789814 [debug] [MainThread]: Flushing usage events
[0m13:08:03.441064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103236660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7ed0>]}


============================== 13:08:03.448593 | 4b910f3d-9771-4f38-b5e9-3308c25d195c ==============================
[0m13:08:03.448593 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:08:03.449835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_users_groups', 'send_anonymous_usage_stats': 'True'}
[0m13:08:05.396684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b910f3d-9771-4f38-b5e9-3308c25d195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c388fc0>]}
[0m13:08:05.494100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b910f3d-9771-4f38-b5e9-3308c25d195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c159590>]}
[0m13:08:05.495282 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m13:08:05.679480 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:08:05.924794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:05.926172 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_users_groups.sql
[0m13:08:06.378072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b910f3d-9771-4f38-b5e9-3308c25d195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c8550>]}
[0m13:08:06.574436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b910f3d-9771-4f38-b5e9-3308c25d195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a7d40>]}
[0m13:08:06.575356 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m13:08:06.575893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b910f3d-9771-4f38-b5e9-3308c25d195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c952890>]}
[0m13:08:06.579291 [info ] [MainThread]: 
[0m13:08:06.580455 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:08:06.582000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m13:08:06.582440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:06.943547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m13:08:06.943964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:07.188528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b910f3d-9771-4f38-b5e9-3308c25d195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c88f1e0>]}
[0m13:08:07.189045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:08:07.189289 [info ] [MainThread]: 
[0m13:08:07.192903 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m13:08:07.193759 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m13:08:07.194424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m13:08:07.194807 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m13:08:07.211365 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m13:08:07.212878 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m13:08:07.241638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:07.560429 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m13:08:07.562016 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time) AS join_group_date,
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM (CASE WHEN (e.final_response = 'yes' THEN 1 ELSE 0 END )) THEN accept_event_cnt,
        SUM (CASE WHEN (e.final_response != 'yes' THEN 1 ELSE 0 END )) THEN decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m13:08:07.846874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:d1491baa-332d-4cae-8e07-1e8d9a5f3eb9&page=queryresults
[0m13:08:07.847491 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "," but got keyword THEN at [28:50]; reason: invalidQuery, location: query, message: Syntax error: Expected "," but got keyword THEN at [28:50]')
[0m13:08:08.279163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:b7b83d71-e997-477f-b276-d3ed36564c90&page=queryresults
[0m13:08:08.279746 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:b7b83d71-e997-477f-b276-d3ed36564c90&page=queryresults
[0m13:08:08.290051 [debug] [Thread-1 (]: Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  Syntax error: Expected "," but got keyword THEN at [28:50]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:08:08.291353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b910f3d-9771-4f38-b5e9-3308c25d195c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c932210>]}
[0m13:08:08.291859 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_users_groups ..... [[31mERROR[0m in 1.10s]
[0m13:08:08.292302 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m13:08:08.293821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:08.294083 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m13:08:08.294296 [info ] [MainThread]: 
[0m13:08:08.294559 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m13:08:08.295076 [debug] [MainThread]: Command end result
[0m13:08:08.360629 [info ] [MainThread]: 
[0m13:08:08.361448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:08:08.362151 [info ] [MainThread]: 
[0m13:08:08.362887 [error] [MainThread]:   Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  Syntax error: Expected "," but got keyword THEN at [28:50]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:08:08.363726 [info ] [MainThread]: 
[0m13:08:08.364162 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:08:08.368472 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.0320053, "process_user_time": 2.697802, "process_kernel_time": 1.530863, "process_mem_max_rss": "209518592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:08:08.369194 [debug] [MainThread]: Command `dbt run` failed at 13:08:08.369085 after 5.03 seconds
[0m13:08:08.369837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5eb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fbf70>]}
[0m13:08:08.370239 [debug] [MainThread]: Flushing usage events
[0m13:09:39.354898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7ed0>]}


============================== 13:09:39.363216 | 4d12d12e-74af-45b2-9826-fd1e01a1a6ff ==============================
[0m13:09:39.363216 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:09:39.363978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_users_groups', 'send_anonymous_usage_stats': 'True'}
[0m13:09:41.283693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d12d12e-74af-45b2-9826-fd1e01a1a6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e288fc0>]}
[0m13:09:41.379457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d12d12e-74af-45b2-9826-fd1e01a1a6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e059590>]}
[0m13:09:41.380661 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m13:09:41.586544 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:09:41.819530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:41.820690 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_users_groups.sql
[0m13:09:42.271093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d12d12e-74af-45b2-9826-fd1e01a1a6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e6c4550>]}
[0m13:09:42.474564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d12d12e-74af-45b2-9826-fd1e01a1a6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e1a7d40>]}
[0m13:09:42.475251 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m13:09:42.476065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d12d12e-74af-45b2-9826-fd1e01a1a6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e952890>]}
[0m13:09:42.479663 [info ] [MainThread]: 
[0m13:09:42.481065 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:09:42.482529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m13:09:42.483020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:42.862828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m13:09:42.863223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:43.110683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d12d12e-74af-45b2-9826-fd1e01a1a6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e877a00>]}
[0m13:09:43.111211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:09:43.111455 [info ] [MainThread]: 
[0m13:09:43.114097 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m13:09:43.114548 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m13:09:43.115086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m13:09:43.115571 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m13:09:43.131736 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m13:09:43.133022 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m13:09:43.161235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:43.469120 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m13:09:43.470806 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM (CASE WHEN (e.final_response = 'yes' THEN 1 ELSE 0 END )) AS accept_event_cnt,
        SUM (CASE WHEN (e.final_response != 'yes' THEN 1 ELSE 0 END )) AS decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m13:09:43.819863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:bb3209cc-7cf0-486d-992a-6a2f283cc351&page=queryresults
[0m13:09:43.820440 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "," but got keyword THEN at [28:50]; reason: invalidQuery, location: query, message: Syntax error: Expected "," but got keyword THEN at [28:50]')
[0m13:09:45.151432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:7f0486f4-ba65-4ef3-ad84-ae88143826eb&page=queryresults
[0m13:09:45.152023 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:7f0486f4-ba65-4ef3-ad84-ae88143826eb&page=queryresults
[0m13:09:45.162146 [debug] [Thread-1 (]: Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  Syntax error: Expected "," but got keyword THEN at [28:50]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:09:45.163434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d12d12e-74af-45b2-9826-fd1e01a1a6ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e95a210>]}
[0m13:09:45.163937 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_users_groups ..... [[31mERROR[0m in 2.05s]
[0m13:09:45.164465 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m13:09:45.165945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:45.166191 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m13:09:45.166406 [info ] [MainThread]: 
[0m13:09:45.166624 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m13:09:45.167088 [debug] [MainThread]: Command end result
[0m13:09:45.230309 [info ] [MainThread]: 
[0m13:09:45.231658 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:09:45.232357 [info ] [MainThread]: 
[0m13:09:45.232960 [error] [MainThread]:   Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  Syntax error: Expected "," but got keyword THEN at [28:50]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:09:45.233441 [info ] [MainThread]: 
[0m13:09:45.233803 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:09:45.237487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.9887156, "process_user_time": 2.712929, "process_kernel_time": 1.536994, "process_mem_max_rss": "208404480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:09:45.238426 [debug] [MainThread]: Command `dbt run` failed at 13:09:45.238203 after 5.99 seconds
[0m13:09:45.238912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e567070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efbf70>]}
[0m13:09:45.239592 [debug] [MainThread]: Flushing usage events
[0m13:10:44.005714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce7ed0>]}


============================== 13:10:44.014056 | 18eb9673-f6d0-4957-b56f-57fb06fe516e ==============================
[0m13:10:44.014056 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:10:44.015003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_users_groups', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:10:45.982311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18eb9673-f6d0-4957-b56f-57fb06fe516e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130388fc0>]}
[0m13:10:46.077718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18eb9673-f6d0-4957-b56f-57fb06fe516e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130059590>]}
[0m13:10:46.079658 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m13:10:46.288443 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:10:46.503401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:46.505109 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_users_groups.sql
[0m13:10:46.945111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18eb9673-f6d0-4957-b56f-57fb06fe516e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306c8550>]}
[0m13:10:47.142633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18eb9673-f6d0-4957-b56f-57fb06fe516e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301a3d40>]}
[0m13:10:47.143326 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m13:10:47.143870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18eb9673-f6d0-4957-b56f-57fb06fe516e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130856890>]}
[0m13:10:47.146948 [info ] [MainThread]: 
[0m13:10:47.147972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:10:47.149501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m13:10:47.150178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:47.510938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m13:10:47.511348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:47.766945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18eb9673-f6d0-4957-b56f-57fb06fe516e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130777380>]}
[0m13:10:47.767503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:47.767746 [info ] [MainThread]: 
[0m13:10:47.770441 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m13:10:47.770916 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m13:10:47.771257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m13:10:47.771505 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m13:10:47.786912 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m13:10:47.788574 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m13:10:47.815097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:48.175290 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m13:10:48.177411 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM( CASE WHEN e.final_response = 'yes' THEN 1 ELSE 0 END ) AS accept_event_cnt,
        SUM( CASE WHEN e.final_response != 'yes' THEN 1 ELSE 0 END ) AS decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m13:10:48.642773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:edc72149-1705-4e2c-a603-7080b95f75ef&page=queryresults
[0m13:10:48.727853 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator >= for argument types: DATE, STRING\n  Signature: T1 >= T1\n    Unable to find common supertype for templated argument <T1>\n      Input types for <T1>: {STRING, DATE} at [34:11]; reason: invalidQuery, location: query, message: No matching signature for operator >= for argument types: DATE, STRING\n  Signature: T1 >= T1\n    Unable to find common supertype for templated argument <T1>\n      Input types for <T1>: {STRING, DATE} at [34:11]')
[0m13:10:49.437222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:468c014a-83d2-4bb6-ad00-509c23fee19e&page=queryresults
[0m13:10:49.598283 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:468c014a-83d2-4bb6-ad00-509c23fee19e&page=queryresults
[0m13:10:49.612018 [debug] [Thread-1 (]: Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  No matching signature for operator >= for argument types: DATE, STRING
    Signature: T1 >= T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {STRING, DATE} at [34:11]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:10:49.613635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb9673-f6d0-4957-b56f-57fb06fe516e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13083b4d0>]}
[0m13:10:49.614638 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_users_groups ..... [[31mERROR[0m in 1.84s]
[0m13:10:49.615503 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m13:10:49.618675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:49.619061 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m13:10:49.619622 [info ] [MainThread]: 
[0m13:10:49.620359 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m13:10:49.621580 [debug] [MainThread]: Command end result
[0m13:10:49.692530 [info ] [MainThread]: 
[0m13:10:49.693579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:10:49.694098 [info ] [MainThread]: 
[0m13:10:49.694588 [error] [MainThread]:   Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  No matching signature for operator >= for argument types: DATE, STRING
    Signature: T1 >= T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {STRING, DATE} at [34:11]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:10:49.695112 [info ] [MainThread]: 
[0m13:10:49.695537 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:10:49.699138 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.797898, "process_user_time": 2.69988, "process_kernel_time": 1.528954, "process_mem_max_rss": "210436096", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:10:49.700281 [debug] [MainThread]: Command `dbt run` failed at 13:10:49.700078 after 5.80 seconds
[0m13:10:49.700879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130567280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103af3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130350910>]}
[0m13:10:49.701292 [debug] [MainThread]: Flushing usage events
[0m13:12:01.366336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce7ed0>]}


============================== 13:12:01.373632 | 55170415-10c1-472d-a761-db6577aabad9 ==============================
[0m13:12:01.373632 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:12:01.374669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_users_groups', 'send_anonymous_usage_stats': 'True'}
[0m13:12:03.308987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55170415-10c1-472d-a761-db6577aabad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130288fc0>]}
[0m13:12:03.403319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55170415-10c1-472d-a761-db6577aabad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f59590>]}
[0m13:12:03.404649 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m13:12:03.600709 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:12:03.842856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:12:03.844213 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_users_groups.sql
[0m13:12:04.302303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55170415-10c1-472d-a761-db6577aabad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1305c8550>]}
[0m13:12:04.501267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55170415-10c1-472d-a761-db6577aabad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1300a7d40>]}
[0m13:12:04.502135 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m13:12:04.502475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55170415-10c1-472d-a761-db6577aabad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130856890>]}
[0m13:12:04.505330 [info ] [MainThread]: 
[0m13:12:04.506329 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:12:04.507806 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m13:12:04.508365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:05.752636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m13:12:05.753142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:06.011837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55170415-10c1-472d-a761-db6577aabad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130777520>]}
[0m13:12:06.012390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:12:06.012632 [info ] [MainThread]: 
[0m13:12:06.015308 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m13:12:06.015787 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m13:12:06.016129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m13:12:06.016382 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m13:12:06.031678 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m13:12:06.033248 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m13:12:06.060934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:06.363463 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m13:12:06.365988 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time)) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM( CASE WHEN e.final_response = 'yes' THEN 1 ELSE 0 END ) AS accept_event_cnt,
        SUM( CASE WHEN e.final_response != 'yes' THEN 1 ELSE 0 END ) AS decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m13:12:06.670300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:0a87bad6-5e6f-4116-aa19-c454cdb25524&page=queryresults
[0m13:12:06.856379 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/keira-xebia/queries/0a87bad6-5e6f-4116-aa19-c454cdb25524?maxResults=0&location=EU&prettyPrint=false: SELECT list expression references g.user_id which is neither grouped nor aggregated at [25:9]')
[0m13:12:07.591745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:03ac3acd-be96-4477-bee1-760edee82611&page=queryresults
[0m13:12:07.673979 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:03ac3acd-be96-4477-bee1-760edee82611&page=queryresults
[0m13:12:07.684372 [debug] [Thread-1 (]: Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  SELECT list expression references g.user_id which is neither grouped nor aggregated at [25:9]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:12:07.685630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55170415-10c1-472d-a761-db6577aabad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13083b050>]}
[0m13:12:07.686150 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_users_groups ..... [[31mERROR[0m in 1.67s]
[0m13:12:07.686599 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m13:12:07.688112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:07.688397 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m13:12:07.688605 [info ] [MainThread]: 
[0m13:12:07.688821 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m13:12:07.689346 [debug] [MainThread]: Command end result
[0m13:12:07.756217 [info ] [MainThread]: 
[0m13:12:07.757143 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:12:07.757548 [info ] [MainThread]: 
[0m13:12:07.758227 [error] [MainThread]:   Database Error in model certified_users_groups (models/Certified/certified_users_groups.sql)
  SELECT list expression references g.user_id which is neither grouped nor aggregated at [25:9]
  compiled code at target/run/keira_project/models/Certified/certified_users_groups.sql
[0m13:12:07.758739 [info ] [MainThread]: 
[0m13:12:07.759264 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:12:07.763048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5013647, "process_user_time": 2.698383, "process_kernel_time": 1.539031, "process_mem_max_rss": "208961536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:12:07.763880 [debug] [MainThread]: Command `dbt run` failed at 13:12:07.763769 after 6.50 seconds
[0m13:12:07.764540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1304eae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130250870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302507d0>]}
[0m13:12:07.765094 [debug] [MainThread]: Flushing usage events
[0m13:13:22.422901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107836660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117abed0>]}


============================== 13:13:22.433682 | 7e9320b6-6678-45b8-b370-81fde86de390 ==============================
[0m13:13:22.433682 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:13:22.434872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models certified_users_groups', 'send_anonymous_usage_stats': 'True'}
[0m13:13:24.561366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e9320b6-6678-45b8-b370-81fde86de390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121488fc0>]}
[0m13:13:24.657171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e9320b6-6678-45b8-b370-81fde86de390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121259590>]}
[0m13:13:24.658690 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m13:13:24.872233 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:13:25.115720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:25.116922 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_users_groups.sql
[0m13:13:25.577359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e9320b6-6678-45b8-b370-81fde86de390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217c8550>]}
[0m13:13:25.774627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e9320b6-6678-45b8-b370-81fde86de390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213a7d40>]}
[0m13:13:25.775379 [info ] [MainThread]: Found 14 models, 4 data tests, 4 sources, 484 macros
[0m13:13:25.775904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e9320b6-6678-45b8-b370-81fde86de390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12213a890>]}
[0m13:13:25.778901 [info ] [MainThread]: 
[0m13:13:25.780396 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:13:25.781826 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m13:13:25.782451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:26.170701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m13:13:26.171119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:26.415704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e9320b6-6678-45b8-b370-81fde86de390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122077520>]}
[0m13:13:26.416257 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:26.416495 [info ] [MainThread]: 
[0m13:13:26.419194 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users_groups
[0m13:13:26.420048 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m13:13:26.420701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_users_groups)
[0m13:13:26.421273 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users_groups
[0m13:13:26.438091 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m13:13:26.439904 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users_groups
[0m13:13:26.469093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:26.772365 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m13:13:26.774208 [debug] [Thread-1 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time)) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM( CASE WHEN e.final_response = 'yes' THEN 1 ELSE 0 END ) AS accept_event_cnt,
        SUM( CASE WHEN e.final_response != 'yes' THEN 1 ELSE 0 END ) AS decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
    GROUP BY g.user_id, g.join_group_id, g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m13:13:27.156493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:046c36f9-2547-45b9-879a-82f25a7db230&page=queryresults
[0m13:13:30.032026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e9320b6-6678-45b8-b370-81fde86de390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122162690>]}
[0m13:13:30.033192 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_users_groups ......... [[32mCREATE TABLE (69.5k rows, 11.7 MiB processed)[0m in 3.61s]
[0m13:13:30.034411 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users_groups
[0m13:13:30.037062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:30.037714 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m13:13:30.038232 [info ] [MainThread]: 
[0m13:13:30.038615 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m13:13:30.039613 [debug] [MainThread]: Command end result
[0m13:13:30.106225 [info ] [MainThread]: 
[0m13:13:30.106895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:30.107320 [info ] [MainThread]: 
[0m13:13:30.107729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:13:30.112163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.810747, "process_user_time": 2.852393, "process_kernel_time": 1.654043, "process_mem_max_rss": "208453632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:13:30.112859 [debug] [MainThread]: Command `dbt run` succeeded at 13:13:30.112754 after 7.81 seconds
[0m13:13:30.113242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216ff280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122036fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117beb70>]}
[0m13:13:30.113932 [debug] [MainThread]: Flushing usage events
[0m14:09:57.289924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066abed0>]}


============================== 14:09:57.298857 | 02438e6d-7838-4e38-a522-0768946a3e6f ==============================
[0m14:09:57.298857 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:09:57.299875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models stg_group_topics', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:59.249214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02438e6d-7838-4e38-a522-0768946a3e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf88fc0>]}
[0m14:09:59.346686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02438e6d-7838-4e38-a522-0768946a3e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd59590>]}
[0m14:09:59.348220 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:09:59.568648 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:09:59.820839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:09:59.822716 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_group_topics.sql
[0m14:10:00.286435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02438e6d-7838-4e38-a522-0768946a3e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcc8550>]}
[0m14:10:00.491421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02438e6d-7838-4e38-a522-0768946a3e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea7d40>]}
[0m14:10:00.492435 [info ] [MainThread]: Found 15 models, 4 data tests, 4 sources, 484 macros
[0m14:10:00.493019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02438e6d-7838-4e38-a522-0768946a3e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de625f0>]}
[0m14:10:00.496074 [info ] [MainThread]: 
[0m14:10:00.497213 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:10:00.498790 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:10:00.499345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:00.882943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:10:00.883340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:01.138442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02438e6d-7838-4e38-a522-0768946a3e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd7b930>]}
[0m14:10:01.139537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:10:01.140083 [info ] [MainThread]: 
[0m14:10:01.144786 [debug] [Thread-1 (]: Began running node model.keira_project.stg_group_topics
[0m14:10:01.145887 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.stg_group_topics .................... [RUN]
[0m14:10:01.146687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_group_topics)
[0m14:10:01.147474 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_group_topics
[0m14:10:01.164445 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_group_topics"
[0m14:10:01.165866 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_group_topics
[0m14:10:01.243655 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_group_topics"
[0m14:10:01.246024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:01.249347 [debug] [Thread-1 (]: On model.keira_project.stg_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH group_topics AS (
    SELECT
        group_id,
        topic
    FROM `keira-xebia`.`meetupservice`.`source_groups`,
    UNNEST(topics) AS topic
)

SELECT
    group_id,
    topic
FROM group_topics
    );
  
[0m14:10:01.800688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:c6ab2649-437e-4571-b2ff-69de17fabeac&page=queryresults
[0m14:10:04.151685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02438e6d-7838-4e38-a522-0768946a3e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da668d0>]}
[0m14:10:04.152268 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.stg_group_topics ............... [[32mCREATE TABLE (7.7k rows, 147.1 KiB processed)[0m in 3.00s]
[0m14:10:04.152782 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_group_topics
[0m14:10:04.154342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:04.154716 [debug] [MainThread]: Connection 'model.keira_project.stg_group_topics' was properly closed.
[0m14:10:04.155071 [info ] [MainThread]: 
[0m14:10:04.155793 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m14:10:04.156770 [debug] [MainThread]: Command end result
[0m14:10:04.221655 [info ] [MainThread]: 
[0m14:10:04.222754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:04.223202 [info ] [MainThread]: 
[0m14:10:04.223786 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:10:04.228285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0470395, "process_user_time": 2.693703, "process_kernel_time": 1.577762, "process_mem_max_rss": "208912384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:04.229494 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:04.229267 after 7.05 seconds
[0m14:10:04.230049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de3ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd36fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066beb70>]}
[0m14:10:04.230438 [debug] [MainThread]: Flushing usage events
[0m14:27:21.019607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130eabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130eabed0>]}


============================== 14:27:21.029269 | e77c5537-b334-417d-9434-916516912dfe ==============================
[0m14:27:21.029269 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:27:21.030372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_group_topics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:23.178727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77c5537-b334-417d-9434-916516912dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140788fc0>]}
[0m14:27:23.269522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e77c5537-b334-417d-9434-916516912dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140459590>]}
[0m14:27:23.270673 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:27:23.461655 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:27:23.708916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:27:23.710289 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_group_topics.sql
[0m14:27:24.183867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77c5537-b334-417d-9434-916516912dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ccc550>]}
[0m14:27:24.382212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77c5537-b334-417d-9434-916516912dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1406a7d40>]}
[0m14:27:24.383130 [info ] [MainThread]: Found 16 models, 4 data tests, 4 sources, 484 macros
[0m14:27:24.383605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77c5537-b334-417d-9434-916516912dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e5e7b0>]}
[0m14:27:24.386612 [info ] [MainThread]: 
[0m14:27:24.387508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:27:24.388752 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:27:24.389412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:24.759745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:27:24.760168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:25.010143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77c5537-b334-417d-9434-916516912dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140d7fa00>]}
[0m14:27:25.010664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:25.010895 [info ] [MainThread]: 
[0m14:27:25.015487 [debug] [Thread-1 (]: Began running node model.keira_project.certified_group_topics
[0m14:27:25.016472 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_group_topics .............. [RUN]
[0m14:27:25.017145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_group_topics)
[0m14:27:25.017728 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_group_topics
[0m14:27:25.034979 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m14:27:25.036531 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_group_topics
[0m14:27:25.120949 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_group_topics"
[0m14:27:25.123470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:25.126332 [debug] [Thread-1 (]: On model.keira_project.certified_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH topics AS (
    SELECT
        group_id,
        topic
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics`
),

topicgroup AS(
    SELECT 
        t.group_id,
        t.topic,
        COUNT (DISTINCT g.group_id) AS topic_group_cnt,
        COUNT (u.user_id) AS topic_user_cnt 
    FROM topics t
    JOIN `keira-xebia`.`meetupservice`.`certified_groups` g
    ON t.topic = g.topic 
    JOIN `keira-xebia`.`meetupservice`.`certified_users_groups` u
    ON g.group_id = u.join_group_id 
    GROUP BY t.group_id, t.topic 
)

SELECT
    group_id,
    topic,
    topic_group_cnt, 
    topic_user_cnt
FROM topicgroup
    );
  
[0m14:27:25.770084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:36d7a557-eb43-4871-a1a4-7f300510323e&page=queryresults
[0m14:27:25.871700 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name topic not found inside g at [30:20]; reason: invalidQuery, location: query, message: Name topic not found inside g at [30:20]')
[0m14:27:26.793983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:fc4cc70f-55b8-4bf0-a8c0-67ae2e688f5e&page=queryresults
[0m14:27:26.869434 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:fc4cc70f-55b8-4bf0-a8c0-67ae2e688f5e&page=queryresults
[0m14:27:26.880063 [debug] [Thread-1 (]: Database Error in model certified_group_topics (models/Certified/certified_group_topics.sql)
  Name topic not found inside g at [30:20]
  compiled code at target/run/keira_project/models/Certified/certified_group_topics.sql
[0m14:27:26.881997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e77c5537-b334-417d-9434-916516912dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e56f90>]}
[0m14:27:26.882732 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_group_topics ..... [[31mERROR[0m in 1.86s]
[0m14:27:26.883324 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_group_topics
[0m14:27:26.884879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:26.885128 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m14:27:26.885337 [info ] [MainThread]: 
[0m14:27:26.885552 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m14:27:26.886005 [debug] [MainThread]: Command end result
[0m14:27:26.943975 [info ] [MainThread]: 
[0m14:27:26.944661 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:27:26.945079 [info ] [MainThread]: 
[0m14:27:26.945576 [error] [MainThread]:   Database Error in model certified_group_topics (models/Certified/certified_group_topics.sql)
  Name topic not found inside g at [30:20]
  compiled code at target/run/keira_project/models/Certified/certified_group_topics.sql
[0m14:27:26.945995 [info ] [MainThread]: 
[0m14:27:26.946472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:27:26.950973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.05894, "process_user_time": 2.809198, "process_kernel_time": 1.638779, "process_mem_max_rss": "210255872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:26.951805 [debug] [MainThread]: Command `dbt run` failed at 14:27:26.951655 after 6.06 seconds
[0m14:27:26.952203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ec1860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106563570>]}
[0m14:27:26.952789 [debug] [MainThread]: Flushing usage events
[0m14:36:39.841154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e7ed0>]}


============================== 14:36:39.851575 | 39f9ef27-635c-4c9b-b231-3e759cbe0484 ==============================
[0m14:36:39.851575 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:36:39.853183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_group_topics', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:36:41.837438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39f9ef27-635c-4c9b-b231-3e759cbe0484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d88fc0>]}
[0m14:36:41.948881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39f9ef27-635c-4c9b-b231-3e759cbe0484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b59590>]}
[0m14:36:41.950841 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:36:42.171000 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:36:42.420929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:42.422153 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_group_topics.sql
[0m14:36:42.886021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39f9ef27-635c-4c9b-b231-3e759cbe0484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211dc550>]}
[0m14:36:43.088656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39f9ef27-635c-4c9b-b231-3e759cbe0484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ca7d40>]}
[0m14:36:43.089554 [info ] [MainThread]: Found 16 models, 4 data tests, 4 sources, 484 macros
[0m14:36:43.090260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f9ef27-635c-4c9b-b231-3e759cbe0484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12136e5f0>]}
[0m14:36:43.093213 [info ] [MainThread]: 
[0m14:36:43.094187 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:36:43.095613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:36:43.096158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:43.477081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:36:43.477441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:43.747990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f9ef27-635c-4c9b-b231-3e759cbe0484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12127fa00>]}
[0m14:36:43.748506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:43.748743 [info ] [MainThread]: 
[0m14:36:43.750790 [debug] [Thread-1 (]: Began running node model.keira_project.certified_group_topics
[0m14:36:43.751227 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_group_topics .............. [RUN]
[0m14:36:43.751555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_group_topics)
[0m14:36:43.751804 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_group_topics
[0m14:36:43.762667 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m14:36:43.764323 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_group_topics
[0m14:36:43.849250 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_group_topics"
[0m14:36:43.850714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:43.853666 [debug] [Thread-1 (]: On model.keira_project.certified_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH topics AS (
    SELECT
        group_id,
        topic,
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics`
),

WITH  topicgroup AS(
    SELECT 
        t.topic,
        COUNT (DISTINCT t.group_id) AS topic_group_cnt,
        COUNT (u.user_id) AS topic_user_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics` t
    JOIN `keira-xebia`.`meetupservice`.`certified_users_groups` u
    ON t.group_id = u.join_group_id 
    GROUP BY t.topic
),

staging AS(
    SELECT
        t.group_id,
        t.topic,
        g.topic_group_cnt,
        g.topic_user_cnt
    FROM topic t
    JOIN topicgroup g
    ON t.topic = g.topic 
)


SELECT
    group_id,
    topic,
    topic_group_cnt, 
    topic_user_cnt
FROM staging
    );
  
[0m14:36:44.362879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:a99c576a-23ea-4903-a547-e13a42c0780a&page=queryresults
[0m14:36:44.363487 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]')
[0m14:36:44.667927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:a7cafd08-3881-4a9d-b7c8-416525ca1a83&page=queryresults
[0m14:36:44.668490 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:US:a7cafd08-3881-4a9d-b7c8-416525ca1a83&page=queryresults
[0m14:36:44.678686 [debug] [Thread-1 (]: Database Error in model certified_group_topics (models/Certified/certified_group_topics.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
  compiled code at target/run/keira_project/models/Certified/certified_group_topics.sql
[0m14:36:44.679930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f9ef27-635c-4c9b-b231-3e759cbe0484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121342ed0>]}
[0m14:36:44.680428 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_group_topics ..... [[31mERROR[0m in 0.93s]
[0m14:36:44.680869 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_group_topics
[0m14:36:44.682343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:44.682629 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m14:36:44.682860 [info ] [MainThread]: 
[0m14:36:44.683102 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m14:36:44.683641 [debug] [MainThread]: Command end result
[0m14:36:44.762071 [info ] [MainThread]: 
[0m14:36:44.764577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:36:44.766205 [info ] [MainThread]: 
[0m14:36:44.767074 [error] [MainThread]:   Database Error in model certified_group_topics (models/Certified/certified_group_topics.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
  compiled code at target/run/keira_project/models/Certified/certified_group_topics.sql
[0m14:36:44.767624 [info ] [MainThread]: 
[0m14:36:44.768356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:36:44.772121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.0605097, "process_user_time": 2.725261, "process_kernel_time": 1.605696, "process_mem_max_rss": "208551936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:44.772946 [debug] [MainThread]: Command `dbt run` failed at 14:36:44.772870 after 5.06 seconds
[0m14:36:44.773562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213c14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213e6cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213e7070>]}
[0m14:36:44.774298 [debug] [MainThread]: Flushing usage events
[0m14:37:12.587321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be7ed0>]}


============================== 14:37:12.595367 | ac14d010-97d9-4517-bd30-db4da7a18371 ==============================
[0m14:37:12.595367 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:37:12.596530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models certified_group_topics', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:37:14.595059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac14d010-97d9-4517-bd30-db4da7a18371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e88fc0>]}
[0m14:37:14.695984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac14d010-97d9-4517-bd30-db4da7a18371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126459590>]}
[0m14:37:14.697776 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m14:37:14.881475 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:37:15.138890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:37:15.140363 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_group_topics.sql
[0m14:37:15.620543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac14d010-97d9-4517-bd30-db4da7a18371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1331b4550>]}
[0m14:37:15.826997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac14d010-97d9-4517-bd30-db4da7a18371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265a7d40>]}
[0m14:37:15.827788 [info ] [MainThread]: Found 16 models, 4 data tests, 4 sources, 484 macros
[0m14:37:15.828374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac14d010-97d9-4517-bd30-db4da7a18371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13335e5f0>]}
[0m14:37:15.831863 [info ] [MainThread]: 
[0m14:37:15.833138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:37:15.834809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m14:37:15.835406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:16.200158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m14:37:16.200558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:16.445431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac14d010-97d9-4517-bd30-db4da7a18371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13327fa00>]}
[0m14:37:16.446447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:16.447195 [info ] [MainThread]: 
[0m14:37:16.453275 [debug] [Thread-1 (]: Began running node model.keira_project.certified_group_topics
[0m14:37:16.454536 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_group_topics .............. [RUN]
[0m14:37:16.455141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_group_topics)
[0m14:37:16.455738 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_group_topics
[0m14:37:16.473656 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m14:37:16.475277 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_group_topics
[0m14:37:16.562365 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_group_topics"
[0m14:37:16.564204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:16.567394 [debug] [Thread-1 (]: On model.keira_project.certified_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH topics AS(
    SELECT
        group_id,
        topic,
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics`
),

topicgroup AS(
    SELECT 
        t.topic,
        COUNT (DISTINCT t.group_id) AS topic_group_cnt,
        COUNT (u.user_id) AS topic_user_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics` t
    JOIN `keira-xebia`.`meetupservice`.`certified_users_groups` u
    ON t.group_id = u.join_group_id 
    GROUP BY t.topic
),

staging AS(
    SELECT
        t.group_id,
        t.topic,
        g.topic_group_cnt,
        g.topic_user_cnt
    FROM topic t
    JOIN topicgroup g
    ON t.topic = g.topic 
)


SELECT
    group_id,
    topic,
    topic_group_cnt, 
    topic_user_cnt
FROM staging
    );
  
[0m14:37:16.858617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f93b0606-9642-45b1-9010-c8fa69c94ce1&page=queryresults
[0m14:37:16.859190 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "topic" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: topic, message: Table "topic" must be qualified with a dataset (e.g. dataset.table).')
[0m14:37:18.257489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d3dc5994-191c-4262-a473-33589abcf7b0&page=queryresults
[0m14:37:18.258318 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d3dc5994-191c-4262-a473-33589abcf7b0&page=queryresults
[0m14:37:18.269834 [debug] [Thread-1 (]: Database Error in model certified_group_topics (models/Certified/certified_group_topics.sql)
  Table "topic" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_group_topics.sql
[0m14:37:18.271253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac14d010-97d9-4517-bd30-db4da7a18371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133342ed0>]}
[0m14:37:18.271795 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model meetupservice.certified_group_topics ..... [[31mERROR[0m in 1.82s]
[0m14:37:18.272277 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_group_topics
[0m14:37:18.273889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:18.274140 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m14:37:18.274352 [info ] [MainThread]: 
[0m14:37:18.274654 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m14:37:18.275705 [debug] [MainThread]: Command end result
[0m14:37:18.334464 [info ] [MainThread]: 
[0m14:37:18.335404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:37:18.335950 [info ] [MainThread]: 
[0m14:37:18.336513 [error] [MainThread]:   Database Error in model certified_group_topics (models/Certified/certified_group_topics.sql)
  Table "topic" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/keira_project/models/Certified/certified_group_topics.sql
[0m14:37:18.337029 [info ] [MainThread]: 
[0m14:37:18.337452 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:37:18.341761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8666854, "process_user_time": 2.730556, "process_kernel_time": 1.589004, "process_mem_max_rss": "208781312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:37:18.342916 [debug] [MainThread]: Command `dbt run` failed at 14:37:18.342641 after 5.87 seconds
[0m14:37:18.343503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333b94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333e2cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333e3070>]}
[0m14:37:18.344055 [debug] [MainThread]: Flushing usage events
[0m15:14:45.241160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bebed0>]}


============================== 15:14:45.249411 | 079ad623-f3dc-45f4-a613-c4077eb521c3 ==============================
[0m15:14:45.249411 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:14:45.250330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_group_topics', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:47.195680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '079ad623-f3dc-45f4-a613-c4077eb521c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c088fc0>]}
[0m15:14:47.298540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '079ad623-f3dc-45f4-a613-c4077eb521c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b659590>]}
[0m15:14:47.300028 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:14:47.519988 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:14:47.772086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:47.773460 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Certified/certified_group_topics.sql
[0m15:14:48.265367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '079ad623-f3dc-45f4-a613-c4077eb521c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4e4550>]}
[0m15:14:48.479368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '079ad623-f3dc-45f4-a613-c4077eb521c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7a7d40>]}
[0m15:14:48.480382 [info ] [MainThread]: Found 16 models, 4 data tests, 4 sources, 484 macros
[0m15:14:48.480890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079ad623-f3dc-45f4-a613-c4077eb521c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9665f0>]}
[0m15:14:48.484605 [info ] [MainThread]: 
[0m15:14:48.485509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:14:48.486769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m15:14:48.487208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:48.874047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m15:14:48.874427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:49.125316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079ad623-f3dc-45f4-a613-c4077eb521c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c57fa00>]}
[0m15:14:49.126370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:49.127091 [info ] [MainThread]: 
[0m15:14:49.131811 [debug] [Thread-1 (]: Began running node model.keira_project.certified_group_topics
[0m15:14:49.132986 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_group_topics .............. [RUN]
[0m15:14:49.133618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_group_topics)
[0m15:14:49.134210 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_group_topics
[0m15:14:49.153388 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m15:14:49.155158 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_group_topics
[0m15:14:49.245123 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_group_topics"
[0m15:14:49.246776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:49.249492 [debug] [Thread-1 (]: On model.keira_project.certified_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH topics AS(
    SELECT
        group_id,
        topic,
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics`
),

topicgroup AS(
    SELECT 
        t.topic,
        COUNT (DISTINCT t.group_id) AS topic_group_cnt,
        COUNT (u.user_id) AS topic_user_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics` t
    JOIN `keira-xebia`.`meetupservice`.`certified_users_groups` u
    ON t.group_id = u.join_group_id 
    GROUP BY t.topic
),

staging AS(
    SELECT
        t.group_id,
        t.topic,
        g.topic_group_cnt,
        g.topic_user_cnt
    FROM topics t
    JOIN topicgroup g
    ON t.topic = g.topic 
)


SELECT
    group_id,
    topic,
    topic_group_cnt, 
    topic_user_cnt
FROM staging
    );
  
[0m15:14:49.772341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:748653c5-ea54-4999-a258-373057821855&page=queryresults
[0m15:14:52.955545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '079ad623-f3dc-45f4-a613-c4077eb521c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d942990>]}
[0m15:14:52.956142 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_group_topics ......... [[32mCREATE TABLE (7.4k rows, 2.2 MiB processed)[0m in 3.82s]
[0m15:14:52.956612 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_group_topics
[0m15:14:52.958247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:52.958708 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m15:14:52.959322 [info ] [MainThread]: 
[0m15:14:52.959954 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m15:14:52.961103 [debug] [MainThread]: Command end result
[0m15:14:53.022151 [info ] [MainThread]: 
[0m15:14:53.023274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:53.023937 [info ] [MainThread]: 
[0m15:14:53.024725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:14:53.028359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9082727, "process_user_time": 2.592894, "process_kernel_time": 1.682995, "process_mem_max_rss": "209682432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:53.029643 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:53.029312 after 7.91 seconds
[0m15:14:53.030316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d946fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c051630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0507d0>]}
[0m15:14:53.030915 [debug] [MainThread]: Flushing usage events
[0m22:41:16.378454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105036660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe7ed0>]}


============================== 22:41:16.386254 | ce5ab7ee-240c-4013-b237-acd35e136da6 ==============================
[0m22:41:16.386254 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:41:16.387385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'profiles_dir': '/Users/keirayang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:18.343097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117488fc0>]}
[0m22:41:18.437193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117059590>]}
[0m22:41:18.438706 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m22:41:18.643295 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:41:18.893405 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m22:41:18.894601 [debug] [MainThread]: Partial parsing: added file: keira_project://models/events/stg_events.sql
[0m22:41:18.895546 [debug] [MainThread]: Partial parsing: added file: keira_project://models/events/stg_events_o.sql
[0m22:41:18.896069 [debug] [MainThread]: Partial parsing: added file: keira_project://models/events/certified_events_users_rsvp.sql
[0m22:41:18.896625 [debug] [MainThread]: Partial parsing: added file: keira_project://models/events/stg_events_rsvp.sql
[0m22:41:18.897064 [debug] [MainThread]: Partial parsing: added file: keira_project://models/events/certified_events.sql
[0m22:41:18.897557 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/Staging/stg_events_o.sql
[0m22:41:18.898046 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m22:41:18.898428 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/Staging/stg_events.sql
[0m22:41:18.898887 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/Staging/stg_events_rsvp.sql
[0m22:41:18.899388 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/Certified/certified_events.sql
[0m22:41:19.385015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177c4550>]}
[0m22:41:19.586683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172a7d40>]}
[0m22:41:19.587572 [info ] [MainThread]: Found 16 models, 4 data tests, 4 sources, 484 macros
[0m22:41:19.588112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117900e50>]}
[0m22:41:19.592707 [info ] [MainThread]: 
[0m22:41:19.593756 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:41:19.603527 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m22:41:19.604420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:19.969031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m22:41:19.969445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:20.232668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11788fa00>]}
[0m22:41:20.233201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:41:20.233456 [info ] [MainThread]: 
[0m22:41:20.236169 [debug] [Thread-4 (]: Began running node model.keira_project.stg_groups
[0m22:41:20.236491 [debug] [Thread-3 (]: Began running node model.keira_project.stg_group_topics
[0m22:41:20.240847 [info ] [Thread-3 (]: 3 of 16 START sql table model meetupservice.stg_group_topics ................... [RUN]
[0m22:41:20.241231 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_o
[0m22:41:20.241482 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m22:41:20.241910 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.stg_group_topics'
[0m22:41:20.242265 [info ] [Thread-4 (]: 4 of 16 START sql table model meetupservice.stg_groups ......................... [RUN]
[0m22:41:20.242633 [info ] [Thread-2 (]: 2 of 16 START sql table model meetupservice.stg_events_o ....................... [RUN]
[0m22:41:20.243411 [info ] [Thread-1 (]: 1 of 16 START sql table model meetupservice.my_first_dbt_model ................. [RUN]
[0m22:41:20.243945 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_group_topics
[0m22:41:20.244899 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.stg_groups'
[0m22:41:20.245739 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.stg_events_o'
[0m22:41:20.246282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m22:41:20.259678 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_groups
[0m22:41:20.261790 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_group_topics"
[0m22:41:20.262654 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_o
[0m22:41:20.263261 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m22:41:20.268657 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m22:41:20.275109 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m22:41:20.279124 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m22:41:20.279818 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_group_topics
[0m22:41:20.309456 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:41:20.310448 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_groups
[0m22:41:20.313854 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m22:41:20.318516 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:41:20.409541 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_o
[0m22:41:20.414365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:20.513660 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:41:20.912373 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_group_topics"
[0m22:41:20.914488 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m22:41:20.916278 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_first_dbt_model"
[0m22:41:20.918125 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m22:41:20.920065 [debug] [Thread-3 (]: On model.keira_project.stg_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH group_topics AS (
    SELECT
        group_id,
        topic
    FROM `keira-xebia`.`meetupservice`.`source_groups`,
    UNNEST(topics) AS topic
)

SELECT
    group_id,
    topic
FROM group_topics
    );
  
[0m22:41:20.922546 [debug] [Thread-1 (]: On model.keira_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_first_dbt_model"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m22:41:20.924600 [debug] [Thread-4 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_year, 
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_month,
      description AS group_description,
      city AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m22:41:20.927214 [debug] [Thread-2 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(FARM_FINGERPRINT(
            CONCAT(event_name, CAST(group_id AS STRING), CAST(venue_id AS STRING), CAST(event_start_time AS STRING))) 
            AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsvp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m22:41:21.156269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:8b631286-6f16-4e8b-9cd2-a821ea057c32&page=queryresults
[0m22:41:21.247498 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:22f8af75-69a8-4e07-80df-a2c534c14efd&page=queryresults
[0m22:41:21.259383 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2562c582-18cc-4c3c-afa5-8cf16be0b3f4&page=queryresults
[0m22:41:21.638567 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:c82fde8e-5a7a-4827-9218-777b0abc6f6e&page=queryresults
[0m22:41:23.164080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179a3350>]}
[0m22:41:23.165406 [info ] [Thread-1 (]: 1 of 16 OK created sql table model meetupservice.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.92s]
[0m22:41:23.166539 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m22:41:23.167250 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users
[0m22:41:23.168081 [info ] [Thread-1 (]: 5 of 16 START sql table model meetupservice.stg_users .......................... [RUN]
[0m22:41:23.168826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_first_dbt_model, now model.keira_project.stg_users)
[0m22:41:23.169338 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users
[0m22:41:23.174026 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m22:41:23.175523 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users
[0m22:41:23.178808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:23.438658 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m22:41:23.440999 [debug] [Thread-1 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        country AS user_country,
        city AS user_city,
        hometown AS user_hometown
    FROM `keira-xebia`.`meetupservice`.`source_users`   
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM users
    );
  
[0m22:41:23.576151 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c5dd30>]}
[0m22:41:23.576703 [info ] [Thread-3 (]: 3 of 16 OK created sql table model meetupservice.stg_group_topics .............. [[32mCREATE TABLE (7.7k rows, 147.1 KiB processed)[0m in 3.33s]
[0m22:41:23.577197 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_group_topics
[0m22:41:23.577538 [debug] [Thread-3 (]: Began running node model.keira_project.stg_users_groups
[0m22:41:23.577940 [info ] [Thread-3 (]: 6 of 16 START sql table model meetupservice.stg_users_groups ................... [RUN]
[0m22:41:23.578268 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_group_topics, now model.keira_project.stg_users_groups)
[0m22:41:23.578542 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_users_groups
[0m22:41:23.581033 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m22:41:23.582448 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_users_groups
[0m22:41:23.584049 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:23.708753 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ea35d407-55b3-44ae-9a43-1ee735365572&page=queryresults
[0m22:41:23.828292 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m22:41:23.832073 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a0cff0>]}
[0m22:41:23.833390 [info ] [Thread-4 (]: 4 of 16 OK created sql table model meetupservice.stg_groups .................... [[32mCREATE TABLE (711.0 rows, 442.7 KiB processed)[0m in 3.59s]
[0m22:41:23.834510 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_groups
[0m22:41:23.835271 [debug] [Thread-4 (]: Began running node model.keira_project.stg_venues
[0m22:41:23.835791 [info ] [Thread-4 (]: 7 of 16 START sql table model meetupservice.stg_venues ......................... [RUN]
[0m22:41:23.836416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_groups, now model.keira_project.stg_venues)
[0m22:41:23.837173 [debug] [Thread-3 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        TIMESTAMP_SECONDS(CAST(membership.joined / 1000 AS INT64)) AS join_group_time --timestamp
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_time
FROM usergroup
    );
  
[0m22:41:23.837514 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_venues
[0m22:41:23.843413 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_venues"
[0m22:41:23.844867 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_venues
[0m22:41:23.847839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:41:24.087977 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_venues"
[0m22:41:24.089165 [debug] [Thread-4 (]: On model.keira_project.stg_venues: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_venues"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_venues`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    venue_id,
    name AS venue_name,
    city AS venue_city,
    country AS venue_country,
    lat AS venue_lat,
    lon AS venue_lon
FROM `keira-xebia`.`meetupservice`.`source_venues`
    );
  
[0m22:41:24.205381 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:292e3450-0704-4b17-a9e2-70fcc1f4016c&page=queryresults
[0m22:41:24.472040 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:cf97d6b7-e4b4-4b27-8b9f-8412ad118509&page=queryresults
[0m22:41:25.979760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117973cd0>]}
[0m22:41:25.980280 [info ] [Thread-2 (]: 2 of 16 OK created sql table model meetupservice.stg_events_o .................. [[32mCREATE TABLE (174.1k rows, 12.1 MiB processed)[0m in 5.73s]
[0m22:41:25.980712 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_o
[0m22:41:25.981011 [debug] [Thread-2 (]: Began running node model.keira_project.my_second_dbt_model
[0m22:41:25.981306 [info ] [Thread-2 (]: 8 of 16 START sql view model meetupservice.my_second_dbt_model ................. [RUN]
[0m22:41:25.981735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_o, now model.keira_project.my_second_dbt_model)
[0m22:41:25.981981 [debug] [Thread-2 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m22:41:25.984181 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m22:41:25.984831 [debug] [Thread-2 (]: Began executing node model.keira_project.my_second_dbt_model
[0m22:41:26.012400 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.my_second_dbt_model"
[0m22:41:26.015175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a62f20>]}
[0m22:41:26.016024 [info ] [Thread-1 (]: 5 of 16 OK created sql table model meetupservice.stg_users ..................... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 2.85s]
[0m22:41:26.016767 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users
[0m22:41:26.017443 [debug] [Thread-1 (]: Began running node model.keira_project.certified_groups
[0m22:41:26.018162 [info ] [Thread-1 (]: 9 of 16 START sql table model meetupservice.certified_groups ................... [RUN]
[0m22:41:26.019101 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:26.019813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users, now model.keira_project.certified_groups)
[0m22:41:26.022470 [debug] [Thread-2 (]: On model.keira_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_second_dbt_model"} */


  create or replace view `keira-xebia`.`meetupservice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `keira-xebia`.`meetupservice`.`my_first_dbt_model`
where id = 1;


[0m22:41:26.023068 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_groups
[0m22:41:26.120674 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_groups"
[0m22:41:26.123922 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_groups
[0m22:41:26.127766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:26.382412 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_groups"
[0m22:41:26.383954 [debug] [Thread-1 (]: On model.keira_project.certified_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_groups`
      
    
    

    OPTIONS()
    as (
      


SELECT 
    group_id, --unique identifier of a group
    group_name,
    group_created_year,
    group_created_month,
    group_description,
    group_city,
    group_lat,
    group_lon
FROM `keira-xebia`.`meetupservice`.`stg_groups`
    );
  
[0m22:41:26.513260 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a2c40493-b2bc-4945-a730-1fdc873356cc&page=queryresults
[0m22:41:26.590608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:bf63c8aa-e208-49b0-b3f9-8783ccceddbb&page=queryresults
[0m22:41:26.678332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117af4230>]}
[0m22:41:26.678893 [info ] [Thread-4 (]: 7 of 16 OK created sql table model meetupservice.stg_venues .................... [[32mCREATE TABLE (1.7k rows, 97.0 KiB processed)[0m in 2.84s]
[0m22:41:26.679332 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_venues
[0m22:41:26.679666 [debug] [Thread-4 (]: Began running node model.keira_project.stg_events
[0m22:41:26.680052 [info ] [Thread-4 (]: 10 of 16 START sql table model meetupservice.stg_events ........................ [RUN]
[0m22:41:26.680398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_venues, now model.keira_project.stg_events)
[0m22:41:26.680675 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_events
[0m22:41:26.683540 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m22:41:26.684918 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_events
[0m22:41:26.686536 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:41:26.841253 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117af63f0>]}
[0m22:41:26.842654 [info ] [Thread-2 (]: 8 of 16 OK created sql view model meetupservice.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m22:41:26.843546 [debug] [Thread-2 (]: Finished running node model.keira_project.my_second_dbt_model
[0m22:41:26.844328 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_rsvp
[0m22:41:26.845195 [info ] [Thread-2 (]: 11 of 16 START sql table model meetupservice.stg_events_rsvp ................... [RUN]
[0m22:41:26.845991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.my_second_dbt_model, now model.keira_project.stg_events_rsvp)
[0m22:41:26.846536 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m22:41:26.851668 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m22:41:26.853028 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_rsvp
[0m22:41:26.856528 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:26.959831 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m22:41:26.961379 [debug] [Thread-4 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
        event_description
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
    WHERE event_id IS NOT NULL 
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        city AS venue_city,
        country AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.rsvp_total_limit,
        e.event_description,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    rsvp_total_limit,
    event_description,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m22:41:27.172620 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m22:41:27.173514 [debug] [Thread-2 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM `keira-xebia`.`meetupservice`.`stg_events_o`
    );
  
[0m22:41:27.211080 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1c1b8fcf-8b91-4f0b-9d55-f9738250fd21&page=queryresults
[0m22:41:27.418986 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:3ac46986-fc04-438a-b25e-70967d728417&page=queryresults
[0m22:41:27.612029 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117af4890>]}
[0m22:41:27.612660 [info ] [Thread-3 (]: 6 of 16 OK created sql table model meetupservice.stg_users_groups .............. [[32mCREATE TABLE (145.5k rows, 4.5 MiB processed)[0m in 4.03s]
[0m22:41:27.613168 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_users_groups
[0m22:41:27.613515 [debug] [Thread-3 (]: Began running node model.keira_project.certified_users
[0m22:41:27.613850 [info ] [Thread-3 (]: 12 of 16 START sql table model meetupservice.certified_users ................... [RUN]
[0m22:41:27.614205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users_groups, now model.keira_project.certified_users)
[0m22:41:27.614514 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_users
[0m22:41:27.617214 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_users"
[0m22:41:27.618088 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_users
[0m22:41:27.620062 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:27.864818 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_users"
[0m22:41:27.866376 [debug] [Thread-3 (]: On model.keira_project.certified_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM `keira-xebia`.`meetupservice`.`stg_users`
    );
  
[0m22:41:28.114990 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:df33069c-a03b-455e-a982-1fee1215fa06&page=queryresults
[0m22:41:29.219986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174ac710>]}
[0m22:41:29.220554 [info ] [Thread-1 (]: 9 of 16 OK created sql table model meetupservice.certified_groups .............. [[32mCREATE TABLE (711.0 rows, 448.3 KiB processed)[0m in 3.20s]
[0m22:41:29.220998 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_groups
[0m22:41:29.706686 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117843710>]}
[0m22:41:29.707222 [info ] [Thread-4 (]: 10 of 16 OK created sql table model meetupservice.stg_events ................... [[32mCREATE TABLE (6.2k rows, 264.4 MiB processed)[0m in 3.03s]
[0m22:41:29.707656 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_events
[0m22:41:30.324426 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117af4830>]}
[0m22:41:30.325037 [info ] [Thread-3 (]: 12 of 16 OK created sql table model meetupservice.certified_users .............. [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 2.71s]
[0m22:41:30.325531 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_users
[0m22:41:30.643100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117af7b90>]}
[0m22:41:30.643623 [info ] [Thread-2 (]: 11 of 16 OK created sql table model meetupservice.stg_events_rsvp .............. [[32mCREATE TABLE (174.1k rows, 20.4 MiB processed)[0m in 3.80s]
[0m22:41:30.644081 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_rsvp
[0m22:41:30.644767 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m22:41:30.645169 [info ] [Thread-1 (]: 13 of 16 START sql table model meetupservice.certified_events_users_rsvp ....... [RUN]
[0m22:41:30.645504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_groups, now model.keira_project.certified_events_users_rsvp)
[0m22:41:30.645770 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m22:41:30.648873 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m22:41:30.649568 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m22:41:30.651227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:30.883596 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m22:41:30.885326 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY event_id, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY event_id, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_id,
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_id,
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m22:41:31.161487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e36860e0-0919-4d18-99c1-e8e5babbf515&page=queryresults
[0m22:41:35.359830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117af4710>]}
[0m22:41:35.360415 [info ] [Thread-1 (]: 13 of 16 OK created sql table model meetupservice.certified_events_users_rsvp .. [[32mCREATE TABLE (174.0k rows, 21.7 MiB processed)[0m in 4.71s]
[0m22:41:35.360914 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m22:41:35.361512 [debug] [Thread-3 (]: Began running node model.keira_project.certified_users_groups
[0m22:41:35.361806 [debug] [Thread-4 (]: Began running node model.keira_project.certified_events
[0m22:41:35.362155 [info ] [Thread-3 (]: 15 of 16 START sql table model meetupservice.certified_users_groups ............ [RUN]
[0m22:41:35.362586 [info ] [Thread-4 (]: 14 of 16 START sql table model meetupservice.certified_events .................. [RUN]
[0m22:41:35.363278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_users, now model.keira_project.certified_users_groups)
[0m22:41:35.364152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events, now model.keira_project.certified_events)
[0m22:41:35.364490 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_users_groups
[0m22:41:35.364942 [debug] [Thread-4 (]: Began compiling node model.keira_project.certified_events
[0m22:41:35.368680 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m22:41:35.371663 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m22:41:35.372415 [debug] [Thread-4 (]: Began executing node model.keira_project.certified_events
[0m22:41:35.375968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:41:35.472704 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_users_groups
[0m22:41:35.478187 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:35.737308 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m22:41:35.738752 [debug] [Thread-3 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time)) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM( CASE WHEN e.final_response = 'yes' THEN 1 ELSE 0 END ) AS accept_event_cnt,
        SUM( CASE WHEN e.final_response != 'yes' THEN 1 ELSE 0 END ) AS decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
    GROUP BY g.user_id, g.join_group_id, g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m22:41:35.743305 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m22:41:35.744782 [debug] [Thread-4 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_id,
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_id, event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_id,
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_id,
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_id = r.event_id
)

SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m22:41:36.077710 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:eb4773d7-eb53-4c83-ac27-c550d4ce5301&page=queryresults
[0m22:41:36.078223 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ec792247-9f74-4d78-9195-b7988ef64644&page=queryresults
[0m22:41:38.571663 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179bc5f0>]}
[0m22:41:38.572219 [info ] [Thread-4 (]: 14 of 16 OK created sql table model meetupservice.certified_events ............. [[32mCREATE TABLE (6.2k rows, 31.4 MiB processed)[0m in 3.21s]
[0m22:41:38.572658 [debug] [Thread-4 (]: Finished running node model.keira_project.certified_events
[0m22:41:39.529555 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e93650>]}
[0m22:41:39.530151 [info ] [Thread-3 (]: 15 of 16 OK created sql table model meetupservice.certified_users_groups ....... [[32mCREATE TABLE (69.5k rows, 11.7 MiB processed)[0m in 4.17s]
[0m22:41:39.530608 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_users_groups
[0m22:41:39.531176 [debug] [Thread-2 (]: Began running node model.keira_project.certified_group_topics
[0m22:41:39.531502 [info ] [Thread-2 (]: 16 of 16 START sql table model meetupservice.certified_group_topics ............ [RUN]
[0m22:41:39.531800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_rsvp, now model.keira_project.certified_group_topics)
[0m22:41:39.532045 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_group_topics
[0m22:41:39.534962 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m22:41:39.536233 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_group_topics
[0m22:41:39.537876 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:39.779983 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_group_topics"
[0m22:41:39.781775 [debug] [Thread-2 (]: On model.keira_project.certified_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH topics AS(
    SELECT
        group_id,
        topic,
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics`
),

topicgroup AS(
    SELECT 
        t.topic,
        COUNT (DISTINCT t.group_id) AS topic_group_cnt,
        COUNT (u.user_id) AS topic_user_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics` t
    JOIN `keira-xebia`.`meetupservice`.`certified_users_groups` u
    ON t.group_id = u.join_group_id 
    GROUP BY t.topic
),

staging AS(
    SELECT
        t.group_id,
        t.topic,
        g.topic_group_cnt,
        g.topic_user_cnt
    FROM topics t
    JOIN topicgroup g
    ON t.topic = g.topic 
)


SELECT
    group_id,
    topic,
    topic_group_cnt, 
    topic_user_cnt
FROM staging
    );
  
[0m22:41:40.070374 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e8b8cae2-b95f-4aaf-9bbe-4950081938af&page=queryresults
[0m22:41:42.925144 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5ab7ee-240c-4013-b237-acd35e136da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117405070>]}
[0m22:41:42.925712 [info ] [Thread-2 (]: 16 of 16 OK created sql table model meetupservice.certified_group_topics ....... [[32mCREATE TABLE (7.4k rows, 2.2 MiB processed)[0m in 3.39s]
[0m22:41:42.926152 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_group_topics
[0m22:41:42.927217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:42.927460 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m22:41:42.927640 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m22:41:42.927810 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m22:41:42.927972 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m22:41:42.928254 [info ] [MainThread]: 
[0m22:41:42.928505 [info ] [MainThread]: Finished running 15 table models, 1 view model in 0 hours 0 minutes and 23.33 seconds (23.33s).
[0m22:41:42.930732 [debug] [MainThread]: Command end result
[0m22:41:42.977837 [info ] [MainThread]: 
[0m22:41:42.978597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:42.979305 [info ] [MainThread]: 
[0m22:41:42.979831 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m22:41:42.983793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.71786, "process_user_time": 3.844671, "process_kernel_time": 1.965294, "process_mem_max_rss": "208781312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:41:42.984590 [debug] [MainThread]: Command `dbt run` succeeded at 22:41:42.984415 after 26.72 seconds
[0m22:41:42.985063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117babe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117baba70>]}
[0m22:41:42.985580 [debug] [MainThread]: Flushing usage events
[0m12:23:48.261581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103236660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e7ed0>]}


============================== 12:23:48.270043 | 47e0140d-b57c-481b-b642-990c0a1a3fc5 ==============================
[0m12:23:48.270043 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:23:48.270847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models certified_events_users_rsvp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:50.239872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47e0140d-b57c-481b-b642-990c0a1a3fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be88fc0>]}
[0m12:23:50.332538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47e0140d-b57c-481b-b642-990c0a1a3fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b959590>]}
[0m12:23:50.333602 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:23:50.524238 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:23:50.774389 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 6 files added, 0 files changed.
[0m12:23:50.775520 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_events_o.sql
[0m12:23:50.776012 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_events_users_rsvp.sql
[0m12:23:50.776855 [debug] [MainThread]: Partial parsing: added file: keira_project://models/meetupservice.yml
[0m12:23:50.777201 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_events_rsvp.sql
[0m12:23:50.777603 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Certified/certified_events.sql
[0m12:23:50.777920 [debug] [MainThread]: Partial parsing: added file: keira_project://models/Staging/stg_events.sql
[0m12:23:50.778303 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/events/certified_events.sql
[0m12:23:50.779060 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/events/certified_events_users_rsvp.sql
[0m12:23:50.779628 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/events/stg_events_rsvp.sql
[0m12:23:50.780007 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/events/stg_events_o.sql
[0m12:23:50.780297 [debug] [MainThread]: Partial parsing: deleted file: keira_project://models/events/stg_events.sql
[0m12:23:51.610904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e0140d-b57c-481b-b642-990c0a1a3fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd71850>]}
[0m12:23:51.818892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e0140d-b57c-481b-b642-990c0a1a3fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bda7f20>]}
[0m12:23:51.819912 [info ] [MainThread]: Found 16 models, 7 data tests, 4 sources, 484 macros
[0m12:23:51.820466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e0140d-b57c-481b-b642-990c0a1a3fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11989cf30>]}
[0m12:23:51.823653 [info ] [MainThread]: 
[0m12:23:51.824405 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:51.825735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:23:51.826624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:52.210979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:23:52.211374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:52.470348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e0140d-b57c-481b-b642-990c0a1a3fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119977ba0>]}
[0m12:23:52.470910 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:52.471143 [info ] [MainThread]: 
[0m12:23:52.473672 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:23:52.474120 [info ] [Thread-1 (]: 1 of 1 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m12:23:52.474471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.certified_events_users_rsvp)
[0m12:23:52.474726 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:23:52.486728 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:23:52.488718 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:23:52.518758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:52.838879 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m12:23:52.841283 [debug] [Thread-1 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY event_id, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY event_id, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_id,
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_id,
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m12:23:53.407651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a8e7f1b5-aeeb-4687-a577-a57b36985c8e&page=queryresults
[0m12:23:58.029862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e0140d-b57c-481b-b642-990c0a1a3fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4aa090>]}
[0m12:23:58.030769 [info ] [Thread-1 (]: 1 of 1 OK created sql table model meetupservice.certified_events_users_rsvp .... [[32mCREATE TABLE (174.0k rows, 21.7 MiB processed)[0m in 5.55s]
[0m12:23:58.031266 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:23:58.032435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:58.032737 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m12:23:58.032978 [info ] [MainThread]: 
[0m12:23:58.033229 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m12:23:58.033841 [debug] [MainThread]: Command end result
[0m12:23:58.090076 [info ] [MainThread]: 
[0m12:23:58.091111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:23:58.091699 [info ] [MainThread]: 
[0m12:23:58.092111 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:23:58.095903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.942278, "process_user_time": 2.906319, "process_kernel_time": 1.597551, "process_mem_max_rss": "210436096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:23:58.096983 [debug] [MainThread]: Command `dbt run` succeeded at 12:23:58.096847 after 9.94 seconds
[0m12:23:58.097827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af15c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a66990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a66c10>]}
[0m12:23:58.098346 [debug] [MainThread]: Flushing usage events
[0m12:24:04.707324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a36660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ebed0>]}


============================== 12:24:04.716036 | 31f0d3e0-6310-4418-8c09-a59f0cf448cf ==============================
[0m12:24:04.716036 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:24:04.716800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --models certified_events_users_rsvp', 'send_anonymous_usage_stats': 'True'}
[0m12:24:06.425875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31f0d3e0-6310-4418-8c09-a59f0cf448cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d88fc0>]}
[0m12:24:06.520890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31f0d3e0-6310-4418-8c09-a59f0cf448cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b59590>]}
[0m12:24:06.522448 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:24:06.729435 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:24:06.965301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:06.965825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:07.054007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31f0d3e0-6310-4418-8c09-a59f0cf448cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c75850>]}
[0m12:24:07.295098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31f0d3e0-6310-4418-8c09-a59f0cf448cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a2e40>]}
[0m12:24:07.296234 [info ] [MainThread]: Found 16 models, 7 data tests, 4 sources, 484 macros
[0m12:24:07.296797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f0d3e0-6310-4418-8c09-a59f0cf448cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114022190>]}
[0m12:24:07.300663 [info ] [MainThread]: 
[0m12:24:07.301962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:24:07.311748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia_meetupservice'
[0m12:24:07.312318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:07.589475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f0d3e0-6310-4418-8c09-a59f0cf448cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d3520>]}
[0m12:24:07.590299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:24:07.590887 [info ] [MainThread]: 
[0m12:24:07.595916 [debug] [Thread-1 (]: Began running node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:24:07.596681 [debug] [Thread-2 (]: Began running node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:24:07.597265 [debug] [Thread-3 (]: Began running node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:24:07.597880 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist  [RUN]
[0m12:24:07.598430 [info ] [Thread-2 (]: 2 of 3 START test not_null_certified_events_users_rsvp_event_id ................ [RUN]
[0m12:24:07.599064 [info ] [Thread-3 (]: 3 of 3 START test relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_  [RUN]
[0m12:24:07.599925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f)
[0m12:24:07.600783 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5'
[0m12:24:07.601531 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016'
[0m12:24:07.602145 [debug] [Thread-1 (]: Began compiling node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:24:07.602838 [debug] [Thread-2 (]: Began compiling node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:24:07.603373 [debug] [Thread-3 (]: Began compiling node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:24:07.669249 [debug] [Thread-3 (]: Writing injected SQL for node "test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016"
[0m12:24:07.675510 [debug] [Thread-1 (]: Writing injected SQL for node "test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f"
[0m12:24:07.679673 [debug] [Thread-2 (]: Writing injected SQL for node "test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5"
[0m12:24:07.681550 [debug] [Thread-1 (]: Began executing node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:24:07.682217 [debug] [Thread-3 (]: Began executing node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:24:07.689667 [debug] [Thread-2 (]: Began executing node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:24:07.762971 [debug] [Thread-1 (]: Writing runtime sql for node "test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f"
[0m12:24:07.763865 [debug] [Thread-2 (]: Writing runtime sql for node "test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5"
[0m12:24:07.759582 [debug] [Thread-3 (]: Writing runtime sql for node "test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016"
[0m12:24:07.765379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:07.765992 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:24:07.766663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:24:07.769388 [debug] [Thread-1 (]: On test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        final_response as value_field,
        count(*) as n_records

    from `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    group by final_response

)

select *
from all_values
where value_field not in (
    'yes','no','waitlist'
)



      
    ) dbt_internal_test
[0m12:24:07.771698 [debug] [Thread-3 (]: On test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select rsvp_user_id as from_field
    from `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    where rsvp_user_id is not null
),

parent as (
    select user_id as to_field
    from `keira-xebia`.`meetupservice`.`certified_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:24:07.773961 [debug] [Thread-2 (]: On test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
where event_id is null



      
    ) dbt_internal_test
[0m12:24:08.768419 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a074a348-f1a9-4e1a-b8f5-577fa2c4a8be&page=queryresults
[0m12:24:08.769635 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:13e7ae74-cb02-4534-9eaa-29411192ff4d&page=queryresults
[0m12:24:08.785429 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:d04c9b0d-660f-4f59-a2c9-c9844795ca21&page=queryresults
[0m12:24:09.119232 [error] [Thread-2 (]: 2 of 3 FAIL 144 not_null_certified_events_users_rsvp_event_id .................. [[31mFAIL 144[0m in 1.52s]
[0m12:24:09.119852 [debug] [Thread-2 (]: Finished running node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:24:09.129708 [info ] [Thread-3 (]: 3 of 3 PASS relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_  [[32mPASS[0m in 1.53s]
[0m12:24:09.130171 [debug] [Thread-3 (]: Finished running node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:24:09.135361 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist  [[32mPASS[0m in 1.54s]
[0m12:24:09.135892 [debug] [Thread-1 (]: Finished running node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:24:09.136981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:09.137230 [debug] [MainThread]: Connection 'test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f' was properly closed.
[0m12:24:09.137415 [debug] [MainThread]: Connection 'test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5' was properly closed.
[0m12:24:09.137586 [debug] [MainThread]: Connection 'test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016' was properly closed.
[0m12:24:09.137793 [info ] [MainThread]: 
[0m12:24:09.138008 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m12:24:09.138751 [debug] [MainThread]: Command end result
[0m12:24:09.241538 [info ] [MainThread]: 
[0m12:24:09.243041 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:09.243750 [info ] [MainThread]: 
[0m12:24:09.245231 [error] [MainThread]: [31mFailure in test not_null_certified_events_users_rsvp_event_id (models/meetupservice.yml)[0m
[0m12:24:09.246084 [error] [MainThread]:   Got 144 results, configured to fail if != 0
[0m12:24:09.246519 [info ] [MainThread]: 
[0m12:24:09.246955 [info ] [MainThread]:   compiled code at target/compiled/keira_project/models/meetupservice.yml/not_null_certified_events_users_rsvp_event_id.sql
[0m12:24:09.247846 [info ] [MainThread]: 
[0m12:24:09.249230 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:24:09.254746 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.656187, "process_user_time": 2.624242, "process_kernel_time": 1.441427, "process_mem_max_rss": "206667776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:09.256478 [debug] [MainThread]: Command `dbt test` failed at 12:24:09.256073 after 4.66 seconds
[0m12:24:09.258180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440e8e0>]}
[0m12:24:09.259353 [debug] [MainThread]: Flushing usage events
[0m12:30:18.119621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10305e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7ed0>]}


============================== 12:30:18.127943 | ab734402-dd0e-480b-bcce-8ad86746caa8 ==============================
[0m12:30:18.127943 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:30:18.128924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'debug': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models stg_events_rsvp+', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:30:20.036277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c288fc0>]}
[0m12:30:20.127580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c059590>]}
[0m12:30:20.128995 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:30:20.328514 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:30:20.570620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:20.572055 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events_rsvp.sql
[0m12:30:21.020421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c7c0750>]}
[0m12:30:21.221406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c832f30>]}
[0m12:30:21.222352 [info ] [MainThread]: Found 16 models, 7 data tests, 4 sources, 484 macros
[0m12:30:21.222990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9d67b0>]}
[0m12:30:21.228086 [info ] [MainThread]: 
[0m12:30:21.229331 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:30:21.237138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:30:21.237725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:21.699665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:30:21.700127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:21.959424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c9a2d00>]}
[0m12:30:21.959956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:21.960192 [info ] [MainThread]: 
[0m12:30:21.962931 [debug] [Thread-1 (]: Began running node model.keira_project.stg_events_rsvp
[0m12:30:21.963385 [info ] [Thread-1 (]: 1 of 5 START sql table model meetupservice.stg_events_rsvp ..................... [RUN]
[0m12:30:21.963736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.stg_events_rsvp)
[0m12:30:21.963998 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m12:30:21.974026 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m12:30:21.975499 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_events_rsvp
[0m12:30:22.002382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:22.325540 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m12:30:22.327083 [debug] [Thread-1 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM `keira-xebia`.`meetupservice`.`stg_events_o`
WHERE event_id IS NOT NULL
    );
  
[0m12:30:22.836363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:17cbb24b-6a33-46f9-8304-dd94bee56900&page=queryresults
[0m12:30:26.969969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c946e10>]}
[0m12:30:26.972255 [info ] [Thread-1 (]: 1 of 5 OK created sql table model meetupservice.stg_events_rsvp ................ [[32mCREATE TABLE (174.0k rows, 20.4 MiB processed)[0m in 5.00s]
[0m12:30:26.973264 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_events_rsvp
[0m12:30:26.974834 [debug] [Thread-2 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:30:26.975993 [info ] [Thread-2 (]: 2 of 5 START sql table model meetupservice.certified_events_users_rsvp ......... [RUN]
[0m12:30:26.977234 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.certified_events_users_rsvp'
[0m12:30:26.978019 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:30:26.984681 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:30:26.986177 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:30:26.990525 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:30:27.253384 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m12:30:27.255868 [debug] [Thread-2 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY event_id, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY event_id, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_id,
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_id,
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m12:30:27.723645 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:3f235667-9233-4e75-be28-495666b9c457&page=queryresults
[0m12:30:32.166610 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c71f120>]}
[0m12:30:32.167192 [info ] [Thread-2 (]: 2 of 5 OK created sql table model meetupservice.certified_events_users_rsvp .... [[32mCREATE TABLE (173.9k rows, 21.7 MiB processed)[0m in 5.19s]
[0m12:30:32.167670 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:30:32.168302 [debug] [Thread-4 (]: Began running node model.keira_project.certified_users_groups
[0m12:30:32.168614 [debug] [Thread-3 (]: Began running node model.keira_project.certified_events
[0m12:30:32.168970 [info ] [Thread-4 (]: 4 of 5 START sql table model meetupservice.certified_users_groups .............. [RUN]
[0m12:30:32.169747 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.certified_users_groups'
[0m12:30:32.170003 [debug] [Thread-4 (]: Began compiling node model.keira_project.certified_users_groups
[0m12:30:32.169326 [info ] [Thread-3 (]: 3 of 5 START sql table model meetupservice.certified_events .................... [RUN]
[0m12:30:32.172869 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m12:30:32.173283 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.certified_events'
[0m12:30:32.173587 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_events
[0m12:30:32.177066 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:30:32.177587 [debug] [Thread-4 (]: Began executing node model.keira_project.certified_users_groups
[0m12:30:32.179240 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:30:32.268942 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_events
[0m12:30:32.273574 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:30:32.530108 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m12:30:32.532762 [debug] [Thread-3 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_id,
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_id, event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_id,
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_id,
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_id = r.event_id
)

SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m12:30:32.553854 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m12:30:32.555368 [debug] [Thread-4 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time)) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM( CASE WHEN e.final_response = 'yes' THEN 1 ELSE 0 END ) AS accept_event_cnt,
        SUM( CASE WHEN e.final_response != 'yes' THEN 1 ELSE 0 END ) AS decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
    GROUP BY g.user_id, g.join_group_id, g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m12:30:32.974044 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:177ff99a-86c5-4a19-b997-0658a2328281&page=queryresults
[0m12:30:33.039410 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:45278fc2-807c-4366-8700-5e19f877eb06&page=queryresults
[0m12:30:36.250802 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca03cf0>]}
[0m12:30:36.251400 [info ] [Thread-3 (]: 3 of 5 OK created sql table model meetupservice.certified_events ............... [[32mCREATE TABLE (6.2k rows, 31.4 MiB processed)[0m in 4.08s]
[0m12:30:36.251842 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_events
[0m12:30:36.570875 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca20fd0>]}
[0m12:30:36.571424 [info ] [Thread-4 (]: 4 of 5 OK created sql table model meetupservice.certified_users_groups ......... [[32mCREATE TABLE (69.5k rows, 11.7 MiB processed)[0m in 4.40s]
[0m12:30:36.571945 [debug] [Thread-4 (]: Finished running node model.keira_project.certified_users_groups
[0m12:30:36.572535 [debug] [Thread-1 (]: Began running node model.keira_project.certified_group_topics
[0m12:30:36.572883 [info ] [Thread-1 (]: 5 of 5 START sql table model meetupservice.certified_group_topics .............. [RUN]
[0m12:30:36.573246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_rsvp, now model.keira_project.certified_group_topics)
[0m12:30:36.573515 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_group_topics
[0m12:30:36.576455 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m12:30:36.578183 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_group_topics
[0m12:30:36.580291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:36.890692 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_group_topics"
[0m12:30:36.892221 [debug] [Thread-1 (]: On model.keira_project.certified_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH topics AS(
    SELECT
        group_id,
        topic,
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics`
),

topicgroup AS(
    SELECT 
        t.topic,
        COUNT (DISTINCT t.group_id) AS topic_group_cnt,
        COUNT (u.user_id) AS topic_user_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics` t
    JOIN `keira-xebia`.`meetupservice`.`certified_users_groups` u
    ON t.group_id = u.join_group_id 
    GROUP BY t.topic
),

staging AS(
    SELECT
        t.group_id,
        t.topic,
        g.topic_group_cnt,
        g.topic_user_cnt
    FROM topics t
    JOIN topicgroup g
    ON t.topic = g.topic 
)


SELECT
    group_id,
    topic,
    topic_group_cnt, 
    topic_user_cnt
FROM staging
    );
  
[0m12:30:37.274799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2c203df1-a04a-4ba2-a53f-ca7df2c2b390&page=queryresults
[0m12:30:40.437660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab734402-dd0e-480b-bcce-8ad86746caa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca40b40>]}
[0m12:30:40.438228 [info ] [Thread-1 (]: 5 of 5 OK created sql table model meetupservice.certified_group_topics ......... [[32mCREATE TABLE (7.4k rows, 2.2 MiB processed)[0m in 3.86s]
[0m12:30:40.438722 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_group_topics
[0m12:30:40.439725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:40.439971 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m12:30:40.440179 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m12:30:40.440362 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m12:30:40.440528 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m12:30:40.440781 [info ] [MainThread]: 
[0m12:30:40.441007 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.21 seconds (19.21s).
[0m12:30:40.441956 [debug] [MainThread]: Command end result
[0m12:30:40.496668 [info ] [MainThread]: 
[0m12:30:40.497509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:40.498133 [info ] [MainThread]: 
[0m12:30:40.498602 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:30:40.502899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.487455, "process_user_time": 3.006801, "process_kernel_time": 1.625292, "process_mem_max_rss": "210206720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:40.503941 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:40.503641 after 22.49 seconds
[0m12:30:40.504468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b58b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cacfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cacf9b0>]}
[0m12:30:40.504974 [debug] [MainThread]: Flushing usage events
[0m12:30:47.750007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106436660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1283e7ed0>]}


============================== 12:30:47.758724 | 3e8d50f3-05c7-4b2c-a4a5-2f8eea4652be ==============================
[0m12:30:47.758724 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:30:47.759832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --models certified_events_users_rsvp', 'send_anonymous_usage_stats': 'True'}
[0m12:30:49.449223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e8d50f3-05c7-4b2c-a4a5-2f8eea4652be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138788fc0>]}
[0m12:30:49.545981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e8d50f3-05c7-4b2c-a4a5-2f8eea4652be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138459590>]}
[0m12:30:49.547344 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:30:49.731921 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:30:49.964275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:49.964847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:50.050860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e8d50f3-05c7-4b2c-a4a5-2f8eea4652be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138571850>]}
[0m12:30:50.285249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e8d50f3-05c7-4b2c-a4a5-2f8eea4652be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138ca6e40>]}
[0m12:30:50.286293 [info ] [MainThread]: Found 16 models, 7 data tests, 4 sources, 484 macros
[0m12:30:50.287050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8d50f3-05c7-4b2c-a4a5-2f8eea4652be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138b1e190>]}
[0m12:30:50.290363 [info ] [MainThread]: 
[0m12:30:50.291410 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:30:50.300898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia_meetupservice'
[0m12:30:50.301528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:50.578437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8d50f3-05c7-4b2c-a4a5-2f8eea4652be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138dd3520>]}
[0m12:30:50.579619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:50.580075 [info ] [MainThread]: 
[0m12:30:50.584507 [debug] [Thread-2 (]: Began running node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:30:50.585211 [debug] [Thread-1 (]: Began running node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:30:50.585777 [debug] [Thread-3 (]: Began running node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:30:50.586412 [info ] [Thread-2 (]: 2 of 3 START test not_null_certified_events_users_rsvp_event_id ................ [RUN]
[0m12:30:50.586948 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist  [RUN]
[0m12:30:50.587586 [info ] [Thread-3 (]: 3 of 3 START test relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_  [RUN]
[0m12:30:50.588429 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5'
[0m12:30:50.589082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f)
[0m12:30:50.590373 [debug] [Thread-2 (]: Began compiling node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:30:50.590753 [debug] [Thread-1 (]: Began compiling node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:30:50.589850 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016'
[0m12:30:50.620873 [debug] [Thread-3 (]: Began compiling node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:30:50.656058 [debug] [Thread-1 (]: Writing injected SQL for node "test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f"
[0m12:30:50.660762 [debug] [Thread-2 (]: Writing injected SQL for node "test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5"
[0m12:30:50.659048 [debug] [Thread-3 (]: Writing injected SQL for node "test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016"
[0m12:30:50.661997 [debug] [Thread-2 (]: Began executing node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:30:50.662744 [debug] [Thread-3 (]: Began executing node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:30:50.674018 [debug] [Thread-1 (]: Began executing node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:30:50.755049 [debug] [Thread-2 (]: Writing runtime sql for node "test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5"
[0m12:30:50.757908 [debug] [Thread-1 (]: Writing runtime sql for node "test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f"
[0m12:30:50.745976 [debug] [Thread-3 (]: Writing runtime sql for node "test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016"
[0m12:30:50.760389 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:30:50.761062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:50.761612 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:30:50.764141 [debug] [Thread-2 (]: On test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select event_id
from `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
where event_id is null



      
    ) dbt_internal_test
[0m12:30:50.766560 [debug] [Thread-1 (]: On test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        final_response as value_field,
        count(*) as n_records

    from `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    group by final_response

)

select *
from all_values
where value_field not in (
    'yes','no','waitlist'
)



      
    ) dbt_internal_test
[0m12:30:50.768774 [debug] [Thread-3 (]: On test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select rsvp_user_id as from_field
    from `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    where rsvp_user_id is not null
),

parent as (
    select user_id as to_field
    from `keira-xebia`.`meetupservice`.`certified_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:30:51.713797 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:7e277562-1fd6-48e6-93e8-8954f52349df&page=queryresults
[0m12:30:51.733659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1e354f27-46c1-4f8c-b3d0-1d2769d4c22c&page=queryresults
[0m12:30:51.963459 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:434bcc6f-1478-4aa1-8938-8c2ae166d636&page=queryresults
[0m12:30:52.049760 [info ] [Thread-2 (]: 2 of 3 PASS not_null_certified_events_users_rsvp_event_id ...................... [[32mPASS[0m in 1.46s]
[0m12:30:52.050433 [debug] [Thread-2 (]: Finished running node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:30:52.091520 [info ] [Thread-1 (]: 1 of 3 PASS accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist  [[32mPASS[0m in 1.50s]
[0m12:30:52.092120 [debug] [Thread-1 (]: Finished running node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:30:52.314005 [info ] [Thread-3 (]: 3 of 3 PASS relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_  [[32mPASS[0m in 1.72s]
[0m12:30:52.314718 [debug] [Thread-3 (]: Finished running node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:30:52.315946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:52.316180 [debug] [MainThread]: Connection 'test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f' was properly closed.
[0m12:30:52.316360 [debug] [MainThread]: Connection 'test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5' was properly closed.
[0m12:30:52.316530 [debug] [MainThread]: Connection 'test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016' was properly closed.
[0m12:30:52.316751 [info ] [MainThread]: 
[0m12:30:52.316965 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m12:30:52.317702 [debug] [MainThread]: Command end result
[0m12:30:52.377002 [info ] [MainThread]: 
[0m12:30:52.377963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:52.378327 [info ] [MainThread]: 
[0m12:30:52.378913 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:30:52.382600 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.735641, "process_user_time": 2.621673, "process_kernel_time": 1.365104, "process_mem_max_rss": "208076800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:52.383813 [debug] [MainThread]: Command `dbt test` succeeded at 12:30:52.383616 after 4.74 seconds
[0m12:30:52.384518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138e0f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138e0f960>]}
[0m12:30:52.384978 [debug] [MainThread]: Flushing usage events
[0m12:33:15.964145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107536660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215abc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215abed0>]}


============================== 12:33:15.972730 | c440cffb-7799-4168-abb1-b100c0b17835 ==============================
[0m12:33:15.972730 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:33:15.973734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:17.925641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c440cffb-7799-4168-abb1-b100c0b17835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1308850f0>]}
[0m12:33:17.991260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c440cffb-7799-4168-abb1-b100c0b17835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e59590>]}
[0m12:33:17.992583 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:33:18.188920 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:33:18.428372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:18.429102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:18.519433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c440cffb-7799-4168-abb1-b100c0b17835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f71850>]}
[0m12:33:18.563027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c440cffb-7799-4168-abb1-b100c0b17835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c3a5d0>]}
[0m12:33:18.564226 [info ] [MainThread]: Found 16 models, 7 data tests, 4 sources, 484 macros
[0m12:33:18.564843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c440cffb-7799-4168-abb1-b100c0b17835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b0b5b0>]}
[0m12:33:18.570118 [info ] [MainThread]: 
[0m12:33:18.571313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:18.581284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia_meetupservice'
[0m12:33:18.582143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:18.863116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c440cffb-7799-4168-abb1-b100c0b17835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c997e0>]}
[0m12:33:18.864149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:18.864652 [info ] [MainThread]: 
[0m12:33:18.869620 [debug] [Thread-3 (]: Began running node model.keira_project.stg_group_topics
[0m12:33:18.870723 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.stg_group_topics'
[0m12:33:18.871113 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m12:33:18.871679 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_o
[0m12:33:18.872264 [debug] [Thread-4 (]: Began running node model.keira_project.stg_groups
[0m12:33:18.872945 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_group_topics
[0m12:33:18.873617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m12:33:18.874363 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.stg_events_o'
[0m12:33:18.875072 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.stg_groups'
[0m12:33:18.882049 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m12:33:18.886142 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_o
[0m12:33:18.886910 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_groups
[0m12:33:18.898701 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m12:33:18.895162 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_group_topics"
[0m12:33:18.904183 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m12:33:18.909673 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m12:33:18.911582 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_o
[0m12:33:18.912858 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_o
[0m12:33:18.913404 [debug] [Thread-2 (]: Began running node model.keira_project.stg_users
[0m12:33:18.913948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_o, now model.keira_project.stg_users)
[0m12:33:18.914407 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_users
[0m12:33:18.915003 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m12:33:18.919936 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m12:33:18.921617 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m12:33:18.922110 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_group_topics
[0m12:33:18.922713 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_groups
[0m12:33:18.923507 [debug] [Thread-1 (]: Began running node model.keira_project.stg_users_groups
[0m12:33:18.925138 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_group_topics
[0m12:33:18.926330 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_groups
[0m12:33:18.927137 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_users
[0m12:33:18.927615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_first_dbt_model, now model.keira_project.stg_users_groups)
[0m12:33:18.928322 [debug] [Thread-3 (]: Began running node model.keira_project.stg_venues
[0m12:33:18.928790 [debug] [Thread-4 (]: Began running node model.keira_project.stg_events
[0m12:33:18.929675 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_users
[0m12:33:18.930275 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_users_groups
[0m12:33:18.930666 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_group_topics, now model.keira_project.stg_venues)
[0m12:33:18.931100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_groups, now model.keira_project.stg_events)
[0m12:33:18.931627 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_rsvp
[0m12:33:18.938654 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m12:33:18.939363 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_venues
[0m12:33:18.939955 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_events
[0m12:33:18.940473 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users, now model.keira_project.stg_events_rsvp)
[0m12:33:18.944918 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_venues"
[0m12:33:18.949413 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m12:33:18.949929 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m12:33:18.950534 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_users_groups
[0m12:33:18.955558 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m12:33:18.956829 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_users_groups
[0m12:33:18.958702 [debug] [Thread-1 (]: Began running node model.keira_project.my_second_dbt_model
[0m12:33:18.959313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users_groups, now model.keira_project.my_second_dbt_model)
[0m12:33:18.959864 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m12:33:18.963249 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m12:33:18.963749 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_events
[0m12:33:18.964701 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_events
[0m12:33:18.965372 [debug] [Thread-4 (]: Began running node test.keira_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:33:18.965786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events, now test.keira_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m12:33:18.966356 [debug] [Thread-4 (]: Began compiling node test.keira_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:33:18.972145 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_venues
[0m12:33:18.973110 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_venues
[0m12:33:18.973653 [debug] [Thread-3 (]: Began running node test.keira_project.unique_my_first_dbt_model_id.16e066b321
[0m12:33:18.974165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_venues, now test.keira_project.unique_my_first_dbt_model_id.16e066b321)
[0m12:33:18.974882 [debug] [Thread-3 (]: Began compiling node test.keira_project.unique_my_first_dbt_model_id.16e066b321
[0m12:33:18.987814 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_rsvp
[0m12:33:18.989074 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_rsvp
[0m12:33:18.995531 [debug] [Thread-2 (]: Began running node model.keira_project.certified_groups
[0m12:33:18.997603 [debug] [Thread-3 (]: Writing injected SQL for node "test.keira_project.unique_my_first_dbt_model_id.16e066b321"
[0m12:33:19.008642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_rsvp, now model.keira_project.certified_groups)
[0m12:33:19.009717 [debug] [Thread-1 (]: Began executing node model.keira_project.my_second_dbt_model
[0m12:33:19.010540 [debug] [Thread-4 (]: Writing injected SQL for node "test.keira_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:33:19.011084 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_groups
[0m12:33:19.012202 [debug] [Thread-1 (]: Finished running node model.keira_project.my_second_dbt_model
[0m12:33:19.017750 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_groups"
[0m12:33:19.018997 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users
[0m12:33:19.019576 [debug] [Thread-3 (]: Began executing node test.keira_project.unique_my_first_dbt_model_id.16e066b321
[0m12:33:19.020279 [debug] [Thread-4 (]: Began executing node test.keira_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:33:19.021685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_second_dbt_model, now model.keira_project.certified_users)
[0m12:33:19.023010 [debug] [Thread-3 (]: Finished running node test.keira_project.unique_my_first_dbt_model_id.16e066b321
[0m12:33:19.024211 [debug] [Thread-4 (]: Finished running node test.keira_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:33:19.024926 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_groups
[0m12:33:19.025382 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users
[0m12:33:19.026076 [debug] [Thread-3 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:33:19.026604 [debug] [Thread-4 (]: Began running node test.keira_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:33:19.027843 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_groups
[0m12:33:19.032325 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users"
[0m12:33:19.033057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.keira_project.unique_my_first_dbt_model_id.16e066b321, now model.keira_project.certified_events_users_rsvp)
[0m12:33:19.035216 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.keira_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.keira_project.not_null_my_second_dbt_model_id.151b76d778)
[0m12:33:19.036168 [debug] [Thread-2 (]: Began running node test.keira_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:33:19.037020 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:33:19.037665 [debug] [Thread-4 (]: Began compiling node test.keira_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:33:19.038267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_groups, now test.keira_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m12:33:19.044276 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:33:19.044709 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users
[0m12:33:19.051689 [debug] [Thread-4 (]: Writing injected SQL for node "test.keira_project.not_null_my_second_dbt_model_id.151b76d778"
[0m12:33:19.052502 [debug] [Thread-2 (]: Began compiling node test.keira_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:33:19.053804 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users
[0m12:33:19.061708 [debug] [Thread-2 (]: Writing injected SQL for node "test.keira_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:33:19.062356 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:33:19.062972 [debug] [Thread-4 (]: Began executing node test.keira_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:33:19.064162 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:33:19.065389 [debug] [Thread-4 (]: Finished running node test.keira_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:33:19.066656 [debug] [Thread-4 (]: Began running node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:33:19.068151 [debug] [Thread-1 (]: Began running node model.keira_project.certified_events
[0m12:33:19.068901 [debug] [Thread-3 (]: Began running node model.keira_project.certified_users_groups
[0m12:33:19.070187 [debug] [Thread-2 (]: Began executing node test.keira_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:33:19.070730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.keira_project.not_null_my_second_dbt_model_id.151b76d778, now test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f)
[0m12:33:19.071748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_users, now model.keira_project.certified_events)
[0m12:33:19.072335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_events_users_rsvp, now model.keira_project.certified_users_groups)
[0m12:33:19.072898 [debug] [Thread-2 (]: Finished running node test.keira_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:33:19.073116 [debug] [Thread-4 (]: Began compiling node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:33:19.073281 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_events
[0m12:33:19.073435 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_users_groups
[0m12:33:19.073640 [debug] [Thread-2 (]: Began running node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:33:19.100096 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:33:19.102031 [debug] [Thread-4 (]: Writing injected SQL for node "test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f"
[0m12:33:19.107286 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m12:33:19.108430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.keira_project.unique_my_second_dbt_model_id.57a0f8c493, now test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5)
[0m12:33:19.110006 [debug] [Thread-2 (]: Began compiling node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:33:19.110905 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_events
[0m12:33:19.118136 [debug] [Thread-4 (]: Began executing node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:33:19.118856 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_users_groups
[0m12:33:19.117746 [debug] [Thread-2 (]: Writing injected SQL for node "test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5"
[0m12:33:19.120531 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_events
[0m12:33:19.121717 [debug] [Thread-4 (]: Finished running node test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f
[0m12:33:19.124422 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_users_groups
[0m12:33:19.126050 [debug] [Thread-1 (]: Began running node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:33:19.128049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_events, now test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016)
[0m12:33:19.129168 [debug] [Thread-1 (]: Began compiling node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:33:19.130467 [debug] [Thread-4 (]: Began running node model.keira_project.certified_group_topics
[0m12:33:19.131171 [debug] [Thread-2 (]: Began executing node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:33:19.144884 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.keira_project.accepted_values_certified_events_users_rsvp_final_response__yes__no__waitlist.512d61715f, now model.keira_project.certified_group_topics)
[0m12:33:19.151008 [debug] [Thread-1 (]: Writing injected SQL for node "test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016"
[0m12:33:19.151962 [debug] [Thread-2 (]: Finished running node test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5
[0m12:33:19.152644 [debug] [Thread-4 (]: Began compiling node model.keira_project.certified_group_topics
[0m12:33:19.155571 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m12:33:19.156146 [debug] [Thread-1 (]: Began executing node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:33:19.156553 [debug] [Thread-1 (]: Finished running node test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016
[0m12:33:19.156900 [debug] [Thread-4 (]: Began executing node model.keira_project.certified_group_topics
[0m12:33:19.158272 [debug] [Thread-4 (]: Finished running node model.keira_project.certified_group_topics
[0m12:33:19.160294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:19.160681 [debug] [MainThread]: Connection 'test.keira_project.relationships_certified_events_users_rsvp_rsvp_user_id__user_id__ref_certified_users_.ec4965f016' was properly closed.
[0m12:33:19.161023 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m12:33:19.161307 [debug] [MainThread]: Connection 'test.keira_project.not_null_certified_events_users_rsvp_event_id.12519981b5' was properly closed.
[0m12:33:19.161716 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m12:33:19.168471 [debug] [MainThread]: Command end result
[0m12:33:19.375555 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:33:19.376294 [info ] [MainThread]: Building catalog
[0m12:33:19.391757 [debug] [ThreadPool]: Acquiring new bigquery connection 'keira-xebia.information_schema'
[0m12:33:19.429733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:19.433161 [debug] [ThreadPool]: On keira-xebia.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "connection_name": "keira-xebia.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `keira-xebia`.`meetupservice`.__TABLES__ tables
    left join `keira-xebia`.`meetupservice`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `keira-xebia`.`meetupservice`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('my_first_dbt_model')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_users_groups')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('source_venues')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_events_o')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_events')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('certified_groups')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('my_second_dbt_model')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('certified_group_topics')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_events_rsvp')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('certified_events_users_rsvp')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('certified_users')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_venues')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('source_events')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('certified_events')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_group_topics')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_groups')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('stg_users')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('source_users')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('source_groups')
                            ) or (
                                upper(table_schema) = upper('meetupservice')
                            and upper(table_name) = upper('certified_users_groups')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `keira-xebia`.`meetupservice`.INFORMATION_SCHEMA.COLUMNS columns
    join `keira-xebia`.`meetupservice`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:33:20.091582 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9fc7284f-e77b-4c76-a2ca-f7d5803b22d5&page=queryresults
[0m12:33:21.944846 [info ] [MainThread]: Catalog written to /Users/keirayang/Desktop/keira_project/target/catalog.json
[0m12:33:21.949029 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.0967026, "process_user_time": 2.676881, "process_kernel_time": 1.548962, "process_mem_max_rss": "208732160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:33:21.950003 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:33:21.949844 after 6.10 seconds
[0m12:33:21.950716 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:33:21.951071 [debug] [MainThread]: Connection 'keira-xebia.information_schema' was properly closed.
[0m12:33:21.951465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210777d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130bdf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130bdfcd0>]}
[0m12:33:21.952117 [debug] [MainThread]: Flushing usage events
[0m12:33:31.463514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105636660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e7ed0>]}


============================== 12:33:31.472486 | c76c20ff-6e2a-44c0-a854-d734658e2ae4 ==============================
[0m12:33:31.472486 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:33:31.473151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:33:33.147933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c76c20ff-6e2a-44c0-a854-d734658e2ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1171810f0>]}
[0m12:33:33.245021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c76c20ff-6e2a-44c0-a854-d734658e2ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166596a0>]}
[0m12:39:59.613833 [error] [MainThread]: Encountered an error:

[0m12:39:59.628008 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/keirayang/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/keirayang/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/keirayang/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/keirayang/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/keirayang/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/keirayang/myenv/lib/python3.13/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/keirayang/myenv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:39:59.634571 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 388.27173, "process_user_time": 1.947321, "process_kernel_time": 1.064425, "process_mem_max_rss": "199606272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:59.636298 [debug] [MainThread]: Command `dbt docs serve` failed at 12:39:59.635933 after 388.27 seconds
[0m12:39:59.638115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116773d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172b8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1172c9310>]}
[0m12:39:59.639209 [debug] [MainThread]: Flushing usage events
[0m12:54:47.003279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102736660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e7ed0>]}


============================== 12:54:47.011292 | 00174e9d-b4d7-4d46-af11-3e9b8a01a209 ==============================
[0m12:54:47.011292 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:54:47.012218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/keirayang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/keirayang/Desktop/keira_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:48.934858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133988fc0>]}
[0m12:54:49.026556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f59590>]}
[0m12:54:49.027634 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m12:54:49.209536 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:54:49.457488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:54:49.458870 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_venues.sql
[0m12:54:49.459662 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_groups.sql
[0m12:54:49.460435 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_users.sql
[0m12:54:49.461215 [debug] [MainThread]: Partial parsing: updated file: keira_project://models/Staging/stg_events.sql
[0m12:54:49.933134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133cb8750>]}
[0m12:54:50.132988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133d32f30>]}
[0m12:54:50.133903 [info ] [MainThread]: Found 16 models, 7 data tests, 4 sources, 484 macros
[0m12:54:50.134395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133e15d30>]}
[0m12:54:50.138501 [info ] [MainThread]: 
[0m12:54:50.139603 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:54:50.149604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_keira-xebia'
[0m12:54:50.150644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:50.540288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_keira-xebia, now list_keira-xebia_meetupservice)
[0m12:54:50.540651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:50.794427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133ea9f30>]}
[0m12:54:50.794934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:50.795207 [info ] [MainThread]: 
[0m12:54:50.797913 [debug] [Thread-2 (]: Began running node model.keira_project.stg_events_o
[0m12:54:50.798744 [debug] [Thread-1 (]: Began running node model.keira_project.my_first_dbt_model
[0m12:54:50.799002 [debug] [Thread-3 (]: Began running node model.keira_project.stg_group_topics
[0m12:54:50.799367 [info ] [Thread-2 (]: 2 of 16 START sql table model meetupservice.stg_events_o ....................... [RUN]
[0m12:54:50.799870 [debug] [Thread-4 (]: Began running node model.keira_project.stg_groups
[0m12:54:50.800182 [info ] [Thread-1 (]: 1 of 16 START sql table model meetupservice.my_first_dbt_model ................. [RUN]
[0m12:54:50.800537 [info ] [Thread-3 (]: 3 of 16 START sql table model meetupservice.stg_group_topics ................... [RUN]
[0m12:54:50.800947 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.keira_project.stg_events_o'
[0m12:54:50.801298 [info ] [Thread-4 (]: 4 of 16 START sql table model meetupservice.stg_groups ......................... [RUN]
[0m12:54:50.801686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_keira-xebia_meetupservice, now model.keira_project.my_first_dbt_model)
[0m12:54:50.802039 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.keira_project.stg_group_topics'
[0m12:54:50.802309 [debug] [Thread-2 (]: Began compiling node model.keira_project.stg_events_o
[0m12:54:50.802619 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.keira_project.stg_groups'
[0m12:54:50.802855 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_first_dbt_model
[0m12:54:50.803177 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_group_topics
[0m12:54:50.816354 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_groups
[0m12:54:50.818941 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.stg_events_o"
[0m12:54:50.823273 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_first_dbt_model"
[0m12:54:50.836129 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_groups"
[0m12:54:50.843814 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_group_topics"
[0m12:54:50.845581 [debug] [Thread-2 (]: Began executing node model.keira_project.stg_events_o
[0m12:54:50.858403 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_group_topics
[0m12:54:50.865045 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_groups
[0m12:54:50.872186 [debug] [Thread-1 (]: Began executing node model.keira_project.my_first_dbt_model
[0m12:54:50.903310 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:50.907029 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:50.908067 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:50.911504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:51.569096 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.stg_events_o"
[0m12:54:51.564440 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_group_topics"
[0m12:54:51.570032 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_first_dbt_model"
[0m12:54:51.574399 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_groups"
[0m12:54:51.575613 [debug] [Thread-1 (]: On model.keira_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_first_dbt_model"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m12:54:51.577532 [debug] [Thread-2 (]: On model.keira_project.stg_events_o: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_o"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_o`
      
    
    

    OPTIONS()
    as (
      


WITH rsvp AS (
    SELECT 
        venue_id,
        group_id,
        name AS event_name,
        TIMESTAMP_SECONDS(CAST(time / 1000 AS INT64)) AS event_start_time, --timestamp
        rsvp.user_id AS rsvp_user_id,
        rsvp.response AS rsvp_response,
        TIMESTAMP_SECONDS(CAST(rsvp.when / 1000 AS INT64)) AS rsvp_response_time, --timestamp
        rsvp.guests AS rsvp_guests,
        status AS event_status,
        duration AS event_duration,
        rsvp_limit AS rsvp_total_limit,
        TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64)) AS event_create_time, --timestamp
        description AS event_description
    FROM 
      `keira-xebia`.`meetupservice`.`source_events`,
      UNNEST(rsvps) AS rsvp
),

eventid AS(
    SELECT 
        CAST(FARM_FINGERPRINT(
            CONCAT(event_name, CAST(group_id AS STRING), CAST(venue_id AS STRING), CAST(event_start_time AS STRING))) 
            AS STRING) AS event_id,
        *
    FROM rsvp
)

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    event_status,
    event_duration,
    rsvp_total_limit,
    event_create_time,
    event_description,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM eventid
    );
  
[0m12:54:51.578357 [debug] [Thread-4 (]: On model.keira_project.stg_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_groups`
      
    
    

    OPTIONS()
    as (
      


WITH stggroups AS(
    SELECT
      group_id, 
      name AS group_name,
      EXTRACT(YEAR FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_year, 
      EXTRACT(MONTH FROM TIMESTAMP_SECONDS(CAST(created / 1000 AS INT64))) AS group_created_month,
      description AS group_description,
      LOWER(city) AS group_city,
      lat AS group_lat,
      lon AS group_lon   
    FROM `keira-xebia`.`meetupservice`.`source_groups`
)

SELECT 
  group_id, --unique identifier of a group
  group_name,
  group_created_year,
  group_created_month,
  group_description,
  group_city,
  group_lat,
  group_lon
FROM stggroups
    );
  
[0m12:54:51.580646 [debug] [Thread-3 (]: On model.keira_project.stg_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH group_topics AS (
    SELECT
        group_id,
        topic
    FROM `keira-xebia`.`meetupservice`.`source_groups`,
    UNNEST(topics) AS topic
)

SELECT
    group_id,
    topic
FROM group_topics
    );
  
[0m12:54:52.080376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:e24fe6a9-1459-42df-b893-6ba979683d19&page=queryresults
[0m12:54:52.080917 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:5ee5f5c8-78d3-4b54-9d20-44a446cc446f&page=queryresults
[0m12:54:52.081520 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:a9f7670f-3db1-4377-b6b0-e94932c602b8&page=queryresults
[0m12:54:52.082567 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:9204185e-9023-44b2-add1-90f09153a04b&page=queryresults
[0m12:54:54.104472 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133e57dd0>]}
[0m12:54:54.105998 [info ] [Thread-3 (]: 3 of 16 OK created sql table model meetupservice.stg_group_topics .............. [[32mCREATE TABLE (7.7k rows, 147.1 KiB processed)[0m in 3.30s]
[0m12:54:54.107314 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_group_topics
[0m12:54:54.107961 [debug] [Thread-3 (]: Began running node model.keira_project.stg_users
[0m12:54:54.108615 [info ] [Thread-3 (]: 5 of 16 START sql table model meetupservice.stg_users .......................... [RUN]
[0m12:54:54.109363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_group_topics, now model.keira_project.stg_users)
[0m12:54:54.109886 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_users
[0m12:54:54.115193 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_users"
[0m12:54:54.116880 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_users
[0m12:54:54.120274 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:54.406450 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_users"
[0m12:54:54.407893 [debug] [Thread-3 (]: On model.keira_project.stg_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users`
      
    
    

    OPTIONS()
    as (
      

WITH users AS (
    SELECT
        user_id,
        LOWER(country) AS user_country,
        LOWER(city) AS user_city,
        LOWER(hometown) AS user_hometown
    FROM `keira-xebia`.`meetupservice`.`source_users`   
)

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM users
    );
  
[0m12:54:54.424451 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132319d30>]}
[0m12:54:54.425712 [info ] [Thread-4 (]: 4 of 16 OK created sql table model meetupservice.stg_groups .................... [[32mCREATE TABLE (711.0 rows, 442.7 KiB processed)[0m in 3.62s]
[0m12:54:54.427092 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_groups
[0m12:54:54.428502 [debug] [Thread-4 (]: Began running node model.keira_project.stg_users_groups
[0m12:54:54.429341 [info ] [Thread-4 (]: 6 of 16 START sql table model meetupservice.stg_users_groups ................... [RUN]
[0m12:54:54.430235 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_groups, now model.keira_project.stg_users_groups)
[0m12:54:54.430955 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_users_groups
[0m12:54:54.433419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fdceb0>]}
[0m12:54:54.438250 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_users_groups"
[0m12:54:54.439057 [info ] [Thread-1 (]: 1 of 16 OK created sql table model meetupservice.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.63s]
[0m12:54:54.440124 [debug] [Thread-1 (]: Finished running node model.keira_project.my_first_dbt_model
[0m12:54:54.440745 [debug] [Thread-1 (]: Began running node model.keira_project.stg_venues
[0m12:54:54.441638 [info ] [Thread-1 (]: 7 of 16 START sql table model meetupservice.stg_venues ......................... [RUN]
[0m12:54:54.442514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_first_dbt_model, now model.keira_project.stg_venues)
[0m12:54:54.443095 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_users_groups
[0m12:54:54.443433 [debug] [Thread-1 (]: Began compiling node model.keira_project.stg_venues
[0m12:54:54.446580 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:54.451724 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.stg_venues"
[0m12:54:54.546184 [debug] [Thread-1 (]: Began executing node model.keira_project.stg_venues
[0m12:54:54.549985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:54.787163 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_users_groups"
[0m12:54:54.788900 [debug] [Thread-4 (]: On model.keira_project.stg_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS (
    SELECT
        user_id,
        membership.group_id AS join_group_id,
        TIMESTAMP_SECONDS(CAST(membership.joined / 1000 AS INT64)) AS join_group_time --timestamp
    FROM `keira-xebia`.`meetupservice`.`source_users`,
    UNNEST(memberships) AS membership
)

SELECT 
    user_id, 
    join_group_id,
    join_group_time
FROM usergroup
    );
  
[0m12:54:54.813605 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.stg_venues"
[0m12:54:54.815165 [debug] [Thread-1 (]: On model.keira_project.stg_venues: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_venues"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_venues`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    venue_id,
    name AS venue_name,
    LOWER(city) AS venue_city,
    LOWER(country) AS venue_country,
    lat AS venue_lat,
    lon AS venue_lon
FROM `keira-xebia`.`meetupservice`.`source_venues`
    );
  
[0m12:54:54.922421 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:24bf5756-9ad2-4973-b79b-554dd07fa1db&page=queryresults
[0m12:54:55.354825 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:c021364a-f3f6-42d4-8a9b-02b2c0ebab8f&page=queryresults
[0m12:54:55.355347 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:be1c15e2-fdd4-4726-bd5d-a50b2280538f&page=queryresults
[0m12:54:57.607989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13402ccd0>]}
[0m12:54:57.608568 [info ] [Thread-2 (]: 2 of 16 OK created sql table model meetupservice.stg_events_o .................. [[32mCREATE TABLE (174.1k rows, 12.1 MiB processed)[0m in 6.81s]
[0m12:54:57.609012 [debug] [Thread-2 (]: Finished running node model.keira_project.stg_events_o
[0m12:54:57.609322 [debug] [Thread-2 (]: Began running node model.keira_project.certified_groups
[0m12:54:57.609628 [info ] [Thread-2 (]: 8 of 16 START sql table model meetupservice.certified_groups ................... [RUN]
[0m12:54:57.610009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_o, now model.keira_project.certified_groups)
[0m12:54:57.610362 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_groups
[0m12:54:57.612859 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_groups"
[0m12:54:57.615041 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_groups
[0m12:54:57.616809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.709957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133ff71c0>]}
[0m12:54:57.711502 [info ] [Thread-1 (]: 7 of 16 OK created sql table model meetupservice.stg_venues .................... [[32mCREATE TABLE (1.7k rows, 97.0 KiB processed)[0m in 3.27s]
[0m12:54:57.714446 [debug] [Thread-1 (]: Finished running node model.keira_project.stg_venues
[0m12:54:57.715223 [debug] [Thread-1 (]: Began running node model.keira_project.my_second_dbt_model
[0m12:54:57.716438 [info ] [Thread-1 (]: 9 of 16 START sql view model meetupservice.my_second_dbt_model ................. [RUN]
[0m12:54:57.717738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_venues, now model.keira_project.my_second_dbt_model)
[0m12:54:57.718615 [debug] [Thread-1 (]: Began compiling node model.keira_project.my_second_dbt_model
[0m12:54:57.725263 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.my_second_dbt_model"
[0m12:54:57.727461 [debug] [Thread-1 (]: Began executing node model.keira_project.my_second_dbt_model
[0m12:54:57.769599 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.my_second_dbt_model"
[0m12:54:57.771388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.773974 [debug] [Thread-1 (]: On model.keira_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.my_second_dbt_model"} */


  create or replace view `keira-xebia`.`meetupservice`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `keira-xebia`.`meetupservice`.`my_first_dbt_model`
where id = 1;


[0m12:54:57.874771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc4e30>]}
[0m12:54:57.876048 [info ] [Thread-3 (]: 5 of 16 OK created sql table model meetupservice.stg_users ..................... [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.77s]
[0m12:54:57.878597 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_users
[0m12:54:57.879528 [debug] [Thread-3 (]: Began running node model.keira_project.stg_events
[0m12:54:57.880603 [info ] [Thread-3 (]: 10 of 16 START sql table model meetupservice.stg_events ........................ [RUN]
[0m12:54:57.881495 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users, now model.keira_project.stg_events)
[0m12:54:57.882302 [debug] [Thread-3 (]: Began compiling node model.keira_project.stg_events
[0m12:54:57.888757 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.stg_events"
[0m12:54:57.890553 [debug] [Thread-3 (]: Began executing node model.keira_project.stg_events
[0m12:54:57.894384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:58.090344 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_groups"
[0m12:54:58.091874 [debug] [Thread-2 (]: On model.keira_project.certified_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_groups`
      
    
    

    OPTIONS()
    as (
      


SELECT 
    group_id, --unique identifier of a group
    group_name,
    group_created_year,
    group_created_month,
    group_description,
    group_city,
    group_lat,
    group_lon
FROM `keira-xebia`.`meetupservice`.`stg_groups`
    );
  
[0m12:54:58.101519 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc5a30>]}
[0m12:54:58.102453 [info ] [Thread-4 (]: 6 of 16 OK created sql table model meetupservice.stg_users_groups .............. [[32mCREATE TABLE (145.5k rows, 4.5 MiB processed)[0m in 3.67s]
[0m12:54:58.103711 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_users_groups
[0m12:54:58.104371 [debug] [Thread-4 (]: Began running node model.keira_project.stg_events_rsvp
[0m12:54:58.105019 [info ] [Thread-4 (]: 11 of 16 START sql table model meetupservice.stg_events_rsvp ................... [RUN]
[0m12:54:58.105712 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_users_groups, now model.keira_project.stg_events_rsvp)
[0m12:54:58.106180 [debug] [Thread-4 (]: Began compiling node model.keira_project.stg_events_rsvp
[0m12:54:58.111137 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.stg_events_rsvp"
[0m12:54:58.112089 [debug] [Thread-4 (]: Began executing node model.keira_project.stg_events_rsvp
[0m12:54:58.115586 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:58.211624 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.stg_events"
[0m12:54:58.214108 [debug] [Thread-3 (]: On model.keira_project.stg_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events`
      
    
    

    OPTIONS()
    as (
      


WITH events AS (
    SELECT DISTINCT
        event_id,
        venue_id,
        event_start_time, --timestamp
        event_status,
        event_duration,
        rsvp_total_limit,
        event_create_time, --timestamp
        group_id,
        event_name,
        event_description
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_o`
    WHERE event_id IS NOT NULL 
),

venues AS(
    SELECT 
        venue_id,
        name AS venue_name,
        LOWER(city) AS venue_city,
        LOWER(country) AS venue_country,
        lat AS venue_lat,
        lon AS venue_lon
    FROM `keira-xebia`.`meetupservice`.`source_venues`
),

staging AS(
    SELECT
        e.event_id,
        e.group_id,
        e.venue_id,
        e.event_name,
        e.event_start_time,
        e.event_status,
        e.event_duration,
        e.event_create_time,
        e.rsvp_total_limit,
        e.event_description,
        v.venue_name,
        v.venue_city,
        v.venue_country,
        v.venue_lat,
        v.venue_lon
      FROM events e
      LEFT JOIN venues v
        ON e.venue_id = v.venue_id
)


SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_start_time,
    event_status,
    event_duration,
    event_create_time,
    rsvp_total_limit,
    event_description,
    venue_name,
    venue_city,
    venue_country,
    venue_lat,
    venue_lon
FROM staging
    );
  
[0m12:54:58.408562 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.stg_events_rsvp"
[0m12:54:58.410054 [debug] [Thread-4 (]: On model.keira_project.stg_events_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.stg_events_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`stg_events_rsvp`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    event_id,
    event_name,
    event_start_time,
    group_id,
    venue_id,
    rsvp_user_id,
    rsvp_response,
    rsvp_response_time,
    rsvp_guests
FROM `keira-xebia`.`meetupservice`.`stg_events_o`
WHERE event_id IS NOT NULL
    );
  
[0m12:54:58.460252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:eae8c0c1-ad26-4ac6-90e5-f6a522954cc9&page=queryresults
[0m12:54:58.492804 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:fb968f60-b4a0-4c10-8a36-09639f98f004&page=queryresults
[0m12:54:58.631979 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:ed012043-7e87-48cc-8a28-b1422405ae4e&page=queryresults
[0m12:54:58.702524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc7650>]}
[0m12:54:58.703099 [info ] [Thread-1 (]: 9 of 16 OK created sql view model meetupservice.my_second_dbt_model ............ [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m12:54:58.703589 [debug] [Thread-1 (]: Finished running node model.keira_project.my_second_dbt_model
[0m12:54:58.703898 [debug] [Thread-1 (]: Began running node model.keira_project.certified_users
[0m12:54:58.704249 [info ] [Thread-1 (]: 12 of 16 START sql table model meetupservice.certified_users ................... [RUN]
[0m12:54:58.704545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.my_second_dbt_model, now model.keira_project.certified_users)
[0m12:54:58.704788 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_users
[0m12:54:58.707231 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_users"
[0m12:54:58.708799 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_users
[0m12:54:58.710496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:58.828468 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:34422cfd-3ee0-4234-bb3d-96adbaf28241&page=queryresults
[0m12:54:58.966950 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_users"
[0m12:54:58.968190 [debug] [Thread-1 (]: On model.keira_project.certified_users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users`
      
    
    

    OPTIONS()
    as (
      

SELECT 
    user_id, 
    user_country,
    user_city,
    user_hometown
FROM `keira-xebia`.`meetupservice`.`stg_users`
    );
  
[0m12:54:59.448822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:2a80c93e-a46c-40da-81b4-b6934d660e23&page=queryresults
[0m12:55:01.051213 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc6ff0>]}
[0m12:55:01.051744 [info ] [Thread-2 (]: 8 of 16 OK created sql table model meetupservice.certified_groups .............. [[32mCREATE TABLE (711.0 rows, 448.3 KiB processed)[0m in 3.44s]
[0m12:55:01.052200 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_groups
[0m12:55:01.600633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc7e90>]}
[0m12:55:01.601184 [info ] [Thread-3 (]: 10 of 16 OK created sql table model meetupservice.stg_events ................... [[32mCREATE TABLE (6.2k rows, 264.4 MiB processed)[0m in 3.72s]
[0m12:55:01.601711 [debug] [Thread-3 (]: Finished running node model.keira_project.stg_events
[0m12:55:01.945704 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc6750>]}
[0m12:55:01.946243 [info ] [Thread-4 (]: 11 of 16 OK created sql table model meetupservice.stg_events_rsvp .............. [[32mCREATE TABLE (174.0k rows, 20.4 MiB processed)[0m in 3.84s]
[0m12:55:01.946706 [debug] [Thread-4 (]: Finished running node model.keira_project.stg_events_rsvp
[0m12:55:01.947114 [debug] [Thread-2 (]: Began running node model.keira_project.certified_events_users_rsvp
[0m12:55:01.947426 [info ] [Thread-2 (]: 13 of 16 START sql table model meetupservice.certified_events_users_rsvp ....... [RUN]
[0m12:55:01.947713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_groups, now model.keira_project.certified_events_users_rsvp)
[0m12:55:01.947954 [debug] [Thread-2 (]: Began compiling node model.keira_project.certified_events_users_rsvp
[0m12:55:01.950976 [debug] [Thread-2 (]: Writing injected SQL for node "model.keira_project.certified_events_users_rsvp"
[0m12:55:01.951620 [debug] [Thread-2 (]: Began executing node model.keira_project.certified_events_users_rsvp
[0m12:55:01.953216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:55:02.043277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1340d5df0>]}
[0m12:55:02.044953 [info ] [Thread-1 (]: 12 of 16 OK created sql table model meetupservice.certified_users .............. [[32mCREATE TABLE (57.8k rows, 1.3 MiB processed)[0m in 3.34s]
[0m12:55:02.046357 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_users
[0m12:55:02.255397 [debug] [Thread-2 (]: Writing runtime sql for node "model.keira_project.certified_events_users_rsvp"
[0m12:55:02.256304 [debug] [Thread-2 (]: On model.keira_project.certified_events_users_rsvp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events_users_rsvp"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
      
    
    

    OPTIONS()
    as (
      

WITH rsvp AS (
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date, --YYYY-MM-DD
        rsvp_user_id,
        rsvp_response,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', rsvp_response_time)) AS rsvp_response_date, --YYYY-MM-DD
        rsvp_guests,
        DATE(MIN(rsvp_response_time) OVER (
            PARTITION BY event_id, rsvp_user_id))
            AS first_response_date,
        ROW_NUMBER () OVER (
            PARTITION BY event_id, rsvp_user_id
            ORDER BY rsvp_response_time DESC ) AS row_n
    FROM 
      `keira-xebia`.`meetupservice`.`stg_events_rsvp`
),

final AS(
    SELECT 
        event_id,
        venue_id,
        group_id,
        event_name,
        event_date,
        rsvp_user_id,
        rsvp_response AS final_response,
        rsvp_response_date AS final_response_date,
        rsvp_guests AS final_response_guests,
        first_response_date,
        -- time duration from the last response to event day.
        DATE_DIFF(event_date, first_response_date, DAY) AS first_response_to_start,
        DATE_DIFF(event_date, rsvp_response_date, DAY) AS final_response_to_start, 
        CASE WHEN rsvp_response_date != first_response_date THEN 1 ELSE 0 END AS response_changed
    FROM rsvp
    WHERE row_n = 1
),

staging AS(
    SELECT 
        f.event_id,
        f.event_name,
        f.event_date,
        f.group_id,
        f.venue_id,
        f.rsvp_user_id,
        f.first_response_date,
        f.final_response_date,
        f.final_response,
        f.final_response_guests,
        f.first_response_to_start,
        f.final_response_to_start,
        f.response_changed,
        u.user_country,
        u.user_city,
        v.venue_country,
        v.venue_city,
        CASE WHEN u.user_country = v.venue_country AND v.venue_city = u.user_city
        THEN 'yes' ELSE 'no' END AS user_venue_same_location
    FROM final f
    JOIN `keira-xebia`.`meetupservice`.`stg_users` u 
    ON f.rsvp_user_id = u.user_id
    JOIN  `keira-xebia`.`meetupservice`.`stg_venues` v
    ON f.venue_id = v.venue_id
)


SELECT 
    event_id,
    event_name,
    event_date,
    group_id,
    venue_id,
    rsvp_user_id,
    first_response_date,
    final_response_date,
    final_response,
    final_response_guests,
    first_response_to_start,
    final_response_to_start,
    response_changed,
    user_country,
    user_city,
    venue_country,
    venue_city,
    user_venue_same_location
FROM staging
    );
  
[0m12:55:02.932912 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:f41f0169-a6a5-4af3-9239-ad8eaae2069e&page=queryresults
[0m12:55:06.973424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc6d50>]}
[0m12:55:06.973952 [info ] [Thread-2 (]: 13 of 16 OK created sql table model meetupservice.certified_events_users_rsvp .. [[32mCREATE TABLE (173.9k rows, 21.7 MiB processed)[0m in 5.03s]
[0m12:55:06.974393 [debug] [Thread-2 (]: Finished running node model.keira_project.certified_events_users_rsvp
[0m12:55:06.974991 [debug] [Thread-4 (]: Began running node model.keira_project.certified_users_groups
[0m12:55:06.975264 [debug] [Thread-3 (]: Began running node model.keira_project.certified_events
[0m12:55:06.975657 [info ] [Thread-4 (]: 15 of 16 START sql table model meetupservice.certified_users_groups ............ [RUN]
[0m12:55:06.976080 [info ] [Thread-3 (]: 14 of 16 START sql table model meetupservice.certified_events .................. [RUN]
[0m12:55:06.976445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events_rsvp, now model.keira_project.certified_users_groups)
[0m12:55:06.976726 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.keira_project.stg_events, now model.keira_project.certified_events)
[0m12:55:06.976989 [debug] [Thread-4 (]: Began compiling node model.keira_project.certified_users_groups
[0m12:55:06.977225 [debug] [Thread-3 (]: Began compiling node model.keira_project.certified_events
[0m12:55:06.979939 [debug] [Thread-4 (]: Writing injected SQL for node "model.keira_project.certified_users_groups"
[0m12:55:06.982712 [debug] [Thread-3 (]: Writing injected SQL for node "model.keira_project.certified_events"
[0m12:55:06.984352 [debug] [Thread-3 (]: Began executing node model.keira_project.certified_events
[0m12:55:06.984612 [debug] [Thread-4 (]: Began executing node model.keira_project.certified_users_groups
[0m12:55:06.986798 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:55:06.988440 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:55:07.359290 [debug] [Thread-4 (]: Writing runtime sql for node "model.keira_project.certified_users_groups"
[0m12:55:07.360095 [debug] [Thread-4 (]: On model.keira_project.certified_users_groups: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_users_groups"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_users_groups`
      
    
    

    OPTIONS()
    as (
      

WITH usergroup AS(
    SELECT 
        user_id, 
        join_group_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', join_group_time)) AS join_group_date
    FROM `keira-xebia`.`meetupservice`.`stg_users_groups`
),

userevent AS(
    SELECT 
        g.user_id,
        g.join_group_id,
        g.join_group_date,
        SUM( CASE WHEN e.final_response = 'yes' THEN 1 ELSE 0 END ) AS accept_event_cnt,
        SUM( CASE WHEN e.final_response != 'yes' THEN 1 ELSE 0 END ) AS decline_event_cnt
    FROM usergroup g
    LEFT JOIN `keira-xebia`.`meetupservice`.`certified_events_users_rsvp` e
    ON g.user_id = e.rsvp_user_id
    AND g.join_group_id = e.group_id
    WHERE e.event_date >= g.join_group_date
    GROUP BY g.user_id, g.join_group_id, g.join_group_date
),

staging AS (
    SELECT 
        user_id,
        join_group_id,
        join_group_date,
        accept_event_cnt,
        decline_event_cnt,
        accept_event_cnt + decline_event_cnt AS total_event_cnt,
        accept_event_cnt * 1.00 / (accept_event_cnt + decline_event_cnt) AS group_event_accept_rate
    FROM userevent
)

SELECT 
    user_id,
    join_group_id,
    join_group_date,
    accept_event_cnt,
    decline_event_cnt,
    total_event_cnt,
    group_event_accept_rate
FROM staging
    );
  
[0m12:55:07.366742 [debug] [Thread-3 (]: Writing runtime sql for node "model.keira_project.certified_events"
[0m12:55:07.367581 [debug] [Thread-3 (]: On model.keira_project.certified_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_events"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_events`
      
    
    

    OPTIONS()
    as (
      


WITH userrsvp AS (
    SELECT 
        event_id,
        event_name,
        event_date,
        group_id,
        venue_id,
        COUNT(rsvp_user_id) AS total_user,
        SUM(final_response_guests) AS total_guests,
        SUM(CASE WHEN final_response = 'yes' THEN 1 ELSE 0 END) AS accept_user_cnt,
        SUM(CASE WHEN final_response != 'yes' THEN 1 ELSE 0 END) AS decline_user_cnt,
        SUM(CASE WHEN response_changed = 1 THEN 1 ELSE 0 END) * 1.00 / 
            COUNT(rsvp_user_id) AS response_change_rate,
        AVG(first_response_to_start) AS avg_first_response_to_start,
        AVG(final_response_to_start) AS avg_final_response_to_start,
        SUM(CASE WHEN user_venue_same_location = 'yes' THEN 1 ELSE 0 END) AS location_same_cnt,
        SUM(CASE WHEN user_venue_same_location != 'yes' THEN 1 ELSE 0 END) AS location_diff_cnt,
        SUM(CASE WHEN final_response = 'yes' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_accept_cnt,
        SUM(CASE WHEN final_response = 'no' AND user_venue_same_location = 'yes' THEN 1 ELSE 0 END)
            AS location_same_decline_cnt
    FROM `keira-xebia`.`meetupservice`.`certified_events_users_rsvp`
    GROUP BY event_id, event_name, event_date, group_id, venue_id
),

events AS (
    SELECT 
        event_id,
        event_name,
        group_id,
        venue_id,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)) AS event_date,
        event_status,
        event_duration,
        CASE
            WHEN event_duration IS NULL THEN 'unknown'
            WHEN event_duration <= 3600000 THEN 'less than 1h'  -- less than 1 hour
            WHEN event_duration > 3600000 AND event_duration <= 7200000 THEN '1-2h'  -- 1-2 hours
            WHEN event_duration > 7200000 AND event_duration <= 10800000 THEN '2-3h'  -- 2-3 hours
            WHEN event_duration > 10800000 THEN 'more than 3h'  -- more than 3 hours
            ELSE NULL
        END AS event_duration_level,
        DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)) AS event_create_date,
        DATE_DIFF(DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_start_time)),
            DATE(FORMAT_TIMESTAMP('%Y-%m-%d', event_create_time)), DAY) AS create_to_start_duration,
        event_description,
        rsvp_total_limit,
        venue_name,
        venue_country,
        venue_city,
        venue_lat,
        venue_lon
    FROM `keira-xebia`.`meetupservice`.`stg_events`
),

staging AS (
    SELECT 
        e.event_id,
        e.event_name,
        e.group_id,
        e.venue_id,
        e.event_date,
        e.event_status,
        e.event_description,
        e.event_duration,
        e.event_duration_level,
        e.event_create_date,
        e.create_to_start_duration,
        e.rsvp_total_limit,
        e.venue_name,
        e.venue_country,
        e.venue_city,
        r.total_user,
        r.total_guests,
        r.accept_user_cnt,
        r.accept_user_cnt * 1.00 / r.total_user AS accept_rate,
        r.decline_user_cnt,
        r.decline_user_cnt * 1.00 / r.total_user AS decline_rate,
        r.response_change_rate,
        r.avg_first_response_to_start,
        1- (r.avg_first_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS first_response_indicator,
        r.avg_final_response_to_start,
        1- (r.avg_final_response_to_start * 1.00 / NULLIF (create_to_start_duration, 0)) AS final_response_indicator,
        r.location_same_cnt,
        r.location_same_cnt * 1.00 / r.total_user AS location_same_rate,
        r.location_diff_cnt,
        r.location_diff_cnt * 1.00 / r.total_user AS location_diff_rate,
        r.location_same_accept_cnt,
        r.location_same_decline_cnt
    FROM events e
    JOIN userrsvp r 
        ON e.event_id = r.event_id
)

SELECT
    event_id,
    event_name,
    group_id,
    venue_id,
    event_date,
    event_status,
    event_description,
    event_duration,
    event_duration_level,
    event_create_date,
    create_to_start_duration,
    rsvp_total_limit,
    venue_name,
    venue_country,
    venue_city,
    total_user,
    total_guests,
    accept_user_cnt,
    accept_rate,
    decline_user_cnt,
    decline_rate,
    response_change_rate,
    avg_first_response_to_start,
    first_response_indicator,
    avg_final_response_to_start,
    final_response_indicator,
    location_same_cnt,
    location_same_rate,
    location_diff_cnt,
    location_diff_rate,
    location_same_accept_cnt,
    location_same_decline_cnt
FROM staging
    );
  
[0m12:55:07.743692 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:1ce17eb1-4f3b-47c2-bbe4-ad9efcefc427&page=queryresults
[0m12:55:07.780297 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:6e41ebfd-77cb-4e08-b62f-f072cba4c3b8&page=queryresults
[0m12:55:10.603851 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133906c90>]}
[0m12:55:10.604383 [info ] [Thread-3 (]: 14 of 16 OK created sql table model meetupservice.certified_events ............. [[32mCREATE TABLE (6.2k rows, 31.4 MiB processed)[0m in 3.63s]
[0m12:55:10.604864 [debug] [Thread-3 (]: Finished running node model.keira_project.certified_events
[0m12:55:12.564185 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc6f90>]}
[0m12:55:12.564697 [info ] [Thread-4 (]: 15 of 16 OK created sql table model meetupservice.certified_users_groups ....... [[32mCREATE TABLE (69.5k rows, 11.7 MiB processed)[0m in 5.59s]
[0m12:55:12.565157 [debug] [Thread-4 (]: Finished running node model.keira_project.certified_users_groups
[0m12:55:12.565758 [debug] [Thread-1 (]: Began running node model.keira_project.certified_group_topics
[0m12:55:12.566168 [info ] [Thread-1 (]: 16 of 16 START sql table model meetupservice.certified_group_topics ............ [RUN]
[0m12:55:12.566532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.keira_project.certified_users, now model.keira_project.certified_group_topics)
[0m12:55:12.566796 [debug] [Thread-1 (]: Began compiling node model.keira_project.certified_group_topics
[0m12:55:12.569606 [debug] [Thread-1 (]: Writing injected SQL for node "model.keira_project.certified_group_topics"
[0m12:55:12.571150 [debug] [Thread-1 (]: Began executing node model.keira_project.certified_group_topics
[0m12:55:12.572783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:12.815350 [debug] [Thread-1 (]: Writing runtime sql for node "model.keira_project.certified_group_topics"
[0m12:55:12.817757 [debug] [Thread-1 (]: On model.keira_project.certified_group_topics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "keira_project", "target_name": "dev", "node_id": "model.keira_project.certified_group_topics"} */

  
    

    create or replace table `keira-xebia`.`meetupservice`.`certified_group_topics`
      
    
    

    OPTIONS()
    as (
      

WITH topics AS(
    SELECT
        group_id,
        topic,
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics`
),

topicgroup AS(
    SELECT 
        t.topic,
        COUNT (DISTINCT t.group_id) AS topic_group_cnt,
        COUNT (u.user_id) AS topic_user_cnt
    FROM `keira-xebia`.`meetupservice`.`stg_group_topics` t
    JOIN `keira-xebia`.`meetupservice`.`certified_users_groups` u
    ON t.group_id = u.join_group_id 
    GROUP BY t.topic
),

staging AS(
    SELECT
        t.group_id,
        t.topic,
        g.topic_group_cnt,
        g.topic_user_cnt
    FROM topics t
    JOIN topicgroup g
    ON t.topic = g.topic 
)


SELECT
    group_id,
    topic,
    topic_group_cnt, 
    topic_user_cnt
FROM staging
    );
  
[0m12:55:13.274573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=keira-xebia&j=bq:EU:eac7d5fd-e91c-46fc-b986-5e113a1a1d50&page=queryresults
[0m12:55:16.447408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00174e9d-b4d7-4d46-af11-3e9b8a01a209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fc79b0>]}
[0m12:55:16.447946 [info ] [Thread-1 (]: 16 of 16 OK created sql table model meetupservice.certified_group_topics ....... [[32mCREATE TABLE (7.4k rows, 2.2 MiB processed)[0m in 3.88s]
[0m12:55:16.448381 [debug] [Thread-1 (]: Finished running node model.keira_project.certified_group_topics
[0m12:55:16.449334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:16.449575 [debug] [MainThread]: Connection 'model.keira_project.certified_group_topics' was properly closed.
[0m12:55:16.449755 [debug] [MainThread]: Connection 'model.keira_project.certified_events_users_rsvp' was properly closed.
[0m12:55:16.449924 [debug] [MainThread]: Connection 'model.keira_project.certified_events' was properly closed.
[0m12:55:16.450088 [debug] [MainThread]: Connection 'model.keira_project.certified_users_groups' was properly closed.
[0m12:55:16.450341 [info ] [MainThread]: 
[0m12:55:16.450560 [info ] [MainThread]: Finished running 15 table models, 1 view model in 0 hours 0 minutes and 26.31 seconds (26.31s).
[0m12:55:16.452783 [debug] [MainThread]: Command end result
[0m12:55:16.505962 [info ] [MainThread]: 
[0m12:55:16.506580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:16.507052 [info ] [MainThread]: 
[0m12:55:16.507396 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m12:55:16.511112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.615204, "process_user_time": 3.85291, "process_kernel_time": 1.943077, "process_mem_max_rss": "211828736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:55:16.512056 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:16.511959 after 29.62 seconds
[0m12:55:16.512621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10259ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1340d7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1340d41d0>]}
[0m12:55:16.513412 [debug] [MainThread]: Flushing usage events
